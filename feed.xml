<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.0.0">Jekyll</generator><link href="https://rafaelsf80.github.io/notebooks/feed.xml" rel="self" type="application/atom+xml" /><link href="https://rafaelsf80.github.io/notebooks/" rel="alternate" type="text/html" /><updated>2020-08-05T04:17:26-05:00</updated><id>https://rafaelsf80.github.io/notebooks/feed.xml</id><title type="html">Rafael Sánchez notebooks</title><subtitle>A list of notebooks I use in lectures and presentations.</subtitle><entry><title type="html">Series temporales: temperaturas en Melbourne</title><link href="https://rafaelsf80.github.io/notebooks/tensorflow/2020/08/04/time-series-temperatures.html" rel="alternate" type="text/html" title="Series temporales: temperaturas en Melbourne" /><published>2020-08-04T00:00:00-05:00</published><updated>2020-08-04T00:00:00-05:00</updated><id>https://rafaelsf80.github.io/notebooks/tensorflow/2020/08/04/time-series-temperatures</id><content type="html" xml:base="https://rafaelsf80.github.io/notebooks/tensorflow/2020/08/04/time-series-temperatures.html">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-08-04-time-series-temperatures.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Introducci&amp;#243;n&quot;&gt;Introducci&amp;#243;n&lt;a class=&quot;anchor-link&quot; href=&quot;#Introducci&amp;#243;n&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;Se analizará la serie temporal de temperaturas en Melbourne con el dataset disponible en MachineLearningMastery.com de Jason Brownlee.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tensorflow&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tf&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;__version__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;plt&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;plot_series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;-&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;end&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;end&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;end&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Time&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ylabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Value&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;grid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;wget --no-check-certificate &lt;span class=&quot;err&quot;&gt;\&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;https&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;//&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;raw&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;githubusercontent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;jbrownlee&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Datasets&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;master&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;daily&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;min&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;temperatures&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;csv&lt;/span&gt; \
    &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;O&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tmp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;daily&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;min&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;temperatures&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;csv&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;csv&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;time_step&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;temps&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;/tmp/daily-min-temperatures.csv&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;csvfile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# YOUR CODE HERE. READ TEMPERATURES INTO TEMPS&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# HAVE TIME STEPS BE A SIMPLE ARRAY OF 1, 2, 3, 4 etc&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;series&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;temps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time_step&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figure&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figsize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plot_series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;split_time&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2500&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;time_train&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# YOUR CODE HERE&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;x_train&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# YOUR CODE HERE&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;time_valid&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# YOUR CODE HERE&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;x_valid&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# YOUR CODE HERE&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;window_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;30&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;shuffle_buffer_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;windowed_dataset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;window_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;shuffle_buffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# YOUR CODE HERE&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;model_forecast&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;window_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# YOUR CODE HERE&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;backend&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;clear_session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;51&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;51&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;window_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;64&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;256&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;train_set&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;windowed_dataset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;window_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;shuffle_buffer_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_set&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x_train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;models&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Sequential&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# YOUR CODE HERE&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;lr_schedule&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;callbacks&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;LearningRateScheduler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;lambda&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;epoch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1e-8&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;epoch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;optimizers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SGD&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1e-8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;momentum&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;compile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;losses&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Huber&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt;
              &lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
              &lt;span class=&quot;n&quot;&gt;metrics&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;mae&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;history&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_set&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;epochs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;callbacks&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lr_schedule&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stderr output_text&quot;&gt;
&lt;pre&gt;WARNING: Logging before flag parsing goes to stderr.
W0719 05:10:05.389573 140234944071552 deprecation.py:323] From /usr/local/lib/python3.6/dist-packages/tensorflow/python/data/util/random_seed.py:58: add_dispatch_support.&amp;lt;locals&amp;gt;.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;&amp;lt;PrefetchDataset shapes: ((None, None, 1), (None, None, 1)), types: (tf.float64, tf.float64)&amp;gt;
(2500,)
Epoch 1/100
10/10 [==============================] - 6s 624ms/step - loss: 31.1549 - mae: 31.6551
Epoch 2/100
10/10 [==============================] - 4s 364ms/step - loss: 30.5696 - mae: 31.0771
Epoch 3/100
10/10 [==============================] - 4s 358ms/step - loss: 29.6691 - mae: 30.1811
Epoch 4/100
10/10 [==============================] - 4s 366ms/step - loss: 28.5431 - mae: 29.0596
Epoch 5/100
10/10 [==============================] - 4s 361ms/step - loss: 27.1744 - mae: 27.6976
Epoch 6/100
10/10 [==============================] - 4s 367ms/step - loss: 25.4676 - mae: 26.0015
Epoch 7/100
10/10 [==============================] - 4s 375ms/step - loss: 23.2987 - mae: 23.8487
Epoch 8/100
10/10 [==============================] - 4s 369ms/step - loss: 20.5506 - mae: 21.1192
Epoch 9/100
10/10 [==============================] - 4s 372ms/step - loss: 17.2408 - mae: 17.8223
Epoch 10/100
10/10 [==============================] - 4s 365ms/step - loss: 13.5549 - mae: 14.1350
Epoch 11/100
10/10 [==============================] - 4s 370ms/step - loss: 10.0753 - mae: 10.6367
Epoch 12/100
10/10 [==============================] - 4s 365ms/step - loss: 7.5638 - mae: 8.0985
Epoch 13/100
10/10 [==============================] - 4s 363ms/step - loss: 6.2445 - mae: 6.7619
Epoch 14/100
10/10 [==============================] - 4s 374ms/step - loss: 5.6749 - mae: 6.1854
Epoch 15/100
10/10 [==============================] - 4s 363ms/step - loss: 5.3090 - mae: 5.8168
Epoch 16/100
10/10 [==============================] - 4s 361ms/step - loss: 4.9122 - mae: 5.4169
Epoch 17/100
10/10 [==============================] - 4s 356ms/step - loss: 4.5318 - mae: 5.0305
Epoch 18/100
10/10 [==============================] - 4s 367ms/step - loss: 4.2115 - mae: 4.7068
Epoch 19/100
10/10 [==============================] - 4s 374ms/step - loss: 3.9429 - mae: 4.4360
Epoch 20/100
10/10 [==============================] - 4s 358ms/step - loss: 3.7309 - mae: 4.2194
Epoch 21/100
10/10 [==============================] - 4s 363ms/step - loss: 3.5706 - mae: 4.0551
Epoch 22/100
10/10 [==============================] - 4s 366ms/step - loss: 3.4527 - mae: 3.9344
Epoch 23/100
10/10 [==============================] - 4s 362ms/step - loss: 3.3617 - mae: 3.8423
Epoch 24/100
10/10 [==============================] - 4s 358ms/step - loss: 3.2876 - mae: 3.7666
Epoch 25/100
10/10 [==============================] - 3s 344ms/step - loss: 3.2224 - mae: 3.6997
Epoch 26/100
10/10 [==============================] - 4s 360ms/step - loss: 3.1596 - mae: 3.6359
Epoch 27/100
10/10 [==============================] - 4s 360ms/step - loss: 3.0964 - mae: 3.5717
Epoch 28/100
10/10 [==============================] - 4s 362ms/step - loss: 3.0322 - mae: 3.5064
Epoch 29/100
10/10 [==============================] - 4s 352ms/step - loss: 2.9662 - mae: 3.4392
Epoch 30/100
10/10 [==============================] - 4s 359ms/step - loss: 2.9004 - mae: 3.3720
Epoch 31/100
10/10 [==============================] - 4s 361ms/step - loss: 2.8376 - mae: 3.3081
Epoch 32/100
10/10 [==============================] - 4s 375ms/step - loss: 2.7775 - mae: 3.2475
Epoch 33/100
10/10 [==============================] - 4s 360ms/step - loss: 2.7202 - mae: 3.1899
Epoch 34/100
10/10 [==============================] - 4s 367ms/step - loss: 2.6662 - mae: 3.1360
Epoch 35/100
10/10 [==============================] - 4s 379ms/step - loss: 2.6152 - mae: 3.0848
Epoch 36/100
10/10 [==============================] - 4s 357ms/step - loss: 2.5663 - mae: 3.0353
Epoch 37/100
10/10 [==============================] - 4s 366ms/step - loss: 2.5192 - mae: 2.9872
Epoch 38/100
10/10 [==============================] - 4s 367ms/step - loss: 2.4735 - mae: 2.9408
Epoch 39/100
10/10 [==============================] - 4s 372ms/step - loss: 2.4296 - mae: 2.8964
Epoch 40/100
10/10 [==============================] - 4s 371ms/step - loss: 2.3873 - mae: 2.8534
Epoch 41/100
10/10 [==============================] - 4s 361ms/step - loss: 2.3463 - mae: 2.8119
Epoch 42/100
10/10 [==============================] - 4s 354ms/step - loss: 2.3060 - mae: 2.7707
Epoch 43/100
10/10 [==============================] - 4s 375ms/step - loss: 2.2663 - mae: 2.7301
Epoch 44/100
10/10 [==============================] - 4s 359ms/step - loss: 2.2269 - mae: 2.6899
Epoch 45/100
10/10 [==============================] - 4s 366ms/step - loss: 2.1898 - mae: 2.6519
Epoch 46/100
10/10 [==============================] - 4s 367ms/step - loss: 2.1563 - mae: 2.6181
Epoch 47/100
10/10 [==============================] - 4s 363ms/step - loss: 2.1248 - mae: 2.5861
Epoch 48/100
10/10 [==============================] - 4s 367ms/step - loss: 2.0958 - mae: 2.5568
Epoch 49/100
10/10 [==============================] - 4s 363ms/step - loss: 2.0688 - mae: 2.5296
Epoch 50/100
10/10 [==============================] - 4s 370ms/step - loss: 2.0442 - mae: 2.5045
Epoch 51/100
10/10 [==============================] - 4s 371ms/step - loss: 2.0220 - mae: 2.4818
Epoch 52/100
10/10 [==============================] - 4s 362ms/step - loss: 2.0018 - mae: 2.4611
Epoch 53/100
10/10 [==============================] - 4s 361ms/step - loss: 1.9801 - mae: 2.4393
Epoch 54/100
10/10 [==============================] - 4s 369ms/step - loss: 1.9586 - mae: 2.4171
Epoch 55/100
10/10 [==============================] - 4s 358ms/step - loss: 1.9390 - mae: 2.3972
Epoch 56/100
10/10 [==============================] - 4s 366ms/step - loss: 1.9186 - mae: 2.3763
Epoch 57/100
10/10 [==============================] - 4s 366ms/step - loss: 1.8975 - mae: 2.3550
Epoch 58/100
10/10 [==============================] - 4s 359ms/step - loss: 1.8743 - mae: 2.3320
Epoch 59/100
10/10 [==============================] - 4s 363ms/step - loss: 1.8738 - mae: 2.3310
Epoch 60/100
10/10 [==============================] - 4s 354ms/step - loss: 2.1527 - mae: 2.6201
Epoch 61/100
10/10 [==============================] - 4s 357ms/step - loss: 2.6764 - mae: 3.1247
Epoch 62/100
10/10 [==============================] - 4s 360ms/step - loss: 2.9935 - mae: 3.4806
Epoch 63/100
10/10 [==============================] - 4s 360ms/step - loss: 3.5219 - mae: 3.9875
Epoch 64/100
10/10 [==============================] - 4s 361ms/step - loss: 3.8284 - mae: 4.2965
Epoch 65/100
10/10 [==============================] - 4s 357ms/step - loss: 4.1265 - mae: 4.5856
Epoch 66/100
10/10 [==============================] - 4s 359ms/step - loss: 4.3062 - mae: 4.7664
Epoch 67/100
10/10 [==============================] - 4s 358ms/step - loss: 4.3039 - mae: 4.6838
Epoch 68/100
10/10 [==============================] - 4s 363ms/step - loss: 4.8341 - mae: 5.2257
Epoch 69/100
10/10 [==============================] - 4s 370ms/step - loss: 10.3352 - mae: 10.7649
Epoch 70/100
10/10 [==============================] - 4s 367ms/step - loss: 5.4020 - mae: 5.8328
Epoch 71/100
10/10 [==============================] - 4s 363ms/step - loss: 5.9798 - mae: 6.4835
Epoch 72/100
10/10 [==============================] - 4s 356ms/step - loss: 5.4958 - mae: 6.0146
Epoch 73/100
10/10 [==============================] - 4s 362ms/step - loss: 4.4955 - mae: 5.0201
Epoch 74/100
10/10 [==============================] - 4s 370ms/step - loss: 4.4764 - mae: 5.0171
Epoch 75/100
10/10 [==============================] - 4s 380ms/step - loss: 4.2825 - mae: 4.7287
Epoch 76/100
10/10 [==============================] - 4s 361ms/step - loss: 4.2044 - mae: 4.6470
Epoch 77/100
10/10 [==============================] - 4s 370ms/step - loss: 4.4160 - mae: 4.9125
Epoch 78/100
10/10 [==============================] - 4s 361ms/step - loss: 4.3770 - mae: 4.8831
Epoch 79/100
10/10 [==============================] - 4s 361ms/step - loss: 5.0487 - mae: 5.5839
Epoch 80/100
10/10 [==============================] - 4s 390ms/step - loss: 10.0358 - mae: 10.8604
Epoch 81/100
10/10 [==============================] - 4s 370ms/step - loss: 3.1176 - mae: 3.6060
Epoch 82/100
10/10 [==============================] - 4s 371ms/step - loss: 3.0097 - mae: 3.4891
Epoch 83/100
10/10 [==============================] - 4s 361ms/step - loss: 2.7912 - mae: 3.2609
Epoch 84/100
10/10 [==============================] - 4s 357ms/step - loss: 4.3135 - mae: 4.7803
Epoch 85/100
10/10 [==============================] - 4s 357ms/step - loss: 5.3703 - mae: 5.8508
Epoch 86/100
10/10 [==============================] - 4s 360ms/step - loss: 6.5221 - mae: 7.0175
Epoch 87/100
10/10 [==============================] - 4s 361ms/step - loss: 7.1154 - mae: 7.7249
Epoch 88/100
10/10 [==============================] - 4s 368ms/step - loss: 8.9975 - mae: 9.4580
Epoch 89/100
10/10 [==============================] - 4s 360ms/step - loss: 9.8069 - mae: 10.1397
Epoch 90/100
10/10 [==============================] - 4s 354ms/step - loss: 11.1364 - mae: 11.6797
Epoch 91/100
10/10 [==============================] - 4s 356ms/step - loss: 12.5922 - mae: 13.2602
Epoch 92/100
10/10 [==============================] - 4s 357ms/step - loss: 14.2512 - mae: 14.8289
Epoch 93/100
10/10 [==============================] - 4s 358ms/step - loss: 13.0192 - mae: 13.8809
Epoch 94/100
10/10 [==============================] - 4s 356ms/step - loss: 61.8923 - mae: 63.5737
Epoch 95/100
10/10 [==============================] - 4s 366ms/step - loss: 30.5821 - mae: 31.4688
Epoch 96/100
10/10 [==============================] - 4s 357ms/step - loss: 45.9889 - mae: 46.9740
Epoch 97/100
10/10 [==============================] - 4s 355ms/step - loss: 51.7050 - mae: 51.8100
Epoch 98/100
10/10 [==============================] - 4s 361ms/step - loss: 59.1678 - mae: 57.9463
Epoch 99/100
10/10 [==============================] - 4s 373ms/step - loss: 66.1686 - mae: 68.4903
Epoch 100/100
10/10 [==============================] - 4s 360ms/step - loss: 74.1415 - mae: 72.0624
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;semilogx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;history&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;history&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;lr&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;history&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;history&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;loss&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1e-8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1e-4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;60&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;[1e-08, 0.0001, 0, 60]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAX0AAAEACAYAAABfxaZOAAAABHNCSVQICAgIfAhkiAAAAAlwSFlz
AAALEgAACxIB0t1+/AAAADl0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uIDMuMC4zLCBo
dHRwOi8vbWF0cGxvdGxpYi5vcmcvnQurowAAHxdJREFUeJzt3Xl4XNWZ5/HvW4v2zbJled+wwdjg
BYRZEwhbCEMC6SYkhE5M4hk3PTNZms4EpjN00tPdk6STJ3syhCEkzh5CSEyAsMSBQMYGLOMFLyy2
8b5blmxZllSlevuPKsnG2FZJqlJV+f4+z6On6p66Vff1sfS7t06de8vcHRERCYZQrgsQEZHBo9AX
EQkQhb6ISIAo9EVEAkShLyISIAp9EZEASSv0zazGzB4ys1fNbJ2ZXWxmtWb2tJm9kbodku1iRURk
YNI90v8m8IS7TwVmAuuAu4FF7j4FWJRaFhGRPGa9nZxlZtXACmCSH7Oymb0GXOHuO81sJPCsu5+V
1WpFRGRA0jnSnwjsBX5oZsvN7H4zKwfq3X1nap1dQH22ihQRkcyIpLnOecAn3P1FM/smxw3luLub
2QnfMpjZfGA+QHl5+flTp04dYMkiIsGybNmyfe5el4nXSmd4ZwTwgrtPSC2/g2ToT6aPwzsNDQ3e
2NiYibpFRALDzJa5e0MmXqvX4R133wVsNbPuQL8KWAs8AsxNtc0FFmaiIBERyZ50hncAPgH8zMyK
gI3Ax0juMB40s3nAZuCW7JQoIiKZklbou/sK4ERvLa7KbDkiIpJNOiNXRCRAFPoiIgGi0BcRCRCF
vohIgCj0RUQCRKEvIhIgCn0RkQBR6IuIBIhCX0QkQBT6IiIBotAXEQkQhb6ISIAo9EVEAkShLyIS
IAp9EZEAUeiLiASIQl9EJEAU+iIiAaLQFxEJEIW+iEiAKPRFRAJEoS8iEiAKfRGRAFHoi4gEiEJf
RCRAFPoiIgGi0BcRCZBIOiuZ2SbgENAFxN29wcxqgV8BE4BNwC3ufiA7ZYqISCb05Uj/Xe4+y90b
Ust3A4vcfQqwKLUsIiJ5bCDDOzcCC1L3FwA3DbwcERHJpnRD34GnzGyZmc1PtdW7+87U/V1Afcar
ExGRjEprTB+4zN23m9lw4Gkze/XYB93dzcxP9MTUTmI+wLhx4wZUrIiIDExaR/ruvj11uwf4LTAH
2G1mIwFSt3tO8tz73L3B3Rvq6uoyU7WIiPRLr6FvZuVmVtl9H7gWWA08AsxNrTYXWJitIkVEJDPS
Gd6pB35rZt3r/9zdnzCzpcCDZjYP2Azckr0yRUQkE3oNfXffCMw8Qft+4KpsFCUiItmhM3JFRAJE
oS8iEiAKfRGRAFHoi4gEiEJfRCRAFPoiIgGi0BcRCRCFvohIgCj0RUQCRKEvIhIgCn0RkQBR6IuI
BIhCX0QkQBT6IiIBotAXEQkQhb6ISIAo9EVEAkShLyISIAp9EZEAUeiLiASIQl9EJEAU+iIiAaLQ
FxEJEIW+iEiAKPRFRAJEoS8iEiAKfRGRAFHoi4gESNqhb2ZhM1tuZo+mliea2Ytmtt7MfmVmRdkr
U0REMqEvR/qfAtYds/xl4OvuPhk4AMzLZGEiIpJ5aYW+mY0B/hNwf2rZgCuBh1KrLABuykaBIiKS
Oeke6X8D+CyQSC0PBZrdPZ5a3gaMPtETzWy+mTWaWePevXsHVKyIiAxMr6FvZjcAe9x9WX824O73
uXuDuzfU1dX15yVERCRDImmscynwPjO7HigBqoBvAjVmFkkd7Y8BtmevTBERyYRej/Td/X+6+xh3
nwB8CPiTu98GPAPcnFptLrAwa1WKiEhGDGSe/l3AnWa2nuQY/w8yU5KIiGRLOsM7Pdz9WeDZ1P2N
wJzMlyQiItmiM3JFRAJEoS8iEiAKfRGRAFHoi4gEiEJfRCRAFPoiIgGi0BcRCRCFvohIgCj0RUQC
RKEvIhIgCn0RkQBR6IuIBIhCX0QkQBT6IiIBotAXEQkQhb6ISIAo9EVEAkShLyISIAp9EZEAUeiL
iASIQl9EJEAU+iIiAaLQFxEJEIW+iEiAKPRFRAJkUEN//+FOOuJdg7lJERE5xqCG/o7mI1zxlWf5
yZJNCn8RkRzoNfTNrMTMXjKzlWa2xsz+OdU+0cxeNLP1ZvYrMyvq7bUmDitndE0p9yxcwxVfeZaH
X96WiX+DiIikKZ0j/Q7gSnefCcwCrjOzi4AvA19398nAAWBeby9UURzh13dczE/nXciI6hLufHAl
n31oJe0xHfWLiAyGXkPfk1pTi9HUjwNXAg+l2hcAN6WzQTPjsinDeOiOS/jElZN5sHEbf/1/F7Nl
f1s/yhcRkb5Ia0zfzMJmtgLYAzwNbACa3T2eWmUbMPokz51vZo1m1rh3796e9nDI+Idrz+KB2xvY
2tTGDd9+nmde3TOgf4yIiJxaWqHv7l3uPgsYA8wBpqa7AXe/z90b3L2hrq7ubY9fObWexz75DsbW
ljFvwVJ+u1zj/CIi2dKn2Tvu3gw8A1wM1JhZJPXQGGB7f4sYW1vGr++4mIsmDeXOB1fyq6Vb+vtS
IiJyCunM3qkzs5rU/VLgGmAdyfC/ObXaXGDhQAopK4rwwO0X8M4pddz1m1f4yZJNA3k5ERE5gXSO
9EcCz5jZKmAp8LS7PwrcBdxpZuuBocAPBlpMSTTMfR89n6vPrueehWu4//mNA31JERE5RqS3Fdx9
FTD7BO0bSY7vZ1RxJMz3bjuPT/1yOf/62DqqSqPc0jA205sREQmkvLz2TlEkxLdunc1lk4fxud++
wgsb9+e6JBGR00Jehj5ANBziu7edx7jaMu746TLe3Hc41yWJiBS8vA19gOrSKA/cfgEGzPvRUprb
OnNdkohIQcvr0AcYP7Sc+z7awLYDR/i7n75MZzyR65JERApW3oc+wAUTavnyzeeyZON+vvHH13Nd
johIwSqI0Ad4/+wxfLBhLPf+eQMvbzmQ63JERApSwYQ+wP+64WxGVpfymQdXcqRTV+YUEemrggr9
ypIoX7l5Bhv3HebLT7ya63JERApOQYU+wCWTh3H7JRP40eJNLN6wL9fliIgUlIILfYC7rpvKxGHl
/I9fr+JQeyzX5YiIFIyCDP3SojBf/cBMdrYc4WtPazaPiEi6CjL0Ac4fP4RbGsby0xc2s7VJ37ol
IpKOgg19gE9ffSYhMx3ti4ikqaBDf0R1CR+7dCK/W7GdtTsO5rocEZG8V9ChD/B3l59BZXGEf39S
UzhFRHpT8KFfXRblv75rMs++tpclG3QJZhGRUyn40Ae4/ZIJjKgq4UtPvIq757ocEZG8dVqEfkk0
zN9fM4WVW5t5cs2uXJcjIpK3TovQB/jr88Ywqa6cb/9pvY72RURO4rQJ/Ug4xLzLJrJmx0FdhVNE
5CROm9AHuGnWaCpLIixYvDnXpYiI5KXTKvTLiyN84PyxPP7KTvYcbM91OSIieee0Cn2Aj148nnjC
+flLW3JdiohI3jntQn/CsHKuOKuOn724Rd+nKyJynNMu9AHmXjyBvYc6NH1TROQ4p2XoX35mHeOH
lrFg8aZclyIikldOy9APhYyPXDSexs0HWL29JdfliIjkjV5D38zGmtkzZrbWzNaY2adS7bVm9rSZ
vZG6HZL9ctP3gYaxlEbD/HjJplyXIiKSN9I50o8D/+Du04CLgP9mZtOAu4FF7j4FWJRazhvVpVFu
mj2K36/cSVtnPNfliIjkhV5D3913uvvLqfuHgHXAaOBGYEFqtQXATdkqsr9umjWaI7Eunl67O9el
iIjkhT6N6ZvZBGA28CJQ7+47Uw/tAuozWlkGXDChlpHVJTyyYkeuSxERyQtph76ZVQC/AT7t7m/5
mipPXuHshFc5M7P5ZtZoZo179+4dULF9FQoZ75s5ij+/vpcDhzsHddsiIvkordA3syjJwP+Zuz+c
at5tZiNTj48E9pzoue5+n7s3uHtDXV1dJmruk/fOHEU84fxhtebsi4ikM3vHgB8A69z9a8c89Agw
N3V/LrAw8+UN3PRRVZxRV87CFdtzXYqISM6lc6R/KfAR4EozW5H6uR74EnCNmb0BXJ1azjtmxo2z
RvPSpiZ2thzJdTkiIjmVzuydv7i7ufsMd5+V+nnc3fe7+1XuPsXdr3b3psEouD/eN3MU7vDoyp29
rywicho7Lc/IPd6EYeXMHFPNwpUa4hGRYAtE6AO8b9ZoVm8/yIa9rbkuRUQkZwIT+jfMGIkZmrMv
IoEWmNCvryrh4klDeWTlDn1xuogEVmBCH5Jz9t/cd5hXdx3KdSkiIjkRqNC/+ux6zOCpNboWj4gE
U6BCv66ymIbxQ/SNWiISWIEKfYBrp41g7c6DbG1qy3UpIiKDLnChf8205MVAdbllEQmiwIX+hGHl
nFVfyVNrNcQjIsETuNAHePf0el56s4kmXW5ZRAImkKF/7fQRJBwWrdMQj4gESyBDf/qoKkZVl/CU
xvVFJGACGfpmxrXTR/D8G3s50tmV63JERAZNIEMf4Npp9bTHEvz59cH9CkcRkVwKbOjPmVhLdWlU
s3hEJFACG/qRcIirzh7OonV7iHclcl2OiMigCGzoQ/Ls3JYjMV58M2+/9EtEJKMCHfqXn1lHaTTM
46/oaxRFJBgCHfqlRWGuPHs4T67ZRVdC19gXkdNfoEMf4PpzRrKvtZOXNMQjIgEQ+NB/19Q6SqIh
DfGISCAEPvTLiiJcOXU4f1itIR4ROf0FPvQB3nPOSPa1dtC4SUM8InJ6U+gDV04dTnFEQzwicvpT
6APlxRGuOKuOP6zeRUJDPCJyGlPop1x/7kj2HOpg2ZYDuS5FRCRreg19M3vAzPaY2epj2mrN7Gkz
eyN1OyS7ZWbfVWfXUxQJ8dgqDfGIyOkrnSP9HwHXHdd2N7DI3acAi1LLBa2iOMLlZ9bxhIZ4RCRH
EglneZZHG3oNfXd/Djh+WsuNwILU/QXATRmuKyeuP3cEuw62s3yrhnhECtmyzQe45IuL2HOoPdel
9MkTa3bx/u8tZs2Olqxto79j+vXu3j0Osguoz1A9OXX12fWURsP8/MWtuS5FRAbgT6/uZkdLO0s2
7M91KX3SfWWAdTsPZW0bA/4g190dOOl4iJnNN7NGM2vcuze/v7CksiTKBy8YyyMrt7OrpbCOEETk
qJVbk0fKSwvs3JvlW5sBWL+nNWvb6G/o7zazkQCp2z0nW9Hd73P3BndvqKur6+fmBs+8yybSlXB+
uPjNXJciIv3g7qzalgzPxk2FM1TbHutibWpYJx9D/xFgbur+XGBhZsrJvbG1Zbzn3JH8/IUtHGqP
5bocEemjTfvbONgeZ2xtKa/tPkRLW2H8Ha/ZcZBYl1NRHGHD3hyGvpn9AlgCnGVm28xsHvAl4Boz
ewO4OrV82vjbd07iUEecXy3V2L5IoVmZGiL52CUTcYeXC+Tcm+5ZOzfMGMmWpjY64l1Z2U46s3du
dfeR7h519zHu/gN33+/uV7n7FHe/2t0La+CsFzPG1HDhxFoe+MubxPRViiIFZeW2ZkqiIT7QMIZI
yApmXH/5lmZG15Ry8RlD6Uo4m/e3ZWU7OiP3JP728knsaGnXyVoiBWbVthbOGVVNZUmU6aOrC2Zc
f/mWA8weV8MZdRVA9sb1FfonccWZw5k8vILvP7eR5AQlEcl3sa4Eq7e3MHNsDQAXjB/Cym3NWRsq
yZRdLe3saGln9rghTKorBxT6gy4UMua/YxLrdh7kL+v35bocEUnD67sP0RFPMGNMNQANE2rpiCdY
vf1gjis7tRWpE0LPG1dDWVGE0TWlCv1cuHH2KOqrirnnd6tpOtyZ63JEpBfd8/NnpY70GyYkLwuW
79+VsXxLM0XhENNGVQEweXiFQj8XiiNhvnfbeexoaWf+jxtpj+X3W0SRoFu1rZmasijjassAGFZR
zKRh5SzN83H95VuamT66iuJIGEiG/sZ9rVm5DphCvxfnj6/la7fMpHHzAT7z65W6GJtIHlu5rYVz
R1djZj1tDROGsGxzU97+7ca6Eqza3szssUcvVjx5eAXtsQTbm49kfHsK/TTcMGMUd103lUdX7eSr
T72W63JE5ASOdHbx+u5DPUM73Rom1HKgLcbGfdk74WkgXtt1iPZYgtnjjtY9eXhqBk8WTtJS6Kfp
jssnceucsXzv2Q3c99wG4pq/L5JX1uxooSvhzBhzXOiPTx5B5+sQT/dJWceGfve0zQ1ZGNdX6KfJ
zPjfN57DlVOH838ef5Vrvv4cD7+8TeEvkidWpM7EnZmaudNt4rByhpYXveUkrVhXgsdf2cmyzU05
n5L98pZm6iqLGV1T2tNWW15EbXlRVj7MjWT8FU9j0XCI+z/awNPrdvONP77BnQ+u5FuL3uCOy8/g
unNGUFNWlOsSRQJr1bYWRlaXMLyq5C3tZkbDhCE0bjqAu/PHdXv40h/WsWHvYQCmjqjkwxeO46bZ
o6kqiQ563cu3HGD22Jq3fA4BMLkuOzN4dKTfR6GQ8e7pI3jsE5fx/Y+cT1lRhLsffoXz//WP3Hb/
C/xkySZ2H9RlmUUG26ptzcw8bmin2wUTatnS1MbN9y7hv/y4EQfu/Zvz+OJfnUskbPzTwjVc+G+L
+OqTrw3qB75NhzvZtL+N2ePe/o2zZwyvYP3e1oy/E9GRfj91h/+10+pZua2FJ9fs4snVu7hn4Rru
WbiGORNqee+sUVx/zgiGVhTnulyR01pzWzI8b7lg7Akfv3DiUADe3HeYf7lxOh+aM45oOHnMe+uc
caza1sz/e/5NvvPMet7Yc4hvfHA2pUXhrNfdfVLWseP53SYPr6C5Lcb+DJ8jpNAfIDNj1tgaZo2t
4bPvPov1e1p5/JVd/H7VDu753Wq+8MgaLjljKDfMGMm100YwpFxDQCKZtmpb8qSskx3pnzumml/O
v4hpo6pOOIQzY0wN3/rQLGaPreFfHlvLB+9bwv1zGxheWXKCV8uMP726m39auIaSaKjnDOJj9czg
yfAQj0I/g8yMKfWVfKq+kk9eNZnXdh/i9yt38PuVO7nrN6/wj79dzSVnDOX6c0dy9dn11FXqHYDI
QK3Y2sx3n1kPJMP9ZC6aNPSUr2NmfPyyiYytLeOTv1jO+7+7mH+/eQZDyoowAzMoL4owZkjp28bf
+2J78xH++ZE1PLV2N5OHV/Djj19IWdHbozhboW+D+cl1Q0ODNzY2Dtr28oW7s2bHQR57ZSePv7Kz
55Kp00ZWcflZdbxzSh3njx9CUUQfsYgcr6UtxoZ9ybHt6tIo1aVFVJdGWbJxP/c+u4ElG/dTVRLh
U1efybzLJmZkm6u3tzBvwVJ2H+x422PDKoq5aFItF04aypwJtYyoKqGyJEIolNwRtHbEWbGlmWWb
D/DylgMcao9RFAkRDYcoCodYnPre3k9eNYV5l0086d99IuFM//yTfGjOWL7wvnOWuXtDJv5tCv1B
5u6s23mIZ17bw3Ov72XZ5gPEE05xJMSssTVcMKGWhglDmD1uCNWlgz+TQCSXdh9s54WN+1m6qYnX
d7eycW8r+1pPPqY9oqqEeZdN5NYLx1FRnNmBi/2tHam5/Y578ovAmw53snRTEy9ubGLXMRM2QgbV
pVHKiyPsaD5CwpPvDM4cXkldZTGdXQk64wliXQkm1VVw13VnMWZIWa813PDt5xlSVsRP//NFCv3T
xaH2GEs27OfFN5tYuqmJNTsO0pWaPTBmSCnTRlYxbVQVU0dUMXFYOeNqywblAyaRwbC/tYPFG/az
eMM+XtjYxJv7ktMoK4ojTB1RyRl1FZwxvJxJwyqIhI2WIzEOHonR3BZj9JBSbpgxKifvkN2dLU1t
rNjazL7WTlraOjnQFuNge4zxQ8s5f/wQZo+rGfAU0E//cjkvvdnEkn+8OmOhrzH9HKssiXLt9BFc
O30EAIc74qzY2syKrc2s23mQtTsP8vS63Ry7b66vKmZ8bTkja0qor0r+jKgqYWhFUc9JHTWlUSJh
DRdJ/lmzo4WFK3bwlzf2sXZn8pLHlcUR5kys5cNzxnHRpKFMG1VFONT/cfNsMzPGDy1n/NDyrG5n
8vAKfrdiR0ZfU6GfZ8qLI1w6eRiXTh7W09bWGWf9nlY27W9j877DbNrfxpamw7y85QC7D3bQGT/x
WcGVJZHUGGjyp6okSkVJhMqSCJXFESpTyxXFESpKIlSVRKgoPqatOJLXf3hSOLoSztNrd/HA/9/E
S282URQOcd74Gj5z7ZlcOnkY546u1kHKCXR/mJtJCv0CUFYUYcaYmrddUwSSbzOb22LsPtROU2sn
+w93cqCtk/2tnbQcifW8HW45krzgVGt7nEPtcVo746QzsldWFKaiOLmjqCiJpnYWqeXiaM/95E+0
ZwfSvVMpLw5TXnT0Qy4Jju4JDE+v3c1Dy7axvfkIY4aU8rnrz+aWhrFUl+kzq96cWV+Z8ddU6Bc4
M2NIeVGf5/8nEs7hzjitHfHkjqAjuTM4/JblGK3tyXW6Hz/UHmP3wfae+4c70/uOgfKiMBUlEcpT
7yC6dyblxRHKiiKUF4UpK07dFoUpTbWVFoUpK4qk2pKPlUUjlBQlZ0IMZOqcZJ67s2Tjfh5/ZSeL
1u1hZ0s7ZnDRxKHcc8M0rplWr3ePfTCproJ7/+Y83vPlzL2mQj+gQiGjsiRKZUkUTj61uVddCU/u
FNpjqdujO5K33HYkdyiHOuK0dcQ53NHFjuZ2DnfGaevsSraluQPpFg4ZpdEwJdEwpUWh1M4gTGk0
RGk0uZMoiYZ71ilJtZdEwxRHw5REQqn25GMl0TAlkaP3i49pi4ZNO5hTaOuM8/DL21mweBNv7Gml
NBrmnWcO485rzuTKqcN1VvoAXHfOyIy+nkJfBiQcsp7PDAYqkXDaYl20dcY50tmV3Bl0Hl0+Ejva
1h7r6lnnSCxOeyyRXC+W4EhnnH2tncl1Ysl122MJjsS6emZG9VXISO4IjtlRFEdCFHffRkIUR47e
L+r+CR9z/9jlcHLedjQSoihsyfs9P8nlSPdt6OhyJJR8PJxqC4eMSCg3O6SWthhLNzXxl/X7ePjl
bRxsjzN9VBVfuXkG7505ipKoZpnlI4W+5I1QyHo+QM6WWFeiZ0fQEUu8ZafQEU/etne3xRN0xLro
iB/T1v34cY8dbI/TGe+kM55s64wn6EjNy+6MJ4hn+SJekZD17BROtXOIhI1wKEQ09NbHosc8t3tH
EwkffQ3j6E7lSKyLFVubeXXXQdyhKBzimun1fOySCZw/fojeEeU5hb4ESvfR9GBfQrcr4ckdwDEn
6SRvk+3HL8cTCTrjTjyRIN7T5sR7br1nOZa6TW4j+ZxY19F1uxJHXyee8FRbcp22zvhbnhfvcmI9
20y2dXW9dYcVDhvTR1Xx91efyZyJtcwaW6Oj+gKi0BcZBOGQEQ6FFY6Sc5oYKyISIAp9EZEAGVDo
m9l1Zvaama03s7szVZSIiGRHv0PfzMLAd4H3ANOAW81sWqYKExGRzBvIkf4cYL27b3T3TuCXwI2Z
KUtERLJhILN3RgNbj1neBlx4/EpmNh+Yn1rsMLPVA9hmOqqBliw/t7f1TvX4yR47vv1E6x3fNgzY
d8pKB66//dmX52W6P9NpK6S+7Otz+9uffWkPSn8Oxt/6idqOXz7r1GX2gbv36we4Gbj/mOWPAN/p
5TmN/d1eH+q6L9vP7W29Uz1+sseObz/ReidYJ2/7sy/Py3R/ptl3BdOXg9WffWkPSn8Oxt/6YPfn
QIZ3tgPHfvX8mFRbrv1+EJ7b23qnevxkjx3ffqL1BvJv66/+brMvz8t0f6bTVkh92dfn9rc/+9Ie
lP4cjL/1E7VlrT/7/c1ZZhYBXgeuIhn2S4EPu/uaUzyn0TP07S+i/swk9WVmqT8zK5P92e8xfXeP
m9l/B54EwsADpwr8lPv6uz05IfVn5qgvM0v9mVkZ689B/Y5cERHJLZ2RKyISIAp9EZEAUeiLiARI
XoS+mY0zs9+Z2QO6hs/Amdk7zOxeM7vfzBbnup5CZ2YhM/s3M/u2mc3NdT2FzsyuMLPnU7+jV+S6
nkJnZuVm1mhmN6Sz/oBDPxXUe44/07aPF2M7F3jI3T8OzB5oTYUsE/3p7s+7+x3Ao8CCbNab7zL0
+3kjyfNQYiTPPA+sDPWnA61ACQHuzwz1JcBdwINpb3egs3fM7J0k/wN/7O7npNrCJOfwX0PyP3Up
cCvJqZ1fPO4lPg50AQ+R/GX4ibv/cEBFFbBM9Ke770k970FgnrsfGqTy806Gfj8/Dhxw9++b2UPu
fvNg1Z9vMtSf+9w9YWb1wNfc/bbBqj+fZKgvZwJDSe5A97n7o71td8DfnOXuz5nZhOOaey7GBmBm
vwRudPcvAm97C2JmnwE+n3qth4DAhn4m+jO1zjigJciBDxn7/dwGdKYWu7JXbf7L1O9nygGgOBt1
FoIM/W5eAZSTvNLxETN73N0Tp9putr4uMa2LsR3jCeALZvZhYFOWaipkfe1PgHkEeOfZi77258PA
t83sHcBz2SysQPWpP83sr4B3AzXAd7JbWsHpU1+6++cAzOx2Uu+gettAXnxHrruvJnkBN8kQd/98
rms4Xbh7G8mdqGSAuz9MckcqGeLuP0p33WzN3snXi7EVKvVnZqk/M0v9mTlZ78tshf5SYIqZTTSz
IuBDwCNZ2lYQqD8zS/2ZWerPzMl6X2ZiyuYvgCXAWWa2zczmuXsc6L4Y2zrgwTQuxiaoPzNN/ZlZ
6s/MyVVf6oJrIiIBkhdn5IqIyOBQ6IuIBIhCX0QkQBT6IiIBotAXEQkQhb6ISIAo9EVEAkShLyIS
IAp9EZEA+Q/EvnPaR7UhDAAAAABJRU5ErkJggg==
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;backend&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;clear_session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;51&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;51&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;train_set&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;windowed_dataset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;window_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;60&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;shuffle_buffer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shuffle_buffer_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;models&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Sequential&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# YOUR CODE HERE&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;


&lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;optimizers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SGD&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# YOUR CODE HERE, momentum=0.9)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;compile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;losses&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Huber&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt;
              &lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
              &lt;span class=&quot;n&quot;&gt;metrics&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;mae&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;history&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_set&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;epochs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# YOUR CODE HERE)&lt;/span&gt;
                                    
&lt;span class=&quot;c1&quot;&gt;# EXPECTED OUTPUT SHOULD SEE AN MAE OF &amp;lt;2 WITHIN ABOUT 30 EPOCHS&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Epoch 1/150
25/25 [==============================] - 6s 243ms/step - loss: 9.9624 - mae: 10.5789
Epoch 2/150
25/25 [==============================] - 3s 136ms/step - loss: 2.5390 - mae: 3.0130
Epoch 3/150
25/25 [==============================] - 3s 131ms/step - loss: 1.9265 - mae: 2.3815
Epoch 4/150
25/25 [==============================] - 3s 137ms/step - loss: 1.8597 - mae: 2.3125
Epoch 5/150
25/25 [==============================] - 3s 139ms/step - loss: 1.8181 - mae: 2.2696
Epoch 6/150
25/25 [==============================] - 3s 140ms/step - loss: 1.7882 - mae: 2.2385
Epoch 7/150
25/25 [==============================] - 4s 141ms/step - loss: 1.7618 - mae: 2.2112
Epoch 8/150
25/25 [==============================] - 3s 135ms/step - loss: 1.7382 - mae: 2.1870
Epoch 9/150
25/25 [==============================] - 3s 136ms/step - loss: 1.7167 - mae: 2.1650
Epoch 10/150
25/25 [==============================] - 3s 136ms/step - loss: 1.6976 - mae: 2.1454
Epoch 11/150
25/25 [==============================] - 3s 138ms/step - loss: 1.6808 - mae: 2.1281
Epoch 12/150
25/25 [==============================] - 3s 138ms/step - loss: 1.6661 - mae: 2.1128
Epoch 13/150
25/25 [==============================] - 4s 142ms/step - loss: 1.6531 - mae: 2.0993
Epoch 14/150
25/25 [==============================] - 4s 142ms/step - loss: 1.6417 - mae: 2.0872
Epoch 15/150
25/25 [==============================] - 3s 135ms/step - loss: 1.6315 - mae: 2.0764
Epoch 16/150
25/25 [==============================] - 3s 128ms/step - loss: 1.6223 - mae: 2.0667
Epoch 17/150
25/25 [==============================] - 3s 132ms/step - loss: 1.6141 - mae: 2.0579
Epoch 18/150
25/25 [==============================] - 3s 130ms/step - loss: 1.6067 - mae: 2.0500
Epoch 19/150
25/25 [==============================] - 3s 133ms/step - loss: 1.6000 - mae: 2.0429
Epoch 20/150
25/25 [==============================] - 3s 138ms/step - loss: 1.5939 - mae: 2.0364
Epoch 21/150
25/25 [==============================] - 3s 137ms/step - loss: 1.5883 - mae: 2.0306
Epoch 22/150
25/25 [==============================] - 3s 136ms/step - loss: 1.5833 - mae: 2.0254
Epoch 23/150
25/25 [==============================] - 4s 141ms/step - loss: 1.5787 - mae: 2.0207
Epoch 24/150
25/25 [==============================] - 3s 140ms/step - loss: 1.5745 - mae: 2.0163
Epoch 25/150
25/25 [==============================] - 4s 141ms/step - loss: 1.5707 - mae: 2.0124
Epoch 26/150
25/25 [==============================] - 3s 132ms/step - loss: 1.5672 - mae: 2.0089
Epoch 27/150
25/25 [==============================] - 3s 133ms/step - loss: 1.5640 - mae: 2.0056
Epoch 28/150
25/25 [==============================] - 3s 135ms/step - loss: 1.5610 - mae: 2.0026
Epoch 29/150
25/25 [==============================] - 3s 136ms/step - loss: 1.5583 - mae: 1.9998
Epoch 30/150
25/25 [==============================] - 3s 133ms/step - loss: 1.5558 - mae: 1.9973
Epoch 31/150
25/25 [==============================] - 3s 132ms/step - loss: 1.5534 - mae: 1.9949
Epoch 32/150
25/25 [==============================] - 3s 139ms/step - loss: 1.5512 - mae: 1.9927
Epoch 33/150
25/25 [==============================] - 3s 139ms/step - loss: 1.5491 - mae: 1.9906
Epoch 34/150
25/25 [==============================] - 3s 138ms/step - loss: 1.5472 - mae: 1.9886
Epoch 35/150
25/25 [==============================] - 4s 140ms/step - loss: 1.5453 - mae: 1.9868
Epoch 36/150
25/25 [==============================] - 4s 141ms/step - loss: 1.5436 - mae: 1.9850
Epoch 37/150
25/25 [==============================] - 3s 132ms/step - loss: 1.5419 - mae: 1.9833
Epoch 38/150
25/25 [==============================] - 3s 130ms/step - loss: 1.5404 - mae: 1.9817
Epoch 39/150
25/25 [==============================] - 3s 130ms/step - loss: 1.5389 - mae: 1.9803
Epoch 40/150
25/25 [==============================] - 3s 133ms/step - loss: 1.5376 - mae: 1.9789
Epoch 41/150
25/25 [==============================] - 3s 132ms/step - loss: 1.5363 - mae: 1.9776
Epoch 42/150
25/25 [==============================] - 3s 129ms/step - loss: 1.5350 - mae: 1.9764
Epoch 43/150
25/25 [==============================] - 3s 132ms/step - loss: 1.5338 - mae: 1.9752
Epoch 44/150
25/25 [==============================] - 4s 140ms/step - loss: 1.5327 - mae: 1.9741
Epoch 45/150
25/25 [==============================] - 4s 141ms/step - loss: 1.5316 - mae: 1.9730
Epoch 46/150
25/25 [==============================] - 3s 133ms/step - loss: 1.5305 - mae: 1.9719
Epoch 47/150
25/25 [==============================] - 3s 135ms/step - loss: 1.5295 - mae: 1.9708
Epoch 48/150
25/25 [==============================] - 3s 138ms/step - loss: 1.5286 - mae: 1.9698
Epoch 49/150
25/25 [==============================] - 3s 136ms/step - loss: 1.5276 - mae: 1.9689
Epoch 50/150
25/25 [==============================] - 3s 136ms/step - loss: 1.5267 - mae: 1.9680
Epoch 51/150
25/25 [==============================] - 3s 139ms/step - loss: 1.5259 - mae: 1.9672
Epoch 52/150
25/25 [==============================] - 3s 134ms/step - loss: 1.5251 - mae: 1.9664
Epoch 53/150
25/25 [==============================] - 3s 135ms/step - loss: 1.5243 - mae: 1.9656
Epoch 54/150
25/25 [==============================] - 3s 137ms/step - loss: 1.5235 - mae: 1.9648
Epoch 55/150
25/25 [==============================] - 3s 137ms/step - loss: 1.5228 - mae: 1.9640
Epoch 56/150
25/25 [==============================] - 3s 136ms/step - loss: 1.5221 - mae: 1.9633
Epoch 57/150
25/25 [==============================] - 3s 136ms/step - loss: 1.5213 - mae: 1.9626
Epoch 58/150
25/25 [==============================] - 3s 137ms/step - loss: 1.5206 - mae: 1.9619
Epoch 59/150
25/25 [==============================] - 3s 135ms/step - loss: 1.5199 - mae: 1.9611
Epoch 60/150
25/25 [==============================] - 3s 133ms/step - loss: 1.5193 - mae: 1.9604
Epoch 61/150
25/25 [==============================] - 3s 133ms/step - loss: 1.5186 - mae: 1.9597
Epoch 62/150
25/25 [==============================] - 3s 131ms/step - loss: 1.5179 - mae: 1.9589
Epoch 63/150
25/25 [==============================] - 3s 131ms/step - loss: 1.5173 - mae: 1.9582
Epoch 64/150
25/25 [==============================] - 3s 135ms/step - loss: 1.5166 - mae: 1.9576
Epoch 65/150
25/25 [==============================] - 3s 133ms/step - loss: 1.5161 - mae: 1.9570
Epoch 66/150
25/25 [==============================] - 3s 138ms/step - loss: 1.5155 - mae: 1.9564
Epoch 67/150
25/25 [==============================] - 3s 140ms/step - loss: 1.5149 - mae: 1.9557
Epoch 68/150
25/25 [==============================] - 4s 141ms/step - loss: 1.5142 - mae: 1.9550
Epoch 69/150
25/25 [==============================] - 3s 133ms/step - loss: 1.5136 - mae: 1.9543
Epoch 70/150
25/25 [==============================] - 3s 130ms/step - loss: 1.5129 - mae: 1.9536
Epoch 71/150
25/25 [==============================] - 3s 132ms/step - loss: 1.5122 - mae: 1.9528
Epoch 72/150
25/25 [==============================] - 3s 132ms/step - loss: 1.5115 - mae: 1.9521
Epoch 73/150
25/25 [==============================] - 3s 133ms/step - loss: 1.5108 - mae: 1.9514
Epoch 74/150
25/25 [==============================] - 3s 135ms/step - loss: 1.5102 - mae: 1.9508
Epoch 75/150
25/25 [==============================] - 3s 133ms/step - loss: 1.5097 - mae: 1.9503
Epoch 76/150
25/25 [==============================] - 3s 134ms/step - loss: 1.5091 - mae: 1.9497
Epoch 77/150
25/25 [==============================] - 3s 137ms/step - loss: 1.5084 - mae: 1.9491
Epoch 78/150
25/25 [==============================] - 3s 128ms/step - loss: 1.5078 - mae: 1.9485
Epoch 79/150
25/25 [==============================] - 3s 129ms/step - loss: 1.5072 - mae: 1.9478
Epoch 80/150
25/25 [==============================] - 3s 134ms/step - loss: 1.5065 - mae: 1.9471
Epoch 81/150
25/25 [==============================] - 3s 136ms/step - loss: 1.5059 - mae: 1.9465
Epoch 82/150
25/25 [==============================] - 3s 134ms/step - loss: 1.5053 - mae: 1.9459
Epoch 83/150
25/25 [==============================] - 3s 132ms/step - loss: 1.5048 - mae: 1.9454
Epoch 84/150
25/25 [==============================] - 3s 134ms/step - loss: 1.5043 - mae: 1.9448
Epoch 85/150
25/25 [==============================] - 3s 132ms/step - loss: 1.5038 - mae: 1.9443
Epoch 86/150
25/25 [==============================] - 3s 131ms/step - loss: 1.5033 - mae: 1.9438
Epoch 87/150
25/25 [==============================] - 3s 132ms/step - loss: 1.5028 - mae: 1.9433
Epoch 88/150
25/25 [==============================] - 3s 130ms/step - loss: 1.5023 - mae: 1.9428
Epoch 89/150
25/25 [==============================] - 3s 134ms/step - loss: 1.5017 - mae: 1.9422
Epoch 90/150
25/25 [==============================] - 3s 132ms/step - loss: 1.5012 - mae: 1.9416
Epoch 91/150
25/25 [==============================] - 3s 131ms/step - loss: 1.5004 - mae: 1.9408
Epoch 92/150
25/25 [==============================] - 3s 132ms/step - loss: 1.4992 - mae: 1.9396
Epoch 93/150
25/25 [==============================] - 3s 132ms/step - loss: 1.4982 - mae: 1.9386
Epoch 94/150
25/25 [==============================] - 3s 136ms/step - loss: 1.4975 - mae: 1.9378
Epoch 95/150
25/25 [==============================] - 3s 134ms/step - loss: 1.4968 - mae: 1.9371
Epoch 96/150
25/25 [==============================] - 3s 136ms/step - loss: 1.4962 - mae: 1.9364
Epoch 97/150
25/25 [==============================] - 3s 137ms/step - loss: 1.4955 - mae: 1.9358
Epoch 98/150
25/25 [==============================] - 3s 140ms/step - loss: 1.4949 - mae: 1.9351
Epoch 99/150
25/25 [==============================] - 3s 134ms/step - loss: 1.4942 - mae: 1.9344
Epoch 100/150
25/25 [==============================] - 3s 134ms/step - loss: 1.4934 - mae: 1.9336
Epoch 101/150
25/25 [==============================] - 3s 135ms/step - loss: 1.4927 - mae: 1.9328
Epoch 102/150
25/25 [==============================] - 3s 132ms/step - loss: 1.4919 - mae: 1.9319
Epoch 103/150
25/25 [==============================] - 3s 131ms/step - loss: 1.4913 - mae: 1.9313
Epoch 104/150
25/25 [==============================] - 3s 132ms/step - loss: 1.4908 - mae: 1.9307
Epoch 105/150
25/25 [==============================] - 3s 133ms/step - loss: 1.4903 - mae: 1.9302
Epoch 106/150
25/25 [==============================] - 3s 131ms/step - loss: 1.4899 - mae: 1.9298
Epoch 107/150
25/25 [==============================] - 3s 130ms/step - loss: 1.4895 - mae: 1.9293
Epoch 108/150
25/25 [==============================] - 3s 130ms/step - loss: 1.4892 - mae: 1.9289
Epoch 109/150
25/25 [==============================] - 3s 132ms/step - loss: 1.4888 - mae: 1.9285
Epoch 110/150
25/25 [==============================] - 3s 131ms/step - loss: 1.4884 - mae: 1.9282
Epoch 111/150
25/25 [==============================] - 3s 133ms/step - loss: 1.4881 - mae: 1.9278
Epoch 112/150
25/25 [==============================] - 3s 130ms/step - loss: 1.4878 - mae: 1.9275
Epoch 113/150
25/25 [==============================] - 3s 131ms/step - loss: 1.4874 - mae: 1.9271
Epoch 114/150
25/25 [==============================] - 3s 136ms/step - loss: 1.4871 - mae: 1.9268
Epoch 115/150
25/25 [==============================] - 3s 130ms/step - loss: 1.4868 - mae: 1.9265
Epoch 116/150
25/25 [==============================] - 3s 132ms/step - loss: 1.4865 - mae: 1.9262
Epoch 117/150
25/25 [==============================] - 3s 134ms/step - loss: 1.4862 - mae: 1.9258
Epoch 118/150
25/25 [==============================] - 3s 132ms/step - loss: 1.4859 - mae: 1.9255
Epoch 119/150
25/25 [==============================] - 3s 130ms/step - loss: 1.4856 - mae: 1.9252
Epoch 120/150
25/25 [==============================] - 3s 134ms/step - loss: 1.4853 - mae: 1.9249
Epoch 121/150
25/25 [==============================] - 3s 134ms/step - loss: 1.4851 - mae: 1.9247
Epoch 122/150
25/25 [==============================] - 3s 135ms/step - loss: 1.4848 - mae: 1.9243
Epoch 123/150
25/25 [==============================] - 3s 131ms/step - loss: 1.4845 - mae: 1.9240
Epoch 124/150
25/25 [==============================] - 3s 134ms/step - loss: 1.4842 - mae: 1.9238
Epoch 125/150
25/25 [==============================] - 3s 133ms/step - loss: 1.4840 - mae: 1.9235
Epoch 126/150
25/25 [==============================] - 3s 131ms/step - loss: 1.4838 - mae: 1.9232
Epoch 127/150
25/25 [==============================] - 3s 129ms/step - loss: 1.4835 - mae: 1.9230
Epoch 128/150
25/25 [==============================] - 3s 132ms/step - loss: 1.4833 - mae: 1.9228
Epoch 129/150
25/25 [==============================] - 3s 131ms/step - loss: 1.4831 - mae: 1.9225
Epoch 130/150
25/25 [==============================] - 3s 129ms/step - loss: 1.4828 - mae: 1.9222
Epoch 131/150
25/25 [==============================] - 3s 128ms/step - loss: 1.4826 - mae: 1.9220
Epoch 132/150
25/25 [==============================] - 3s 127ms/step - loss: 1.4823 - mae: 1.9217
Epoch 133/150
25/25 [==============================] - 3s 129ms/step - loss: 1.4821 - mae: 1.9214
Epoch 134/150
25/25 [==============================] - 3s 129ms/step - loss: 1.4818 - mae: 1.9212
Epoch 135/150
25/25 [==============================] - 3s 132ms/step - loss: 1.4815 - mae: 1.9209
Epoch 136/150
25/25 [==============================] - 3s 131ms/step - loss: 1.4813 - mae: 1.9206
Epoch 137/150
25/25 [==============================] - 3s 127ms/step - loss: 1.4811 - mae: 1.9204
Epoch 138/150
25/25 [==============================] - 3s 131ms/step - loss: 1.4808 - mae: 1.9201
Epoch 139/150
25/25 [==============================] - 3s 130ms/step - loss: 1.4806 - mae: 1.9199
Epoch 140/150
25/25 [==============================] - 3s 130ms/step - loss: 1.4804 - mae: 1.9197
Epoch 141/150
25/25 [==============================] - 3s 132ms/step - loss: 1.4802 - mae: 1.9194
Epoch 142/150
25/25 [==============================] - 3s 129ms/step - loss: 1.4799 - mae: 1.9192
Epoch 143/150
25/25 [==============================] - 3s 134ms/step - loss: 1.4797 - mae: 1.9189
Epoch 144/150
25/25 [==============================] - 3s 135ms/step - loss: 1.4795 - mae: 1.9187
Epoch 145/150
25/25 [==============================] - 3s 131ms/step - loss: 1.4794 - mae: 1.9185
Epoch 146/150
25/25 [==============================] - 3s 131ms/step - loss: 1.4791 - mae: 1.9183
Epoch 147/150
25/25 [==============================] - 3s 130ms/step - loss: 1.4789 - mae: 1.9180
Epoch 148/150
25/25 [==============================] - 3s 136ms/step - loss: 1.4787 - mae: 1.9178
Epoch 149/150
25/25 [==============================] - 3s 137ms/step - loss: 1.4784 - mae: 1.9175
Epoch 150/150
25/25 [==============================] - 4s 143ms/step - loss: 1.4782 - mae: 1.9173
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rnn_forecast&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model_forecast&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;newaxis&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;window_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;rnn_forecast&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rnn_forecast&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;split_time&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;window_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figure&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figsize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plot_series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time_valid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x_valid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plot_series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time_valid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rnn_forecast&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# EXPECTED OUTPUT. PLOT SHOULD SHOW PROJECTIONS FOLLOWING ORIGINAL DATA CLOSELY&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;metrics&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean_absolute_error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x_valid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rnn_forecast&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;numpy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# EXPECTED OUTPUT MAE &amp;lt; 2 -- I GOT 1.789626&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;1.780626&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rnn_forecast&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# EXPECTED OUTPUT -- ARRAY OF VALUES IN THE LOW TEENS&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;[11.636601 10.97607  12.159701 ... 13.589686 13.726407 14.940471]
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;/div&gt;</content><author><name></name></author><summary type="html"></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://rafaelsf80.github.io/notebooks/images/machine-learning-mastery.png" /><media:content medium="image" url="https://rafaelsf80.github.io/notebooks/images/machine-learning-mastery.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Series temporales: datos sintéticos</title><link href="https://rafaelsf80.github.io/notebooks/tensorflow/2020/08/04/time-series-synthetic.html" rel="alternate" type="text/html" title="Series temporales: datos sintéticos" /><published>2020-08-04T00:00:00-05:00</published><updated>2020-08-04T00:00:00-05:00</updated><id>https://rafaelsf80.github.io/notebooks/tensorflow/2020/08/04/time-series-synthetic</id><content type="html" xml:base="https://rafaelsf80.github.io/notebooks/tensorflow/2020/08/04/time-series-synthetic.html">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-08-04-time-series-synthetic.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;# %tensorflow_version only exists in Colab.&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;tensorflow_version&lt;/span&gt; 2.x
&lt;span class=&quot;k&quot;&gt;except&lt;/span&gt; &lt;span class=&quot;ne&quot;&gt;Exception&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;pass&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tensorflow&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tf&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;plt&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;__version__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;2.2.0-dev20200507
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;plot_series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;-&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;end&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;end&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;end&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Time&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ylabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Value&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;grid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;trend&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;slope&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;slope&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;seasonal_pattern&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;season_time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;Just an arbitrary pattern, you can change it if you wish&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;where&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;season_time&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;season_time&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
                    &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;exp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;season_time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;seasonality&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;period&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;amplitude&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;phase&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;Repeats the same pattern at each period&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;season_time&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;phase&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;period&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;period&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;amplitude&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;seasonal_pattern&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;season_time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;noise&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;noise_level&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;rnd&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;RandomState&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rnd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;randn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;noise_level&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;arange&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;365&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dtype&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;float32&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;baseline&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;series&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;trend&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  
&lt;span class=&quot;n&quot;&gt;baseline&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;amplitude&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;40&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;slope&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.05&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;noise_level&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Create the series&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;series&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;baseline&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;trend&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;slope&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;seasonality&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;period&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;365&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;amplitude&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;amplitude&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Update with noise&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;series&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;noise&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;noise_level&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;42&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;split_time&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;time_train&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;split_time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;x_train&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;split_time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;time_valid&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;split_time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;x_valid&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;split_time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;window_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;shuffle_buffer_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;windowed_dataset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;window_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;shuffle_buffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;series&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;expand_dims&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;ds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dataset&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;from_tensor_slices&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;ds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ds&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;window&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;window_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;shift&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;drop_remainder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;ds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ds&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flat_map&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;lambda&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;w&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;w&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;window_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;ds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ds&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shuffle&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shuffle_buffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;ds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ds&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;lambda&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;w&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;w&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;w&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:]))&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ds&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;prefetch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;model_forecast&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;window_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;ds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dataset&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;from_tensor_slices&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;ds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ds&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;window&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;window_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;shift&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;drop_remainder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;ds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ds&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flat_map&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;lambda&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;w&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;w&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;window_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;ds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ds&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;prefetch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;forecast&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;forecast&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;backend&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;clear_session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;51&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;51&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;window_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;30&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;train_set&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;windowed_dataset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;window_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;128&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;shuffle_buffer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shuffle_buffer_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;models&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Sequential&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Conv1D&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filters&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;kernel_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                      &lt;span class=&quot;n&quot;&gt;strides&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;padding&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;causal&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                      &lt;span class=&quot;n&quot;&gt;activation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;relu&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                      &lt;span class=&quot;n&quot;&gt;input_shape&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]),&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Bidirectional&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;LSTM&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;return_sequences&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)),&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Bidirectional&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;LSTM&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;return_sequences&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)),&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Lambda&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;lambda&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;200&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;lr_schedule&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;callbacks&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;LearningRateScheduler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;lambda&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;epoch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1e-8&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;epoch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;optimizers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SGD&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1e-8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;momentum&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;compile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;losses&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Huber&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt;
              &lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
              &lt;span class=&quot;n&quot;&gt;metrics&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;mae&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;history&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_set&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;epochs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;callbacks&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lr_schedule&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Epoch 1/100
8/8 [==============================] - 1s 64ms/step - loss: 73.1912 - mae: 73.6903
Epoch 2/100
8/8 [==============================] - 0s 49ms/step - loss: 72.4799 - mae: 72.9791
Epoch 3/100
8/8 [==============================] - 0s 46ms/step - loss: 71.3446 - mae: 71.8437
Epoch 4/100
8/8 [==============================] - 0s 37ms/step - loss: 69.9230 - mae: 70.4223
Epoch 5/100
8/8 [==============================] - 0s 54ms/step - loss: 68.2678 - mae: 68.7669
Epoch 6/100
8/8 [==============================] - 0s 40ms/step - loss: 66.3621 - mae: 66.8609
Epoch 7/100
8/8 [==============================] - 0s 48ms/step - loss: 64.2432 - mae: 64.7424
Epoch 8/100
8/8 [==============================] - 0s 43ms/step - loss: 61.8749 - mae: 62.3738
Epoch 9/100
8/8 [==============================] - 1s 64ms/step - loss: 59.2491 - mae: 59.7479
Epoch 10/100
8/8 [==============================] - 0s 48ms/step - loss: 56.3267 - mae: 56.8254
Epoch 11/100
8/8 [==============================] - 0s 54ms/step - loss: 53.0701 - mae: 53.5686
Epoch 12/100
8/8 [==============================] - 0s 47ms/step - loss: 49.3867 - mae: 49.8850
Epoch 13/100
8/8 [==============================] - 0s 46ms/step - loss: 45.1183 - mae: 45.6166
Epoch 14/100
8/8 [==============================] - 0s 39ms/step - loss: 41.6539 - mae: 42.1518
Epoch 15/100
8/8 [==============================] - 0s 43ms/step - loss: 40.6341 - mae: 41.1322
Epoch 16/100
8/8 [==============================] - 0s 49ms/step - loss: 39.5119 - mae: 40.0100
Epoch 17/100
8/8 [==============================] - 0s 40ms/step - loss: 38.1009 - mae: 38.5986
Epoch 18/100
8/8 [==============================] - 0s 49ms/step - loss: 36.5304 - mae: 37.0279
Epoch 19/100
8/8 [==============================] - 0s 39ms/step - loss: 34.9672 - mae: 35.4642
Epoch 20/100
8/8 [==============================] - 0s 47ms/step - loss: 33.5379 - mae: 34.0347
Epoch 21/100
8/8 [==============================] - 0s 50ms/step - loss: 32.2358 - mae: 32.7321
Epoch 22/100
8/8 [==============================] - 0s 46ms/step - loss: 31.0509 - mae: 31.5469
Epoch 23/100
8/8 [==============================] - 0s 41ms/step - loss: 29.9243 - mae: 30.4202
Epoch 24/100
8/8 [==============================] - 0s 51ms/step - loss: 28.8317 - mae: 29.3274
Epoch 25/100
8/8 [==============================] - 0s 52ms/step - loss: 27.7314 - mae: 28.2272
Epoch 26/100
8/8 [==============================] - 0s 44ms/step - loss: 26.6107 - mae: 27.1066
Epoch 27/100
8/8 [==============================] - 0s 38ms/step - loss: 25.4565 - mae: 25.9519
Epoch 28/100
8/8 [==============================] - 0s 62ms/step - loss: 24.2668 - mae: 24.7617
Epoch 29/100
8/8 [==============================] - 0s 38ms/step - loss: 23.0459 - mae: 23.5406
Epoch 30/100
8/8 [==============================] - 0s 45ms/step - loss: 21.8057 - mae: 22.3000
Epoch 31/100
8/8 [==============================] - 0s 40ms/step - loss: 20.5264 - mae: 21.0202
Epoch 32/100
8/8 [==============================] - 0s 61ms/step - loss: 19.2341 - mae: 19.7269
Epoch 33/100
8/8 [==============================] - 0s 52ms/step - loss: 17.9646 - mae: 18.4568
Epoch 34/100
8/8 [==============================] - 0s 41ms/step - loss: 16.9362 - mae: 17.4279
Epoch 35/100
8/8 [==============================] - 0s 42ms/step - loss: 16.2657 - mae: 16.7576
Epoch 36/100
8/8 [==============================] - 0s 40ms/step - loss: 15.6281 - mae: 16.1192
Epoch 37/100
8/8 [==============================] - 0s 38ms/step - loss: 15.0540 - mae: 15.5447
Epoch 38/100
8/8 [==============================] - 0s 49ms/step - loss: 14.5219 - mae: 15.0126
Epoch 39/100
8/8 [==============================] - 0s 41ms/step - loss: 13.9836 - mae: 14.4747
Epoch 40/100
8/8 [==============================] - 0s 53ms/step - loss: 13.4414 - mae: 13.9318
Epoch 41/100
8/8 [==============================] - 0s 43ms/step - loss: 12.8781 - mae: 13.3677
Epoch 42/100
8/8 [==============================] - 0s 50ms/step - loss: 12.2855 - mae: 12.7749
Epoch 43/100
8/8 [==============================] - 0s 45ms/step - loss: 11.6690 - mae: 12.1582
Epoch 44/100
8/8 [==============================] - 0s 38ms/step - loss: 11.0181 - mae: 11.5063
Epoch 45/100
8/8 [==============================] - 0s 41ms/step - loss: 10.3387 - mae: 10.8260
Epoch 46/100
8/8 [==============================] - 0s 42ms/step - loss: 9.6894 - mae: 10.1757
Epoch 47/100
8/8 [==============================] - 0s 38ms/step - loss: 9.0956 - mae: 9.5809
Epoch 48/100
8/8 [==============================] - 0s 59ms/step - loss: 8.5688 - mae: 9.0536
Epoch 49/100
8/8 [==============================] - 0s 49ms/step - loss: 8.1153 - mae: 8.5996
Epoch 50/100
8/8 [==============================] - 0s 40ms/step - loss: 7.7040 - mae: 8.1884
Epoch 51/100
8/8 [==============================] - 0s 39ms/step - loss: 7.3262 - mae: 7.8096
Epoch 52/100
8/8 [==============================] - 0s 46ms/step - loss: 6.9725 - mae: 7.4548
Epoch 53/100
8/8 [==============================] - 0s 52ms/step - loss: 6.6218 - mae: 7.1033
Epoch 54/100
8/8 [==============================] - 0s 41ms/step - loss: 6.2898 - mae: 6.7712
Epoch 55/100
8/8 [==============================] - 0s 43ms/step - loss: 5.9775 - mae: 6.4581
Epoch 56/100
8/8 [==============================] - 0s 44ms/step - loss: 5.7096 - mae: 6.1898
Epoch 57/100
8/8 [==============================] - 0s 41ms/step - loss: 5.4204 - mae: 5.8992
Epoch 58/100
8/8 [==============================] - 0s 53ms/step - loss: 5.2126 - mae: 5.6904
Epoch 59/100
8/8 [==============================] - 0s 62ms/step - loss: 4.9788 - mae: 5.4558
Epoch 60/100
8/8 [==============================] - 0s 38ms/step - loss: 4.8674 - mae: 5.3438
Epoch 61/100
8/8 [==============================] - 0s 40ms/step - loss: 4.7943 - mae: 5.2711
Epoch 62/100
8/8 [==============================] - 0s 38ms/step - loss: 4.6056 - mae: 5.0814
Epoch 63/100
8/8 [==============================] - 0s 55ms/step - loss: 4.7894 - mae: 5.2667
Epoch 64/100
8/8 [==============================] - 0s 51ms/step - loss: 5.3933 - mae: 5.8745
Epoch 65/100
8/8 [==============================] - 0s 39ms/step - loss: 5.8707 - mae: 6.3541
Epoch 66/100
8/8 [==============================] - 0s 41ms/step - loss: 5.9398 - mae: 6.4232
Epoch 67/100
8/8 [==============================] - 0s 61ms/step - loss: 4.9885 - mae: 5.4691
Epoch 68/100
8/8 [==============================] - 0s 47ms/step - loss: 4.9485 - mae: 5.4277
Epoch 69/100
8/8 [==============================] - 0s 44ms/step - loss: 5.5203 - mae: 6.0028
Epoch 70/100
8/8 [==============================] - 0s 38ms/step - loss: 6.2567 - mae: 6.7418
Epoch 71/100
8/8 [==============================] - 0s 47ms/step - loss: 5.9135 - mae: 6.3976
Epoch 72/100
8/8 [==============================] - 0s 47ms/step - loss: 6.7331 - mae: 7.2217
Epoch 73/100
8/8 [==============================] - 0s 43ms/step - loss: 6.8394 - mae: 7.3263
Epoch 74/100
8/8 [==============================] - 0s 49ms/step - loss: 7.1395 - mae: 7.6270
Epoch 75/100
8/8 [==============================] - 0s 40ms/step - loss: 8.3340 - mae: 8.8248
Epoch 76/100
8/8 [==============================] - 0s 42ms/step - loss: 9.7772 - mae: 10.2679
Epoch 77/100
8/8 [==============================] - 0s 38ms/step - loss: 8.8560 - mae: 9.3441
Epoch 78/100
8/8 [==============================] - 0s 46ms/step - loss: 9.5717 - mae: 10.0601
Epoch 79/100
8/8 [==============================] - 0s 42ms/step - loss: 17.9317 - mae: 18.4237
Epoch 80/100
8/8 [==============================] - 0s 46ms/step - loss: 35.1177 - mae: 35.6156
Epoch 81/100
8/8 [==============================] - 0s 46ms/step - loss: 17.8087 - mae: 18.3036
Epoch 82/100
8/8 [==============================] - 0s 46ms/step - loss: 16.2955 - mae: 16.7919
Epoch 83/100
8/8 [==============================] - 0s 47ms/step - loss: 15.0972 - mae: 15.5927
Epoch 84/100
8/8 [==============================] - 0s 47ms/step - loss: 9.0429 - mae: 9.5317
Epoch 85/100
8/8 [==============================] - 0s 41ms/step - loss: 8.3368 - mae: 8.8268
Epoch 86/100
8/8 [==============================] - 0s 49ms/step - loss: 9.3932 - mae: 9.8812
Epoch 87/100
8/8 [==============================] - 0s 53ms/step - loss: 16.2914 - mae: 16.7856
Epoch 88/100
8/8 [==============================] - 0s 51ms/step - loss: 15.9402 - mae: 16.4350
Epoch 89/100
8/8 [==============================] - 0s 60ms/step - loss: 22.0256 - mae: 22.5212
Epoch 90/100
8/8 [==============================] - 0s 57ms/step - loss: 19.5584 - mae: 20.0547
Epoch 91/100
8/8 [==============================] - 0s 44ms/step - loss: 20.1753 - mae: 20.6719
Epoch 92/100
8/8 [==============================] - 0s 40ms/step - loss: 14.1138 - mae: 14.6060
Epoch 93/100
8/8 [==============================] - 0s 51ms/step - loss: 23.2701 - mae: 23.7673
Epoch 94/100
8/8 [==============================] - 0s 46ms/step - loss: 17.4064 - mae: 17.9010
Epoch 95/100
8/8 [==============================] - 0s 50ms/step - loss: 12.7717 - mae: 13.2629
Epoch 96/100
8/8 [==============================] - 0s 62ms/step - loss: 15.7108 - mae: 16.2057
Epoch 97/100
8/8 [==============================] - 0s 52ms/step - loss: 17.7694 - mae: 18.2629
Epoch 98/100
8/8 [==============================] - 0s 46ms/step - loss: 21.1374 - mae: 21.6334
Epoch 99/100
8/8 [==============================] - 0s 41ms/step - loss: 19.1119 - mae: 19.6072
Epoch 100/100
8/8 [==============================] - 0s 53ms/step - loss: 19.4526 - mae: 19.9481
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;semilogx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;history&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;history&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;lr&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;history&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;history&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;loss&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1e-8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1e-4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;30&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;backend&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;clear_session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;51&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;51&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#batch_size = 16&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;dataset&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;windowed_dataset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;window_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;shuffle_buffer_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;models&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Sequential&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Conv1D&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filters&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;kernel_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                      &lt;span class=&quot;n&quot;&gt;strides&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;padding&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;causal&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                      &lt;span class=&quot;n&quot;&gt;activation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;relu&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                      &lt;span class=&quot;n&quot;&gt;input_shape&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]),&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;LSTM&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;return_sequences&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;LSTM&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;return_sequences&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Lambda&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;lambda&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;200&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;optimizers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SGD&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1e-5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;momentum&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;compile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;losses&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Huber&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt;
              &lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
              &lt;span class=&quot;n&quot;&gt;metrics&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;mae&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;history&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dataset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;epochs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;500&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rnn_forecast&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model_forecast&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;newaxis&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;window_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;rnn_forecast&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rnn_forecast&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;split_time&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;window_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figure&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figsize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plot_series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time_valid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x_valid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plot_series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time_valid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rnn_forecast&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;metrics&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean_absolute_error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x_valid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rnn_forecast&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;numpy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib.image&lt;/span&gt;  &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;mpimg&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;plt&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;#-----------------------------------------------------------&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Retrieve a list of list results on training and test data&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# sets for each training epoch&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#-----------------------------------------------------------&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;mae&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;history&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;history&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;mae&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;history&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;history&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;loss&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;epochs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# Get number of epochs&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;#------------------------------------------------&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Plot MAE and Loss&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#------------------------------------------------&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;epochs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mae&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;r&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;epochs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;b&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;MAE and Loss&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Epochs&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ylabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Accuracy&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;legend&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;MAE&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;Loss&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figure&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;epochs_zoom&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;epochs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;200&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;mae_zoom&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mae&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;200&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;loss_zoom&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;200&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;#------------------------------------------------&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Plot Zoomed MAE and Loss&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#------------------------------------------------&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;epochs_zoom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mae_zoom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;r&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;epochs_zoom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;loss_zoom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;b&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;MAE and Loss&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Epochs&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ylabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Accuracy&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;legend&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;MAE&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;Loss&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figure&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;/div&gt;</content><author><name></name></author><summary type="html"></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://rafaelsf80.github.io/notebooks/images/kaggle.png" /><media:content medium="image" url="https://rafaelsf80.github.io/notebooks/images/kaggle.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Series temporales: manchas solares</title><link href="https://rafaelsf80.github.io/notebooks/tensorflow/2020/08/04/time-series-sunspots.html" rel="alternate" type="text/html" title="Series temporales: manchas solares" /><published>2020-08-04T00:00:00-05:00</published><updated>2020-08-04T00:00:00-05:00</updated><id>https://rafaelsf80.github.io/notebooks/tensorflow/2020/08/04/time-series-sunspots</id><content type="html" xml:base="https://rafaelsf80.github.io/notebooks/tensorflow/2020/08/04/time-series-sunspots.html">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-08-04-time-series-sunspots.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Introducci&amp;#243;n&quot;&gt;Introducci&amp;#243;n&lt;a class=&quot;anchor-link&quot; href=&quot;#Introducci&amp;#243;n&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;Se resolverá la competición de Kaggle &lt;a href=&quot;https://www.kaggle.com/robervalt/sunspots&quot;&gt;sobre manchas solares&lt;/a&gt;.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tensorflow&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tf&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;__version__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;plt&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;plot_series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;-&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;end&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;end&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;end&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Time&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ylabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Value&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;grid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;wget --no-check-certificate &lt;span class=&quot;err&quot;&gt;\&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;https&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;//&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;raw&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;githubusercontent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;jbrownlee&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Datasets&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;master&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;daily&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;min&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;temperatures&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;csv&lt;/span&gt; \
    &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;O&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tmp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;daily&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;min&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;temperatures&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;csv&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;csv&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;time_step&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;temps&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;/tmp/daily-min-temperatures.csv&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;csvfile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# YOUR CODE HERE. READ TEMPERATURES INTO TEMPS&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# HAVE TIME STEPS BE A SIMPLE ARRAY OF 1, 2, 3, 4 etc&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;series&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;temps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time_step&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figure&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figsize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plot_series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;split_time&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2500&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;time_train&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# YOUR CODE HERE&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;x_train&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# YOUR CODE HERE&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;time_valid&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# YOUR CODE HERE&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;x_valid&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# YOUR CODE HERE&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;window_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;30&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;shuffle_buffer_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;windowed_dataset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;window_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;shuffle_buffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# YOUR CODE HERE&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;model_forecast&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;window_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# YOUR CODE HERE&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;backend&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;clear_session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;51&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;51&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;window_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;64&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;256&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;train_set&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;windowed_dataset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;window_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;shuffle_buffer_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_set&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x_train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;models&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Sequential&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# YOUR CODE HERE&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;lr_schedule&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;callbacks&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;LearningRateScheduler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;lambda&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;epoch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1e-8&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;epoch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;optimizers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SGD&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1e-8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;momentum&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;compile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;losses&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Huber&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt;
              &lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
              &lt;span class=&quot;n&quot;&gt;metrics&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;mae&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;history&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_set&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;epochs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;callbacks&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lr_schedule&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stderr output_text&quot;&gt;
&lt;pre&gt;WARNING: Logging before flag parsing goes to stderr.
W0719 05:10:05.389573 140234944071552 deprecation.py:323] From /usr/local/lib/python3.6/dist-packages/tensorflow/python/data/util/random_seed.py:58: add_dispatch_support.&amp;lt;locals&amp;gt;.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;&amp;lt;PrefetchDataset shapes: ((None, None, 1), (None, None, 1)), types: (tf.float64, tf.float64)&amp;gt;
(2500,)
Epoch 1/100
10/10 [==============================] - 6s 624ms/step - loss: 31.1549 - mae: 31.6551
Epoch 2/100
10/10 [==============================] - 4s 364ms/step - loss: 30.5696 - mae: 31.0771
Epoch 3/100
10/10 [==============================] - 4s 358ms/step - loss: 29.6691 - mae: 30.1811
Epoch 4/100
10/10 [==============================] - 4s 366ms/step - loss: 28.5431 - mae: 29.0596
Epoch 5/100
10/10 [==============================] - 4s 361ms/step - loss: 27.1744 - mae: 27.6976
Epoch 6/100
10/10 [==============================] - 4s 367ms/step - loss: 25.4676 - mae: 26.0015
Epoch 7/100
10/10 [==============================] - 4s 375ms/step - loss: 23.2987 - mae: 23.8487
Epoch 8/100
10/10 [==============================] - 4s 369ms/step - loss: 20.5506 - mae: 21.1192
Epoch 9/100
10/10 [==============================] - 4s 372ms/step - loss: 17.2408 - mae: 17.8223
Epoch 10/100
10/10 [==============================] - 4s 365ms/step - loss: 13.5549 - mae: 14.1350
Epoch 11/100
10/10 [==============================] - 4s 370ms/step - loss: 10.0753 - mae: 10.6367
Epoch 12/100
10/10 [==============================] - 4s 365ms/step - loss: 7.5638 - mae: 8.0985
Epoch 13/100
10/10 [==============================] - 4s 363ms/step - loss: 6.2445 - mae: 6.7619
Epoch 14/100
10/10 [==============================] - 4s 374ms/step - loss: 5.6749 - mae: 6.1854
Epoch 15/100
10/10 [==============================] - 4s 363ms/step - loss: 5.3090 - mae: 5.8168
Epoch 16/100
10/10 [==============================] - 4s 361ms/step - loss: 4.9122 - mae: 5.4169
Epoch 17/100
10/10 [==============================] - 4s 356ms/step - loss: 4.5318 - mae: 5.0305
Epoch 18/100
10/10 [==============================] - 4s 367ms/step - loss: 4.2115 - mae: 4.7068
Epoch 19/100
10/10 [==============================] - 4s 374ms/step - loss: 3.9429 - mae: 4.4360
Epoch 20/100
10/10 [==============================] - 4s 358ms/step - loss: 3.7309 - mae: 4.2194
Epoch 21/100
10/10 [==============================] - 4s 363ms/step - loss: 3.5706 - mae: 4.0551
Epoch 22/100
10/10 [==============================] - 4s 366ms/step - loss: 3.4527 - mae: 3.9344
Epoch 23/100
10/10 [==============================] - 4s 362ms/step - loss: 3.3617 - mae: 3.8423
Epoch 24/100
10/10 [==============================] - 4s 358ms/step - loss: 3.2876 - mae: 3.7666
Epoch 25/100
10/10 [==============================] - 3s 344ms/step - loss: 3.2224 - mae: 3.6997
Epoch 26/100
10/10 [==============================] - 4s 360ms/step - loss: 3.1596 - mae: 3.6359
Epoch 27/100
10/10 [==============================] - 4s 360ms/step - loss: 3.0964 - mae: 3.5717
Epoch 28/100
10/10 [==============================] - 4s 362ms/step - loss: 3.0322 - mae: 3.5064
Epoch 29/100
10/10 [==============================] - 4s 352ms/step - loss: 2.9662 - mae: 3.4392
Epoch 30/100
10/10 [==============================] - 4s 359ms/step - loss: 2.9004 - mae: 3.3720
Epoch 31/100
10/10 [==============================] - 4s 361ms/step - loss: 2.8376 - mae: 3.3081
Epoch 32/100
10/10 [==============================] - 4s 375ms/step - loss: 2.7775 - mae: 3.2475
Epoch 33/100
10/10 [==============================] - 4s 360ms/step - loss: 2.7202 - mae: 3.1899
Epoch 34/100
10/10 [==============================] - 4s 367ms/step - loss: 2.6662 - mae: 3.1360
Epoch 35/100
10/10 [==============================] - 4s 379ms/step - loss: 2.6152 - mae: 3.0848
Epoch 36/100
10/10 [==============================] - 4s 357ms/step - loss: 2.5663 - mae: 3.0353
Epoch 37/100
10/10 [==============================] - 4s 366ms/step - loss: 2.5192 - mae: 2.9872
Epoch 38/100
10/10 [==============================] - 4s 367ms/step - loss: 2.4735 - mae: 2.9408
Epoch 39/100
10/10 [==============================] - 4s 372ms/step - loss: 2.4296 - mae: 2.8964
Epoch 40/100
10/10 [==============================] - 4s 371ms/step - loss: 2.3873 - mae: 2.8534
Epoch 41/100
10/10 [==============================] - 4s 361ms/step - loss: 2.3463 - mae: 2.8119
Epoch 42/100
10/10 [==============================] - 4s 354ms/step - loss: 2.3060 - mae: 2.7707
Epoch 43/100
10/10 [==============================] - 4s 375ms/step - loss: 2.2663 - mae: 2.7301
Epoch 44/100
10/10 [==============================] - 4s 359ms/step - loss: 2.2269 - mae: 2.6899
Epoch 45/100
10/10 [==============================] - 4s 366ms/step - loss: 2.1898 - mae: 2.6519
Epoch 46/100
10/10 [==============================] - 4s 367ms/step - loss: 2.1563 - mae: 2.6181
Epoch 47/100
10/10 [==============================] - 4s 363ms/step - loss: 2.1248 - mae: 2.5861
Epoch 48/100
10/10 [==============================] - 4s 367ms/step - loss: 2.0958 - mae: 2.5568
Epoch 49/100
10/10 [==============================] - 4s 363ms/step - loss: 2.0688 - mae: 2.5296
Epoch 50/100
10/10 [==============================] - 4s 370ms/step - loss: 2.0442 - mae: 2.5045
Epoch 51/100
10/10 [==============================] - 4s 371ms/step - loss: 2.0220 - mae: 2.4818
Epoch 52/100
10/10 [==============================] - 4s 362ms/step - loss: 2.0018 - mae: 2.4611
Epoch 53/100
10/10 [==============================] - 4s 361ms/step - loss: 1.9801 - mae: 2.4393
Epoch 54/100
10/10 [==============================] - 4s 369ms/step - loss: 1.9586 - mae: 2.4171
Epoch 55/100
10/10 [==============================] - 4s 358ms/step - loss: 1.9390 - mae: 2.3972
Epoch 56/100
10/10 [==============================] - 4s 366ms/step - loss: 1.9186 - mae: 2.3763
Epoch 57/100
10/10 [==============================] - 4s 366ms/step - loss: 1.8975 - mae: 2.3550
Epoch 58/100
10/10 [==============================] - 4s 359ms/step - loss: 1.8743 - mae: 2.3320
Epoch 59/100
10/10 [==============================] - 4s 363ms/step - loss: 1.8738 - mae: 2.3310
Epoch 60/100
10/10 [==============================] - 4s 354ms/step - loss: 2.1527 - mae: 2.6201
Epoch 61/100
10/10 [==============================] - 4s 357ms/step - loss: 2.6764 - mae: 3.1247
Epoch 62/100
10/10 [==============================] - 4s 360ms/step - loss: 2.9935 - mae: 3.4806
Epoch 63/100
10/10 [==============================] - 4s 360ms/step - loss: 3.5219 - mae: 3.9875
Epoch 64/100
10/10 [==============================] - 4s 361ms/step - loss: 3.8284 - mae: 4.2965
Epoch 65/100
10/10 [==============================] - 4s 357ms/step - loss: 4.1265 - mae: 4.5856
Epoch 66/100
10/10 [==============================] - 4s 359ms/step - loss: 4.3062 - mae: 4.7664
Epoch 67/100
10/10 [==============================] - 4s 358ms/step - loss: 4.3039 - mae: 4.6838
Epoch 68/100
10/10 [==============================] - 4s 363ms/step - loss: 4.8341 - mae: 5.2257
Epoch 69/100
10/10 [==============================] - 4s 370ms/step - loss: 10.3352 - mae: 10.7649
Epoch 70/100
10/10 [==============================] - 4s 367ms/step - loss: 5.4020 - mae: 5.8328
Epoch 71/100
10/10 [==============================] - 4s 363ms/step - loss: 5.9798 - mae: 6.4835
Epoch 72/100
10/10 [==============================] - 4s 356ms/step - loss: 5.4958 - mae: 6.0146
Epoch 73/100
10/10 [==============================] - 4s 362ms/step - loss: 4.4955 - mae: 5.0201
Epoch 74/100
10/10 [==============================] - 4s 370ms/step - loss: 4.4764 - mae: 5.0171
Epoch 75/100
10/10 [==============================] - 4s 380ms/step - loss: 4.2825 - mae: 4.7287
Epoch 76/100
10/10 [==============================] - 4s 361ms/step - loss: 4.2044 - mae: 4.6470
Epoch 77/100
10/10 [==============================] - 4s 370ms/step - loss: 4.4160 - mae: 4.9125
Epoch 78/100
10/10 [==============================] - 4s 361ms/step - loss: 4.3770 - mae: 4.8831
Epoch 79/100
10/10 [==============================] - 4s 361ms/step - loss: 5.0487 - mae: 5.5839
Epoch 80/100
10/10 [==============================] - 4s 390ms/step - loss: 10.0358 - mae: 10.8604
Epoch 81/100
10/10 [==============================] - 4s 370ms/step - loss: 3.1176 - mae: 3.6060
Epoch 82/100
10/10 [==============================] - 4s 371ms/step - loss: 3.0097 - mae: 3.4891
Epoch 83/100
10/10 [==============================] - 4s 361ms/step - loss: 2.7912 - mae: 3.2609
Epoch 84/100
10/10 [==============================] - 4s 357ms/step - loss: 4.3135 - mae: 4.7803
Epoch 85/100
10/10 [==============================] - 4s 357ms/step - loss: 5.3703 - mae: 5.8508
Epoch 86/100
10/10 [==============================] - 4s 360ms/step - loss: 6.5221 - mae: 7.0175
Epoch 87/100
10/10 [==============================] - 4s 361ms/step - loss: 7.1154 - mae: 7.7249
Epoch 88/100
10/10 [==============================] - 4s 368ms/step - loss: 8.9975 - mae: 9.4580
Epoch 89/100
10/10 [==============================] - 4s 360ms/step - loss: 9.8069 - mae: 10.1397
Epoch 90/100
10/10 [==============================] - 4s 354ms/step - loss: 11.1364 - mae: 11.6797
Epoch 91/100
10/10 [==============================] - 4s 356ms/step - loss: 12.5922 - mae: 13.2602
Epoch 92/100
10/10 [==============================] - 4s 357ms/step - loss: 14.2512 - mae: 14.8289
Epoch 93/100
10/10 [==============================] - 4s 358ms/step - loss: 13.0192 - mae: 13.8809
Epoch 94/100
10/10 [==============================] - 4s 356ms/step - loss: 61.8923 - mae: 63.5737
Epoch 95/100
10/10 [==============================] - 4s 366ms/step - loss: 30.5821 - mae: 31.4688
Epoch 96/100
10/10 [==============================] - 4s 357ms/step - loss: 45.9889 - mae: 46.9740
Epoch 97/100
10/10 [==============================] - 4s 355ms/step - loss: 51.7050 - mae: 51.8100
Epoch 98/100
10/10 [==============================] - 4s 361ms/step - loss: 59.1678 - mae: 57.9463
Epoch 99/100
10/10 [==============================] - 4s 373ms/step - loss: 66.1686 - mae: 68.4903
Epoch 100/100
10/10 [==============================] - 4s 360ms/step - loss: 74.1415 - mae: 72.0624
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;semilogx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;history&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;history&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;lr&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;history&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;history&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;loss&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1e-8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1e-4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;60&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;[1e-08, 0.0001, 0, 60]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
IAp9EZEA+Q/EvnPaR7UhDAAAAABJRU5ErkJggg==
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;backend&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;clear_session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;51&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;51&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;train_set&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;windowed_dataset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;window_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;60&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;shuffle_buffer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shuffle_buffer_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;models&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Sequential&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# YOUR CODE HERE&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;


&lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;optimizers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SGD&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# YOUR CODE HERE, momentum=0.9)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;compile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;losses&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Huber&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt;
              &lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
              &lt;span class=&quot;n&quot;&gt;metrics&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;mae&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;history&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_set&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;epochs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# YOUR CODE HERE)&lt;/span&gt;
                                    
&lt;span class=&quot;c1&quot;&gt;# EXPECTED OUTPUT SHOULD SEE AN MAE OF &amp;lt;2 WITHIN ABOUT 30 EPOCHS&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Epoch 1/150
25/25 [==============================] - 6s 243ms/step - loss: 9.9624 - mae: 10.5789
Epoch 2/150
25/25 [==============================] - 3s 136ms/step - loss: 2.5390 - mae: 3.0130
Epoch 3/150
25/25 [==============================] - 3s 131ms/step - loss: 1.9265 - mae: 2.3815
Epoch 4/150
25/25 [==============================] - 3s 137ms/step - loss: 1.8597 - mae: 2.3125
Epoch 5/150
25/25 [==============================] - 3s 139ms/step - loss: 1.8181 - mae: 2.2696
Epoch 6/150
25/25 [==============================] - 3s 140ms/step - loss: 1.7882 - mae: 2.2385
Epoch 7/150
25/25 [==============================] - 4s 141ms/step - loss: 1.7618 - mae: 2.2112
Epoch 8/150
25/25 [==============================] - 3s 135ms/step - loss: 1.7382 - mae: 2.1870
Epoch 9/150
25/25 [==============================] - 3s 136ms/step - loss: 1.7167 - mae: 2.1650
Epoch 10/150
25/25 [==============================] - 3s 136ms/step - loss: 1.6976 - mae: 2.1454
Epoch 11/150
25/25 [==============================] - 3s 138ms/step - loss: 1.6808 - mae: 2.1281
Epoch 12/150
25/25 [==============================] - 3s 138ms/step - loss: 1.6661 - mae: 2.1128
Epoch 13/150
25/25 [==============================] - 4s 142ms/step - loss: 1.6531 - mae: 2.0993
Epoch 14/150
25/25 [==============================] - 4s 142ms/step - loss: 1.6417 - mae: 2.0872
Epoch 15/150
25/25 [==============================] - 3s 135ms/step - loss: 1.6315 - mae: 2.0764
Epoch 16/150
25/25 [==============================] - 3s 128ms/step - loss: 1.6223 - mae: 2.0667
Epoch 17/150
25/25 [==============================] - 3s 132ms/step - loss: 1.6141 - mae: 2.0579
Epoch 18/150
25/25 [==============================] - 3s 130ms/step - loss: 1.6067 - mae: 2.0500
Epoch 19/150
25/25 [==============================] - 3s 133ms/step - loss: 1.6000 - mae: 2.0429
Epoch 20/150
25/25 [==============================] - 3s 138ms/step - loss: 1.5939 - mae: 2.0364
Epoch 21/150
25/25 [==============================] - 3s 137ms/step - loss: 1.5883 - mae: 2.0306
Epoch 22/150
25/25 [==============================] - 3s 136ms/step - loss: 1.5833 - mae: 2.0254
Epoch 23/150
25/25 [==============================] - 4s 141ms/step - loss: 1.5787 - mae: 2.0207
Epoch 24/150
25/25 [==============================] - 3s 140ms/step - loss: 1.5745 - mae: 2.0163
Epoch 25/150
25/25 [==============================] - 4s 141ms/step - loss: 1.5707 - mae: 2.0124
Epoch 26/150
25/25 [==============================] - 3s 132ms/step - loss: 1.5672 - mae: 2.0089
Epoch 27/150
25/25 [==============================] - 3s 133ms/step - loss: 1.5640 - mae: 2.0056
Epoch 28/150
25/25 [==============================] - 3s 135ms/step - loss: 1.5610 - mae: 2.0026
Epoch 29/150
25/25 [==============================] - 3s 136ms/step - loss: 1.5583 - mae: 1.9998
Epoch 30/150
25/25 [==============================] - 3s 133ms/step - loss: 1.5558 - mae: 1.9973
Epoch 31/150
25/25 [==============================] - 3s 132ms/step - loss: 1.5534 - mae: 1.9949
Epoch 32/150
25/25 [==============================] - 3s 139ms/step - loss: 1.5512 - mae: 1.9927
Epoch 33/150
25/25 [==============================] - 3s 139ms/step - loss: 1.5491 - mae: 1.9906
Epoch 34/150
25/25 [==============================] - 3s 138ms/step - loss: 1.5472 - mae: 1.9886
Epoch 35/150
25/25 [==============================] - 4s 140ms/step - loss: 1.5453 - mae: 1.9868
Epoch 36/150
25/25 [==============================] - 4s 141ms/step - loss: 1.5436 - mae: 1.9850
Epoch 37/150
25/25 [==============================] - 3s 132ms/step - loss: 1.5419 - mae: 1.9833
Epoch 38/150
25/25 [==============================] - 3s 130ms/step - loss: 1.5404 - mae: 1.9817
Epoch 39/150
25/25 [==============================] - 3s 130ms/step - loss: 1.5389 - mae: 1.9803
Epoch 40/150
25/25 [==============================] - 3s 133ms/step - loss: 1.5376 - mae: 1.9789
Epoch 41/150
25/25 [==============================] - 3s 132ms/step - loss: 1.5363 - mae: 1.9776
Epoch 42/150
25/25 [==============================] - 3s 129ms/step - loss: 1.5350 - mae: 1.9764
Epoch 43/150
25/25 [==============================] - 3s 132ms/step - loss: 1.5338 - mae: 1.9752
Epoch 44/150
25/25 [==============================] - 4s 140ms/step - loss: 1.5327 - mae: 1.9741
Epoch 45/150
25/25 [==============================] - 4s 141ms/step - loss: 1.5316 - mae: 1.9730
Epoch 46/150
25/25 [==============================] - 3s 133ms/step - loss: 1.5305 - mae: 1.9719
Epoch 47/150
25/25 [==============================] - 3s 135ms/step - loss: 1.5295 - mae: 1.9708
Epoch 48/150
25/25 [==============================] - 3s 138ms/step - loss: 1.5286 - mae: 1.9698
Epoch 49/150
25/25 [==============================] - 3s 136ms/step - loss: 1.5276 - mae: 1.9689
Epoch 50/150
25/25 [==============================] - 3s 136ms/step - loss: 1.5267 - mae: 1.9680
Epoch 51/150
25/25 [==============================] - 3s 139ms/step - loss: 1.5259 - mae: 1.9672
Epoch 52/150
25/25 [==============================] - 3s 134ms/step - loss: 1.5251 - mae: 1.9664
Epoch 53/150
25/25 [==============================] - 3s 135ms/step - loss: 1.5243 - mae: 1.9656
Epoch 54/150
25/25 [==============================] - 3s 137ms/step - loss: 1.5235 - mae: 1.9648
Epoch 55/150
25/25 [==============================] - 3s 137ms/step - loss: 1.5228 - mae: 1.9640
Epoch 56/150
25/25 [==============================] - 3s 136ms/step - loss: 1.5221 - mae: 1.9633
Epoch 57/150
25/25 [==============================] - 3s 136ms/step - loss: 1.5213 - mae: 1.9626
Epoch 58/150
25/25 [==============================] - 3s 137ms/step - loss: 1.5206 - mae: 1.9619
Epoch 59/150
25/25 [==============================] - 3s 135ms/step - loss: 1.5199 - mae: 1.9611
Epoch 60/150
25/25 [==============================] - 3s 133ms/step - loss: 1.5193 - mae: 1.9604
Epoch 61/150
25/25 [==============================] - 3s 133ms/step - loss: 1.5186 - mae: 1.9597
Epoch 62/150
25/25 [==============================] - 3s 131ms/step - loss: 1.5179 - mae: 1.9589
Epoch 63/150
25/25 [==============================] - 3s 131ms/step - loss: 1.5173 - mae: 1.9582
Epoch 64/150
25/25 [==============================] - 3s 135ms/step - loss: 1.5166 - mae: 1.9576
Epoch 65/150
25/25 [==============================] - 3s 133ms/step - loss: 1.5161 - mae: 1.9570
Epoch 66/150
25/25 [==============================] - 3s 138ms/step - loss: 1.5155 - mae: 1.9564
Epoch 67/150
25/25 [==============================] - 3s 140ms/step - loss: 1.5149 - mae: 1.9557
Epoch 68/150
25/25 [==============================] - 4s 141ms/step - loss: 1.5142 - mae: 1.9550
Epoch 69/150
25/25 [==============================] - 3s 133ms/step - loss: 1.5136 - mae: 1.9543
Epoch 70/150
25/25 [==============================] - 3s 130ms/step - loss: 1.5129 - mae: 1.9536
Epoch 71/150
25/25 [==============================] - 3s 132ms/step - loss: 1.5122 - mae: 1.9528
Epoch 72/150
25/25 [==============================] - 3s 132ms/step - loss: 1.5115 - mae: 1.9521
Epoch 73/150
25/25 [==============================] - 3s 133ms/step - loss: 1.5108 - mae: 1.9514
Epoch 74/150
25/25 [==============================] - 3s 135ms/step - loss: 1.5102 - mae: 1.9508
Epoch 75/150
25/25 [==============================] - 3s 133ms/step - loss: 1.5097 - mae: 1.9503
Epoch 76/150
25/25 [==============================] - 3s 134ms/step - loss: 1.5091 - mae: 1.9497
Epoch 77/150
25/25 [==============================] - 3s 137ms/step - loss: 1.5084 - mae: 1.9491
Epoch 78/150
25/25 [==============================] - 3s 128ms/step - loss: 1.5078 - mae: 1.9485
Epoch 79/150
25/25 [==============================] - 3s 129ms/step - loss: 1.5072 - mae: 1.9478
Epoch 80/150
25/25 [==============================] - 3s 134ms/step - loss: 1.5065 - mae: 1.9471
Epoch 81/150
25/25 [==============================] - 3s 136ms/step - loss: 1.5059 - mae: 1.9465
Epoch 82/150
25/25 [==============================] - 3s 134ms/step - loss: 1.5053 - mae: 1.9459
Epoch 83/150
25/25 [==============================] - 3s 132ms/step - loss: 1.5048 - mae: 1.9454
Epoch 84/150
25/25 [==============================] - 3s 134ms/step - loss: 1.5043 - mae: 1.9448
Epoch 85/150
25/25 [==============================] - 3s 132ms/step - loss: 1.5038 - mae: 1.9443
Epoch 86/150
25/25 [==============================] - 3s 131ms/step - loss: 1.5033 - mae: 1.9438
Epoch 87/150
25/25 [==============================] - 3s 132ms/step - loss: 1.5028 - mae: 1.9433
Epoch 88/150
25/25 [==============================] - 3s 130ms/step - loss: 1.5023 - mae: 1.9428
Epoch 89/150
25/25 [==============================] - 3s 134ms/step - loss: 1.5017 - mae: 1.9422
Epoch 90/150
25/25 [==============================] - 3s 132ms/step - loss: 1.5012 - mae: 1.9416
Epoch 91/150
25/25 [==============================] - 3s 131ms/step - loss: 1.5004 - mae: 1.9408
Epoch 92/150
25/25 [==============================] - 3s 132ms/step - loss: 1.4992 - mae: 1.9396
Epoch 93/150
25/25 [==============================] - 3s 132ms/step - loss: 1.4982 - mae: 1.9386
Epoch 94/150
25/25 [==============================] - 3s 136ms/step - loss: 1.4975 - mae: 1.9378
Epoch 95/150
25/25 [==============================] - 3s 134ms/step - loss: 1.4968 - mae: 1.9371
Epoch 96/150
25/25 [==============================] - 3s 136ms/step - loss: 1.4962 - mae: 1.9364
Epoch 97/150
25/25 [==============================] - 3s 137ms/step - loss: 1.4955 - mae: 1.9358
Epoch 98/150
25/25 [==============================] - 3s 140ms/step - loss: 1.4949 - mae: 1.9351
Epoch 99/150
25/25 [==============================] - 3s 134ms/step - loss: 1.4942 - mae: 1.9344
Epoch 100/150
25/25 [==============================] - 3s 134ms/step - loss: 1.4934 - mae: 1.9336
Epoch 101/150
25/25 [==============================] - 3s 135ms/step - loss: 1.4927 - mae: 1.9328
Epoch 102/150
25/25 [==============================] - 3s 132ms/step - loss: 1.4919 - mae: 1.9319
Epoch 103/150
25/25 [==============================] - 3s 131ms/step - loss: 1.4913 - mae: 1.9313
Epoch 104/150
25/25 [==============================] - 3s 132ms/step - loss: 1.4908 - mae: 1.9307
Epoch 105/150
25/25 [==============================] - 3s 133ms/step - loss: 1.4903 - mae: 1.9302
Epoch 106/150
25/25 [==============================] - 3s 131ms/step - loss: 1.4899 - mae: 1.9298
Epoch 107/150
25/25 [==============================] - 3s 130ms/step - loss: 1.4895 - mae: 1.9293
Epoch 108/150
25/25 [==============================] - 3s 130ms/step - loss: 1.4892 - mae: 1.9289
Epoch 109/150
25/25 [==============================] - 3s 132ms/step - loss: 1.4888 - mae: 1.9285
Epoch 110/150
25/25 [==============================] - 3s 131ms/step - loss: 1.4884 - mae: 1.9282
Epoch 111/150
25/25 [==============================] - 3s 133ms/step - loss: 1.4881 - mae: 1.9278
Epoch 112/150
25/25 [==============================] - 3s 130ms/step - loss: 1.4878 - mae: 1.9275
Epoch 113/150
25/25 [==============================] - 3s 131ms/step - loss: 1.4874 - mae: 1.9271
Epoch 114/150
25/25 [==============================] - 3s 136ms/step - loss: 1.4871 - mae: 1.9268
Epoch 115/150
25/25 [==============================] - 3s 130ms/step - loss: 1.4868 - mae: 1.9265
Epoch 116/150
25/25 [==============================] - 3s 132ms/step - loss: 1.4865 - mae: 1.9262
Epoch 117/150
25/25 [==============================] - 3s 134ms/step - loss: 1.4862 - mae: 1.9258
Epoch 118/150
25/25 [==============================] - 3s 132ms/step - loss: 1.4859 - mae: 1.9255
Epoch 119/150
25/25 [==============================] - 3s 130ms/step - loss: 1.4856 - mae: 1.9252
Epoch 120/150
25/25 [==============================] - 3s 134ms/step - loss: 1.4853 - mae: 1.9249
Epoch 121/150
25/25 [==============================] - 3s 134ms/step - loss: 1.4851 - mae: 1.9247
Epoch 122/150
25/25 [==============================] - 3s 135ms/step - loss: 1.4848 - mae: 1.9243
Epoch 123/150
25/25 [==============================] - 3s 131ms/step - loss: 1.4845 - mae: 1.9240
Epoch 124/150
25/25 [==============================] - 3s 134ms/step - loss: 1.4842 - mae: 1.9238
Epoch 125/150
25/25 [==============================] - 3s 133ms/step - loss: 1.4840 - mae: 1.9235
Epoch 126/150
25/25 [==============================] - 3s 131ms/step - loss: 1.4838 - mae: 1.9232
Epoch 127/150
25/25 [==============================] - 3s 129ms/step - loss: 1.4835 - mae: 1.9230
Epoch 128/150
25/25 [==============================] - 3s 132ms/step - loss: 1.4833 - mae: 1.9228
Epoch 129/150
25/25 [==============================] - 3s 131ms/step - loss: 1.4831 - mae: 1.9225
Epoch 130/150
25/25 [==============================] - 3s 129ms/step - loss: 1.4828 - mae: 1.9222
Epoch 131/150
25/25 [==============================] - 3s 128ms/step - loss: 1.4826 - mae: 1.9220
Epoch 132/150
25/25 [==============================] - 3s 127ms/step - loss: 1.4823 - mae: 1.9217
Epoch 133/150
25/25 [==============================] - 3s 129ms/step - loss: 1.4821 - mae: 1.9214
Epoch 134/150
25/25 [==============================] - 3s 129ms/step - loss: 1.4818 - mae: 1.9212
Epoch 135/150
25/25 [==============================] - 3s 132ms/step - loss: 1.4815 - mae: 1.9209
Epoch 136/150
25/25 [==============================] - 3s 131ms/step - loss: 1.4813 - mae: 1.9206
Epoch 137/150
25/25 [==============================] - 3s 127ms/step - loss: 1.4811 - mae: 1.9204
Epoch 138/150
25/25 [==============================] - 3s 131ms/step - loss: 1.4808 - mae: 1.9201
Epoch 139/150
25/25 [==============================] - 3s 130ms/step - loss: 1.4806 - mae: 1.9199
Epoch 140/150
25/25 [==============================] - 3s 130ms/step - loss: 1.4804 - mae: 1.9197
Epoch 141/150
25/25 [==============================] - 3s 132ms/step - loss: 1.4802 - mae: 1.9194
Epoch 142/150
25/25 [==============================] - 3s 129ms/step - loss: 1.4799 - mae: 1.9192
Epoch 143/150
25/25 [==============================] - 3s 134ms/step - loss: 1.4797 - mae: 1.9189
Epoch 144/150
25/25 [==============================] - 3s 135ms/step - loss: 1.4795 - mae: 1.9187
Epoch 145/150
25/25 [==============================] - 3s 131ms/step - loss: 1.4794 - mae: 1.9185
Epoch 146/150
25/25 [==============================] - 3s 131ms/step - loss: 1.4791 - mae: 1.9183
Epoch 147/150
25/25 [==============================] - 3s 130ms/step - loss: 1.4789 - mae: 1.9180
Epoch 148/150
25/25 [==============================] - 3s 136ms/step - loss: 1.4787 - mae: 1.9178
Epoch 149/150
25/25 [==============================] - 3s 137ms/step - loss: 1.4784 - mae: 1.9175
Epoch 150/150
25/25 [==============================] - 4s 143ms/step - loss: 1.4782 - mae: 1.9173
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rnn_forecast&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model_forecast&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;newaxis&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;window_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;rnn_forecast&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rnn_forecast&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;split_time&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;window_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figure&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figsize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plot_series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time_valid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x_valid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plot_series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time_valid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rnn_forecast&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# EXPECTED OUTPUT. PLOT SHOULD SHOW PROJECTIONS FOLLOWING ORIGINAL DATA CLOSELY&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;metrics&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean_absolute_error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x_valid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rnn_forecast&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;numpy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# EXPECTED OUTPUT MAE &amp;lt; 2 -- I GOT 1.789626&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;1.780626&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rnn_forecast&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# EXPECTED OUTPUT -- ARRAY OF VALUES IN THE LOW TEENS&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;[11.636601 10.97607  12.159701 ... 13.589686 13.726407 14.940471]
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;/div&gt;</content><author><name></name></author><summary type="html"></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://rafaelsf80.github.io/notebooks/images/kaggle.png" /><media:content medium="image" url="https://rafaelsf80.github.io/notebooks/images/kaggle.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Redes convolucionales Humans-Horses</title><link href="https://rafaelsf80.github.io/notebooks/tensorflow/2020/08/02/humans-horses-transfer-learning.html" rel="alternate" type="text/html" title="Redes convolucionales Humans-Horses" /><published>2020-08-02T00:00:00-05:00</published><updated>2020-08-02T00:00:00-05:00</updated><id>https://rafaelsf80.github.io/notebooks/tensorflow/2020/08/02/humans-horses-transfer-learning</id><content type="html" xml:base="https://rafaelsf80.github.io/notebooks/tensorflow/2020/08/02/humans-horses-transfer-learning.html">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-08-02-humans-horses-transfer-learning.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Introducción&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;os&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tensorflow&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tf&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tensorflow.keras&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tensorflow.keras&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Model&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;os&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;getcwd&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path_inception&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;sa&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getcwd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;/../tmp2/inception_v3_weights_tf_dim_ordering_tf_kernels_notop.h5&amp;quot;&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Import the inception model  &lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tensorflow.keras.applications.inception_v3&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;InceptionV3&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Create an instance of the inception model from the local pre-trained weights&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;local_weights_file&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;path_inception&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;pre_trained_model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;InceptionV3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input_shape&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;150&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;150&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; 
                                &lt;span class=&quot;n&quot;&gt;include_top&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                                &lt;span class=&quot;n&quot;&gt;weights&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;pre_trained_model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;load_weights&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;local_weights_file&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Make all the layers in the pre-trained model non-trainable&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;layer&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pre_trained_model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;layer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;trainable&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;
  
&lt;span class=&quot;c1&quot;&gt;# Print the model summary&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;pre_trained_model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;summary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Expected Output is extremely large, but should end with:&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;#batch_normalization_v1_281 (Bat (None, 3, 3, 192)    576         conv2d_281[0][0]                 &lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#__________________________________________________________________________________________________&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#activation_273 (Activation)     (None, 3, 3, 320)    0           batch_normalization_v1_273[0][0] &lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#__________________________________________________________________________________________________&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#mixed9_1 (Concatenate)          (None, 3, 3, 768)    0           activation_275[0][0]             &lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#                                                                 activation_276[0][0]             &lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#__________________________________________________________________________________________________&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#concatenate_5 (Concatenate)     (None, 3, 3, 768)    0           activation_279[0][0]             &lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#                                                                 activation_280[0][0]             &lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#__________________________________________________________________________________________________&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#activation_281 (Activation)     (None, 3, 3, 192)    0           batch_normalization_v1_281[0][0] &lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#__________________________________________________________________________________________________&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#mixed10 (Concatenate)           (None, 3, 3, 2048)   0           activation_273[0][0]             &lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#                                                                 mixed9_1[0][0]                   &lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#                                                                 concatenate_5[0][0]              &lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#                                                                 activation_281[0][0]             &lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#==================================================================================================&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#Total params: 21,802,784&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#Trainable params: 0&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#Non-trainable params: 21,802,784&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Model: &amp;#34;inception_v3&amp;#34;
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 150, 150, 3) 0                                            
__________________________________________________________________________________________________
conv2d (Conv2D)                 (None, 74, 74, 32)   864         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization (BatchNorma (None, 74, 74, 32)   96          conv2d[0][0]                     
__________________________________________________________________________________________________
activation (Activation)         (None, 74, 74, 32)   0           batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 72, 72, 32)   9216        activation[0][0]                 
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 72, 72, 32)   96          conv2d_1[0][0]                   
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 72, 72, 32)   0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 72, 72, 64)   18432       activation_1[0][0]               
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 72, 72, 64)   192         conv2d_2[0][0]                   
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 72, 72, 64)   0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)    (None, 35, 35, 64)   0           activation_2[0][0]               
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 35, 35, 80)   5120        max_pooling2d[0][0]              
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 35, 35, 80)   240         conv2d_3[0][0]                   
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 35, 35, 80)   0           batch_normalization_3[0][0]      
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 33, 33, 192)  138240      activation_3[0][0]               
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 33, 33, 192)  576         conv2d_4[0][0]                   
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 33, 33, 192)  0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 16, 192)  0           activation_4[0][0]               
__________________________________________________________________________________________________
conv2d_8 (Conv2D)               (None, 16, 16, 64)   12288       max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
batch_normalization_8 (BatchNor (None, 16, 16, 64)   192         conv2d_8[0][0]                   
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 16, 16, 64)   0           batch_normalization_8[0][0]      
__________________________________________________________________________________________________
conv2d_6 (Conv2D)               (None, 16, 16, 48)   9216        max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
conv2d_9 (Conv2D)               (None, 16, 16, 96)   55296       activation_8[0][0]               
__________________________________________________________________________________________________
batch_normalization_6 (BatchNor (None, 16, 16, 48)   144         conv2d_6[0][0]                   
__________________________________________________________________________________________________
batch_normalization_9 (BatchNor (None, 16, 16, 96)   288         conv2d_9[0][0]                   
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 16, 16, 48)   0           batch_normalization_6[0][0]      
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 16, 16, 96)   0           batch_normalization_9[0][0]      
__________________________________________________________________________________________________
average_pooling2d (AveragePooli (None, 16, 16, 192)  0           max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 16, 16, 64)   12288       max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
conv2d_7 (Conv2D)               (None, 16, 16, 64)   76800       activation_6[0][0]               
__________________________________________________________________________________________________
conv2d_10 (Conv2D)              (None, 16, 16, 96)   82944       activation_9[0][0]               
__________________________________________________________________________________________________
conv2d_11 (Conv2D)              (None, 16, 16, 32)   6144        average_pooling2d[0][0]          
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 16, 16, 64)   192         conv2d_5[0][0]                   
__________________________________________________________________________________________________
batch_normalization_7 (BatchNor (None, 16, 16, 64)   192         conv2d_7[0][0]                   
__________________________________________________________________________________________________
batch_normalization_10 (BatchNo (None, 16, 16, 96)   288         conv2d_10[0][0]                  
__________________________________________________________________________________________________
batch_normalization_11 (BatchNo (None, 16, 16, 32)   96          conv2d_11[0][0]                  
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 16, 16, 64)   0           batch_normalization_5[0][0]      
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 16, 16, 64)   0           batch_normalization_7[0][0]      
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 16, 16, 96)   0           batch_normalization_10[0][0]     
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 16, 16, 32)   0           batch_normalization_11[0][0]     
__________________________________________________________________________________________________
mixed0 (Concatenate)            (None, 16, 16, 256)  0           activation_5[0][0]               
                                                                 activation_7[0][0]               
                                                                 activation_10[0][0]              
                                                                 activation_11[0][0]              
__________________________________________________________________________________________________
conv2d_15 (Conv2D)              (None, 16, 16, 64)   16384       mixed0[0][0]                     
__________________________________________________________________________________________________
batch_normalization_15 (BatchNo (None, 16, 16, 64)   192         conv2d_15[0][0]                  
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 16, 16, 64)   0           batch_normalization_15[0][0]     
__________________________________________________________________________________________________
conv2d_13 (Conv2D)              (None, 16, 16, 48)   12288       mixed0[0][0]                     
__________________________________________________________________________________________________
conv2d_16 (Conv2D)              (None, 16, 16, 96)   55296       activation_15[0][0]              
__________________________________________________________________________________________________
batch_normalization_13 (BatchNo (None, 16, 16, 48)   144         conv2d_13[0][0]                  
__________________________________________________________________________________________________
batch_normalization_16 (BatchNo (None, 16, 16, 96)   288         conv2d_16[0][0]                  
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 16, 16, 48)   0           batch_normalization_13[0][0]     
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 16, 16, 96)   0           batch_normalization_16[0][0]     
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 16, 16, 256)  0           mixed0[0][0]                     
__________________________________________________________________________________________________
conv2d_12 (Conv2D)              (None, 16, 16, 64)   16384       mixed0[0][0]                     
__________________________________________________________________________________________________
conv2d_14 (Conv2D)              (None, 16, 16, 64)   76800       activation_13[0][0]              
__________________________________________________________________________________________________
conv2d_17 (Conv2D)              (None, 16, 16, 96)   82944       activation_16[0][0]              
__________________________________________________________________________________________________
conv2d_18 (Conv2D)              (None, 16, 16, 64)   16384       average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
batch_normalization_12 (BatchNo (None, 16, 16, 64)   192         conv2d_12[0][0]                  
__________________________________________________________________________________________________
batch_normalization_14 (BatchNo (None, 16, 16, 64)   192         conv2d_14[0][0]                  
__________________________________________________________________________________________________
batch_normalization_17 (BatchNo (None, 16, 16, 96)   288         conv2d_17[0][0]                  
__________________________________________________________________________________________________
batch_normalization_18 (BatchNo (None, 16, 16, 64)   192         conv2d_18[0][0]                  
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 16, 16, 64)   0           batch_normalization_12[0][0]     
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 16, 16, 64)   0           batch_normalization_14[0][0]     
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 16, 16, 96)   0           batch_normalization_17[0][0]     
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 16, 16, 64)   0           batch_normalization_18[0][0]     
__________________________________________________________________________________________________
mixed1 (Concatenate)            (None, 16, 16, 288)  0           activation_12[0][0]              
                                                                 activation_14[0][0]              
                                                                 activation_17[0][0]              
                                                                 activation_18[0][0]              
__________________________________________________________________________________________________
conv2d_22 (Conv2D)              (None, 16, 16, 64)   18432       mixed1[0][0]                     
__________________________________________________________________________________________________
batch_normalization_22 (BatchNo (None, 16, 16, 64)   192         conv2d_22[0][0]                  
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 16, 16, 64)   0           batch_normalization_22[0][0]     
__________________________________________________________________________________________________
conv2d_20 (Conv2D)              (None, 16, 16, 48)   13824       mixed1[0][0]                     
__________________________________________________________________________________________________
conv2d_23 (Conv2D)              (None, 16, 16, 96)   55296       activation_22[0][0]              
__________________________________________________________________________________________________
batch_normalization_20 (BatchNo (None, 16, 16, 48)   144         conv2d_20[0][0]                  
__________________________________________________________________________________________________
batch_normalization_23 (BatchNo (None, 16, 16, 96)   288         conv2d_23[0][0]                  
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 16, 16, 48)   0           batch_normalization_20[0][0]     
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 16, 16, 96)   0           batch_normalization_23[0][0]     
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 16, 16, 288)  0           mixed1[0][0]                     
__________________________________________________________________________________________________
conv2d_19 (Conv2D)              (None, 16, 16, 64)   18432       mixed1[0][0]                     
__________________________________________________________________________________________________
conv2d_21 (Conv2D)              (None, 16, 16, 64)   76800       activation_20[0][0]              
__________________________________________________________________________________________________
conv2d_24 (Conv2D)              (None, 16, 16, 96)   82944       activation_23[0][0]              
__________________________________________________________________________________________________
conv2d_25 (Conv2D)              (None, 16, 16, 64)   18432       average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
batch_normalization_19 (BatchNo (None, 16, 16, 64)   192         conv2d_19[0][0]                  
__________________________________________________________________________________________________
batch_normalization_21 (BatchNo (None, 16, 16, 64)   192         conv2d_21[0][0]                  
__________________________________________________________________________________________________
batch_normalization_24 (BatchNo (None, 16, 16, 96)   288         conv2d_24[0][0]                  
__________________________________________________________________________________________________
batch_normalization_25 (BatchNo (None, 16, 16, 64)   192         conv2d_25[0][0]                  
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 16, 16, 64)   0           batch_normalization_19[0][0]     
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 16, 16, 64)   0           batch_normalization_21[0][0]     
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 16, 16, 96)   0           batch_normalization_24[0][0]     
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 16, 16, 64)   0           batch_normalization_25[0][0]     
__________________________________________________________________________________________________
mixed2 (Concatenate)            (None, 16, 16, 288)  0           activation_19[0][0]              
                                                                 activation_21[0][0]              
                                                                 activation_24[0][0]              
                                                                 activation_25[0][0]              
__________________________________________________________________________________________________
conv2d_27 (Conv2D)              (None, 16, 16, 64)   18432       mixed2[0][0]                     
__________________________________________________________________________________________________
batch_normalization_27 (BatchNo (None, 16, 16, 64)   192         conv2d_27[0][0]                  
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 16, 16, 64)   0           batch_normalization_27[0][0]     
__________________________________________________________________________________________________
conv2d_28 (Conv2D)              (None, 16, 16, 96)   55296       activation_27[0][0]              
__________________________________________________________________________________________________
batch_normalization_28 (BatchNo (None, 16, 16, 96)   288         conv2d_28[0][0]                  
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 16, 16, 96)   0           batch_normalization_28[0][0]     
__________________________________________________________________________________________________
conv2d_26 (Conv2D)              (None, 7, 7, 384)    995328      mixed2[0][0]                     
__________________________________________________________________________________________________
conv2d_29 (Conv2D)              (None, 7, 7, 96)     82944       activation_28[0][0]              
__________________________________________________________________________________________________
batch_normalization_26 (BatchNo (None, 7, 7, 384)    1152        conv2d_26[0][0]                  
__________________________________________________________________________________________________
batch_normalization_29 (BatchNo (None, 7, 7, 96)     288         conv2d_29[0][0]                  
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 7, 7, 384)    0           batch_normalization_26[0][0]     
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 7, 7, 96)     0           batch_normalization_29[0][0]     
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 7, 7, 288)    0           mixed2[0][0]                     
__________________________________________________________________________________________________
mixed3 (Concatenate)            (None, 7, 7, 768)    0           activation_26[0][0]              
                                                                 activation_29[0][0]              
                                                                 max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
conv2d_34 (Conv2D)              (None, 7, 7, 128)    98304       mixed3[0][0]                     
__________________________________________________________________________________________________
batch_normalization_34 (BatchNo (None, 7, 7, 128)    384         conv2d_34[0][0]                  
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 7, 7, 128)    0           batch_normalization_34[0][0]     
__________________________________________________________________________________________________
conv2d_35 (Conv2D)              (None, 7, 7, 128)    114688      activation_34[0][0]              
__________________________________________________________________________________________________
batch_normalization_35 (BatchNo (None, 7, 7, 128)    384         conv2d_35[0][0]                  
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 7, 7, 128)    0           batch_normalization_35[0][0]     
__________________________________________________________________________________________________
conv2d_31 (Conv2D)              (None, 7, 7, 128)    98304       mixed3[0][0]                     
__________________________________________________________________________________________________
conv2d_36 (Conv2D)              (None, 7, 7, 128)    114688      activation_35[0][0]              
__________________________________________________________________________________________________
batch_normalization_31 (BatchNo (None, 7, 7, 128)    384         conv2d_31[0][0]                  
__________________________________________________________________________________________________
batch_normalization_36 (BatchNo (None, 7, 7, 128)    384         conv2d_36[0][0]                  
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 7, 7, 128)    0           batch_normalization_31[0][0]     
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 7, 7, 128)    0           batch_normalization_36[0][0]     
__________________________________________________________________________________________________
conv2d_32 (Conv2D)              (None, 7, 7, 128)    114688      activation_31[0][0]              
__________________________________________________________________________________________________
conv2d_37 (Conv2D)              (None, 7, 7, 128)    114688      activation_36[0][0]              
__________________________________________________________________________________________________
batch_normalization_32 (BatchNo (None, 7, 7, 128)    384         conv2d_32[0][0]                  
__________________________________________________________________________________________________
batch_normalization_37 (BatchNo (None, 7, 7, 128)    384         conv2d_37[0][0]                  
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 7, 7, 128)    0           batch_normalization_32[0][0]     
__________________________________________________________________________________________________
activation_37 (Activation)      (None, 7, 7, 128)    0           batch_normalization_37[0][0]     
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 7, 7, 768)    0           mixed3[0][0]                     
__________________________________________________________________________________________________
conv2d_30 (Conv2D)              (None, 7, 7, 192)    147456      mixed3[0][0]                     
__________________________________________________________________________________________________
conv2d_33 (Conv2D)              (None, 7, 7, 192)    172032      activation_32[0][0]              
__________________________________________________________________________________________________
conv2d_38 (Conv2D)              (None, 7, 7, 192)    172032      activation_37[0][0]              
__________________________________________________________________________________________________
conv2d_39 (Conv2D)              (None, 7, 7, 192)    147456      average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
batch_normalization_30 (BatchNo (None, 7, 7, 192)    576         conv2d_30[0][0]                  
__________________________________________________________________________________________________
batch_normalization_33 (BatchNo (None, 7, 7, 192)    576         conv2d_33[0][0]                  
__________________________________________________________________________________________________
batch_normalization_38 (BatchNo (None, 7, 7, 192)    576         conv2d_38[0][0]                  
__________________________________________________________________________________________________
batch_normalization_39 (BatchNo (None, 7, 7, 192)    576         conv2d_39[0][0]                  
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 7, 7, 192)    0           batch_normalization_30[0][0]     
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 7, 7, 192)    0           batch_normalization_33[0][0]     
__________________________________________________________________________________________________
activation_38 (Activation)      (None, 7, 7, 192)    0           batch_normalization_38[0][0]     
__________________________________________________________________________________________________
activation_39 (Activation)      (None, 7, 7, 192)    0           batch_normalization_39[0][0]     
__________________________________________________________________________________________________
mixed4 (Concatenate)            (None, 7, 7, 768)    0           activation_30[0][0]              
                                                                 activation_33[0][0]              
                                                                 activation_38[0][0]              
                                                                 activation_39[0][0]              
__________________________________________________________________________________________________
conv2d_44 (Conv2D)              (None, 7, 7, 160)    122880      mixed4[0][0]                     
__________________________________________________________________________________________________
batch_normalization_44 (BatchNo (None, 7, 7, 160)    480         conv2d_44[0][0]                  
__________________________________________________________________________________________________
activation_44 (Activation)      (None, 7, 7, 160)    0           batch_normalization_44[0][0]     
__________________________________________________________________________________________________
conv2d_45 (Conv2D)              (None, 7, 7, 160)    179200      activation_44[0][0]              
__________________________________________________________________________________________________
batch_normalization_45 (BatchNo (None, 7, 7, 160)    480         conv2d_45[0][0]                  
__________________________________________________________________________________________________
activation_45 (Activation)      (None, 7, 7, 160)    0           batch_normalization_45[0][0]     
__________________________________________________________________________________________________
conv2d_41 (Conv2D)              (None, 7, 7, 160)    122880      mixed4[0][0]                     
__________________________________________________________________________________________________
conv2d_46 (Conv2D)              (None, 7, 7, 160)    179200      activation_45[0][0]              
__________________________________________________________________________________________________
batch_normalization_41 (BatchNo (None, 7, 7, 160)    480         conv2d_41[0][0]                  
__________________________________________________________________________________________________
batch_normalization_46 (BatchNo (None, 7, 7, 160)    480         conv2d_46[0][0]                  
__________________________________________________________________________________________________
activation_41 (Activation)      (None, 7, 7, 160)    0           batch_normalization_41[0][0]     
__________________________________________________________________________________________________
activation_46 (Activation)      (None, 7, 7, 160)    0           batch_normalization_46[0][0]     
__________________________________________________________________________________________________
conv2d_42 (Conv2D)              (None, 7, 7, 160)    179200      activation_41[0][0]              
__________________________________________________________________________________________________
conv2d_47 (Conv2D)              (None, 7, 7, 160)    179200      activation_46[0][0]              
__________________________________________________________________________________________________
batch_normalization_42 (BatchNo (None, 7, 7, 160)    480         conv2d_42[0][0]                  
__________________________________________________________________________________________________
batch_normalization_47 (BatchNo (None, 7, 7, 160)    480         conv2d_47[0][0]                  
__________________________________________________________________________________________________
activation_42 (Activation)      (None, 7, 7, 160)    0           batch_normalization_42[0][0]     
__________________________________________________________________________________________________
activation_47 (Activation)      (None, 7, 7, 160)    0           batch_normalization_47[0][0]     
__________________________________________________________________________________________________
average_pooling2d_4 (AveragePoo (None, 7, 7, 768)    0           mixed4[0][0]                     
__________________________________________________________________________________________________
conv2d_40 (Conv2D)              (None, 7, 7, 192)    147456      mixed4[0][0]                     
__________________________________________________________________________________________________
conv2d_43 (Conv2D)              (None, 7, 7, 192)    215040      activation_42[0][0]              
__________________________________________________________________________________________________
conv2d_48 (Conv2D)              (None, 7, 7, 192)    215040      activation_47[0][0]              
__________________________________________________________________________________________________
conv2d_49 (Conv2D)              (None, 7, 7, 192)    147456      average_pooling2d_4[0][0]        
__________________________________________________________________________________________________
batch_normalization_40 (BatchNo (None, 7, 7, 192)    576         conv2d_40[0][0]                  
__________________________________________________________________________________________________
batch_normalization_43 (BatchNo (None, 7, 7, 192)    576         conv2d_43[0][0]                  
__________________________________________________________________________________________________
batch_normalization_48 (BatchNo (None, 7, 7, 192)    576         conv2d_48[0][0]                  
__________________________________________________________________________________________________
batch_normalization_49 (BatchNo (None, 7, 7, 192)    576         conv2d_49[0][0]                  
__________________________________________________________________________________________________
activation_40 (Activation)      (None, 7, 7, 192)    0           batch_normalization_40[0][0]     
__________________________________________________________________________________________________
activation_43 (Activation)      (None, 7, 7, 192)    0           batch_normalization_43[0][0]     
__________________________________________________________________________________________________
activation_48 (Activation)      (None, 7, 7, 192)    0           batch_normalization_48[0][0]     
__________________________________________________________________________________________________
activation_49 (Activation)      (None, 7, 7, 192)    0           batch_normalization_49[0][0]     
__________________________________________________________________________________________________
mixed5 (Concatenate)            (None, 7, 7, 768)    0           activation_40[0][0]              
                                                                 activation_43[0][0]              
                                                                 activation_48[0][0]              
                                                                 activation_49[0][0]              
__________________________________________________________________________________________________
conv2d_54 (Conv2D)              (None, 7, 7, 160)    122880      mixed5[0][0]                     
__________________________________________________________________________________________________
batch_normalization_54 (BatchNo (None, 7, 7, 160)    480         conv2d_54[0][0]                  
__________________________________________________________________________________________________
activation_54 (Activation)      (None, 7, 7, 160)    0           batch_normalization_54[0][0]     
__________________________________________________________________________________________________
conv2d_55 (Conv2D)              (None, 7, 7, 160)    179200      activation_54[0][0]              
__________________________________________________________________________________________________
batch_normalization_55 (BatchNo (None, 7, 7, 160)    480         conv2d_55[0][0]                  
__________________________________________________________________________________________________
activation_55 (Activation)      (None, 7, 7, 160)    0           batch_normalization_55[0][0]     
__________________________________________________________________________________________________
conv2d_51 (Conv2D)              (None, 7, 7, 160)    122880      mixed5[0][0]                     
__________________________________________________________________________________________________
conv2d_56 (Conv2D)              (None, 7, 7, 160)    179200      activation_55[0][0]              
__________________________________________________________________________________________________
batch_normalization_51 (BatchNo (None, 7, 7, 160)    480         conv2d_51[0][0]                  
__________________________________________________________________________________________________
batch_normalization_56 (BatchNo (None, 7, 7, 160)    480         conv2d_56[0][0]                  
__________________________________________________________________________________________________
activation_51 (Activation)      (None, 7, 7, 160)    0           batch_normalization_51[0][0]     
__________________________________________________________________________________________________
activation_56 (Activation)      (None, 7, 7, 160)    0           batch_normalization_56[0][0]     
__________________________________________________________________________________________________
conv2d_52 (Conv2D)              (None, 7, 7, 160)    179200      activation_51[0][0]              
__________________________________________________________________________________________________
conv2d_57 (Conv2D)              (None, 7, 7, 160)    179200      activation_56[0][0]              
__________________________________________________________________________________________________
batch_normalization_52 (BatchNo (None, 7, 7, 160)    480         conv2d_52[0][0]                  
__________________________________________________________________________________________________
batch_normalization_57 (BatchNo (None, 7, 7, 160)    480         conv2d_57[0][0]                  
__________________________________________________________________________________________________
activation_52 (Activation)      (None, 7, 7, 160)    0           batch_normalization_52[0][0]     
__________________________________________________________________________________________________
activation_57 (Activation)      (None, 7, 7, 160)    0           batch_normalization_57[0][0]     
__________________________________________________________________________________________________
average_pooling2d_5 (AveragePoo (None, 7, 7, 768)    0           mixed5[0][0]                     
__________________________________________________________________________________________________
conv2d_50 (Conv2D)              (None, 7, 7, 192)    147456      mixed5[0][0]                     
__________________________________________________________________________________________________
conv2d_53 (Conv2D)              (None, 7, 7, 192)    215040      activation_52[0][0]              
__________________________________________________________________________________________________
conv2d_58 (Conv2D)              (None, 7, 7, 192)    215040      activation_57[0][0]              
__________________________________________________________________________________________________
conv2d_59 (Conv2D)              (None, 7, 7, 192)    147456      average_pooling2d_5[0][0]        
__________________________________________________________________________________________________
batch_normalization_50 (BatchNo (None, 7, 7, 192)    576         conv2d_50[0][0]                  
__________________________________________________________________________________________________
batch_normalization_53 (BatchNo (None, 7, 7, 192)    576         conv2d_53[0][0]                  
__________________________________________________________________________________________________
batch_normalization_58 (BatchNo (None, 7, 7, 192)    576         conv2d_58[0][0]                  
__________________________________________________________________________________________________
batch_normalization_59 (BatchNo (None, 7, 7, 192)    576         conv2d_59[0][0]                  
__________________________________________________________________________________________________
activation_50 (Activation)      (None, 7, 7, 192)    0           batch_normalization_50[0][0]     
__________________________________________________________________________________________________
activation_53 (Activation)      (None, 7, 7, 192)    0           batch_normalization_53[0][0]     
__________________________________________________________________________________________________
activation_58 (Activation)      (None, 7, 7, 192)    0           batch_normalization_58[0][0]     
__________________________________________________________________________________________________
activation_59 (Activation)      (None, 7, 7, 192)    0           batch_normalization_59[0][0]     
__________________________________________________________________________________________________
mixed6 (Concatenate)            (None, 7, 7, 768)    0           activation_50[0][0]              
                                                                 activation_53[0][0]              
                                                                 activation_58[0][0]              
                                                                 activation_59[0][0]              
__________________________________________________________________________________________________
conv2d_64 (Conv2D)              (None, 7, 7, 192)    147456      mixed6[0][0]                     
__________________________________________________________________________________________________
batch_normalization_64 (BatchNo (None, 7, 7, 192)    576         conv2d_64[0][0]                  
__________________________________________________________________________________________________
activation_64 (Activation)      (None, 7, 7, 192)    0           batch_normalization_64[0][0]     
__________________________________________________________________________________________________
conv2d_65 (Conv2D)              (None, 7, 7, 192)    258048      activation_64[0][0]              
__________________________________________________________________________________________________
batch_normalization_65 (BatchNo (None, 7, 7, 192)    576         conv2d_65[0][0]                  
__________________________________________________________________________________________________
activation_65 (Activation)      (None, 7, 7, 192)    0           batch_normalization_65[0][0]     
__________________________________________________________________________________________________
conv2d_61 (Conv2D)              (None, 7, 7, 192)    147456      mixed6[0][0]                     
__________________________________________________________________________________________________
conv2d_66 (Conv2D)              (None, 7, 7, 192)    258048      activation_65[0][0]              
__________________________________________________________________________________________________
batch_normalization_61 (BatchNo (None, 7, 7, 192)    576         conv2d_61[0][0]                  
__________________________________________________________________________________________________
batch_normalization_66 (BatchNo (None, 7, 7, 192)    576         conv2d_66[0][0]                  
__________________________________________________________________________________________________
activation_61 (Activation)      (None, 7, 7, 192)    0           batch_normalization_61[0][0]     
__________________________________________________________________________________________________
activation_66 (Activation)      (None, 7, 7, 192)    0           batch_normalization_66[0][0]     
__________________________________________________________________________________________________
conv2d_62 (Conv2D)              (None, 7, 7, 192)    258048      activation_61[0][0]              
__________________________________________________________________________________________________
conv2d_67 (Conv2D)              (None, 7, 7, 192)    258048      activation_66[0][0]              
__________________________________________________________________________________________________
batch_normalization_62 (BatchNo (None, 7, 7, 192)    576         conv2d_62[0][0]                  
__________________________________________________________________________________________________
batch_normalization_67 (BatchNo (None, 7, 7, 192)    576         conv2d_67[0][0]                  
__________________________________________________________________________________________________
activation_62 (Activation)      (None, 7, 7, 192)    0           batch_normalization_62[0][0]     
__________________________________________________________________________________________________
activation_67 (Activation)      (None, 7, 7, 192)    0           batch_normalization_67[0][0]     
__________________________________________________________________________________________________
average_pooling2d_6 (AveragePoo (None, 7, 7, 768)    0           mixed6[0][0]                     
__________________________________________________________________________________________________
conv2d_60 (Conv2D)              (None, 7, 7, 192)    147456      mixed6[0][0]                     
__________________________________________________________________________________________________
conv2d_63 (Conv2D)              (None, 7, 7, 192)    258048      activation_62[0][0]              
__________________________________________________________________________________________________
conv2d_68 (Conv2D)              (None, 7, 7, 192)    258048      activation_67[0][0]              
__________________________________________________________________________________________________
conv2d_69 (Conv2D)              (None, 7, 7, 192)    147456      average_pooling2d_6[0][0]        
__________________________________________________________________________________________________
batch_normalization_60 (BatchNo (None, 7, 7, 192)    576         conv2d_60[0][0]                  
__________________________________________________________________________________________________
batch_normalization_63 (BatchNo (None, 7, 7, 192)    576         conv2d_63[0][0]                  
__________________________________________________________________________________________________
batch_normalization_68 (BatchNo (None, 7, 7, 192)    576         conv2d_68[0][0]                  
__________________________________________________________________________________________________
batch_normalization_69 (BatchNo (None, 7, 7, 192)    576         conv2d_69[0][0]                  
__________________________________________________________________________________________________
activation_60 (Activation)      (None, 7, 7, 192)    0           batch_normalization_60[0][0]     
__________________________________________________________________________________________________
activation_63 (Activation)      (None, 7, 7, 192)    0           batch_normalization_63[0][0]     
__________________________________________________________________________________________________
activation_68 (Activation)      (None, 7, 7, 192)    0           batch_normalization_68[0][0]     
__________________________________________________________________________________________________
activation_69 (Activation)      (None, 7, 7, 192)    0           batch_normalization_69[0][0]     
__________________________________________________________________________________________________
mixed7 (Concatenate)            (None, 7, 7, 768)    0           activation_60[0][0]              
                                                                 activation_63[0][0]              
                                                                 activation_68[0][0]              
                                                                 activation_69[0][0]              
__________________________________________________________________________________________________
conv2d_72 (Conv2D)              (None, 7, 7, 192)    147456      mixed7[0][0]                     
__________________________________________________________________________________________________
batch_normalization_72 (BatchNo (None, 7, 7, 192)    576         conv2d_72[0][0]                  
__________________________________________________________________________________________________
activation_72 (Activation)      (None, 7, 7, 192)    0           batch_normalization_72[0][0]     
__________________________________________________________________________________________________
conv2d_73 (Conv2D)              (None, 7, 7, 192)    258048      activation_72[0][0]              
__________________________________________________________________________________________________
batch_normalization_73 (BatchNo (None, 7, 7, 192)    576         conv2d_73[0][0]                  
__________________________________________________________________________________________________
activation_73 (Activation)      (None, 7, 7, 192)    0           batch_normalization_73[0][0]     
__________________________________________________________________________________________________
conv2d_70 (Conv2D)              (None, 7, 7, 192)    147456      mixed7[0][0]                     
__________________________________________________________________________________________________
conv2d_74 (Conv2D)              (None, 7, 7, 192)    258048      activation_73[0][0]              
__________________________________________________________________________________________________
batch_normalization_70 (BatchNo (None, 7, 7, 192)    576         conv2d_70[0][0]                  
__________________________________________________________________________________________________
batch_normalization_74 (BatchNo (None, 7, 7, 192)    576         conv2d_74[0][0]                  
__________________________________________________________________________________________________
activation_70 (Activation)      (None, 7, 7, 192)    0           batch_normalization_70[0][0]     
__________________________________________________________________________________________________
activation_74 (Activation)      (None, 7, 7, 192)    0           batch_normalization_74[0][0]     
__________________________________________________________________________________________________
conv2d_71 (Conv2D)              (None, 3, 3, 320)    552960      activation_70[0][0]              
__________________________________________________________________________________________________
conv2d_75 (Conv2D)              (None, 3, 3, 192)    331776      activation_74[0][0]              
__________________________________________________________________________________________________
batch_normalization_71 (BatchNo (None, 3, 3, 320)    960         conv2d_71[0][0]                  
__________________________________________________________________________________________________
batch_normalization_75 (BatchNo (None, 3, 3, 192)    576         conv2d_75[0][0]                  
__________________________________________________________________________________________________
activation_71 (Activation)      (None, 3, 3, 320)    0           batch_normalization_71[0][0]     
__________________________________________________________________________________________________
activation_75 (Activation)      (None, 3, 3, 192)    0           batch_normalization_75[0][0]     
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, 3, 3, 768)    0           mixed7[0][0]                     
__________________________________________________________________________________________________
mixed8 (Concatenate)            (None, 3, 3, 1280)   0           activation_71[0][0]              
                                                                 activation_75[0][0]              
                                                                 max_pooling2d_3[0][0]            
__________________________________________________________________________________________________
conv2d_80 (Conv2D)              (None, 3, 3, 448)    573440      mixed8[0][0]                     
__________________________________________________________________________________________________
batch_normalization_80 (BatchNo (None, 3, 3, 448)    1344        conv2d_80[0][0]                  
__________________________________________________________________________________________________
activation_80 (Activation)      (None, 3, 3, 448)    0           batch_normalization_80[0][0]     
__________________________________________________________________________________________________
conv2d_77 (Conv2D)              (None, 3, 3, 384)    491520      mixed8[0][0]                     
__________________________________________________________________________________________________
conv2d_81 (Conv2D)              (None, 3, 3, 384)    1548288     activation_80[0][0]              
__________________________________________________________________________________________________
batch_normalization_77 (BatchNo (None, 3, 3, 384)    1152        conv2d_77[0][0]                  
__________________________________________________________________________________________________
batch_normalization_81 (BatchNo (None, 3, 3, 384)    1152        conv2d_81[0][0]                  
__________________________________________________________________________________________________
activation_77 (Activation)      (None, 3, 3, 384)    0           batch_normalization_77[0][0]     
__________________________________________________________________________________________________
activation_81 (Activation)      (None, 3, 3, 384)    0           batch_normalization_81[0][0]     
__________________________________________________________________________________________________
conv2d_78 (Conv2D)              (None, 3, 3, 384)    442368      activation_77[0][0]              
__________________________________________________________________________________________________
conv2d_79 (Conv2D)              (None, 3, 3, 384)    442368      activation_77[0][0]              
__________________________________________________________________________________________________
conv2d_82 (Conv2D)              (None, 3, 3, 384)    442368      activation_81[0][0]              
__________________________________________________________________________________________________
conv2d_83 (Conv2D)              (None, 3, 3, 384)    442368      activation_81[0][0]              
__________________________________________________________________________________________________
average_pooling2d_7 (AveragePoo (None, 3, 3, 1280)   0           mixed8[0][0]                     
__________________________________________________________________________________________________
conv2d_76 (Conv2D)              (None, 3, 3, 320)    409600      mixed8[0][0]                     
__________________________________________________________________________________________________
batch_normalization_78 (BatchNo (None, 3, 3, 384)    1152        conv2d_78[0][0]                  
__________________________________________________________________________________________________
batch_normalization_79 (BatchNo (None, 3, 3, 384)    1152        conv2d_79[0][0]                  
__________________________________________________________________________________________________
batch_normalization_82 (BatchNo (None, 3, 3, 384)    1152        conv2d_82[0][0]                  
__________________________________________________________________________________________________
batch_normalization_83 (BatchNo (None, 3, 3, 384)    1152        conv2d_83[0][0]                  
__________________________________________________________________________________________________
conv2d_84 (Conv2D)              (None, 3, 3, 192)    245760      average_pooling2d_7[0][0]        
__________________________________________________________________________________________________
batch_normalization_76 (BatchNo (None, 3, 3, 320)    960         conv2d_76[0][0]                  
__________________________________________________________________________________________________
activation_78 (Activation)      (None, 3, 3, 384)    0           batch_normalization_78[0][0]     
__________________________________________________________________________________________________
activation_79 (Activation)      (None, 3, 3, 384)    0           batch_normalization_79[0][0]     
__________________________________________________________________________________________________
activation_82 (Activation)      (None, 3, 3, 384)    0           batch_normalization_82[0][0]     
__________________________________________________________________________________________________
activation_83 (Activation)      (None, 3, 3, 384)    0           batch_normalization_83[0][0]     
__________________________________________________________________________________________________
batch_normalization_84 (BatchNo (None, 3, 3, 192)    576         conv2d_84[0][0]                  
__________________________________________________________________________________________________
activation_76 (Activation)      (None, 3, 3, 320)    0           batch_normalization_76[0][0]     
__________________________________________________________________________________________________
mixed9_0 (Concatenate)          (None, 3, 3, 768)    0           activation_78[0][0]              
                                                                 activation_79[0][0]              
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 3, 3, 768)    0           activation_82[0][0]              
                                                                 activation_83[0][0]              
__________________________________________________________________________________________________
activation_84 (Activation)      (None, 3, 3, 192)    0           batch_normalization_84[0][0]     
__________________________________________________________________________________________________
mixed9 (Concatenate)            (None, 3, 3, 2048)   0           activation_76[0][0]              
                                                                 mixed9_0[0][0]                   
                                                                 concatenate[0][0]                
                                                                 activation_84[0][0]              
__________________________________________________________________________________________________
conv2d_89 (Conv2D)              (None, 3, 3, 448)    917504      mixed9[0][0]                     
__________________________________________________________________________________________________
batch_normalization_89 (BatchNo (None, 3, 3, 448)    1344        conv2d_89[0][0]                  
__________________________________________________________________________________________________
activation_89 (Activation)      (None, 3, 3, 448)    0           batch_normalization_89[0][0]     
__________________________________________________________________________________________________
conv2d_86 (Conv2D)              (None, 3, 3, 384)    786432      mixed9[0][0]                     
__________________________________________________________________________________________________
conv2d_90 (Conv2D)              (None, 3, 3, 384)    1548288     activation_89[0][0]              
__________________________________________________________________________________________________
batch_normalization_86 (BatchNo (None, 3, 3, 384)    1152        conv2d_86[0][0]                  
__________________________________________________________________________________________________
batch_normalization_90 (BatchNo (None, 3, 3, 384)    1152        conv2d_90[0][0]                  
__________________________________________________________________________________________________
activation_86 (Activation)      (None, 3, 3, 384)    0           batch_normalization_86[0][0]     
__________________________________________________________________________________________________
activation_90 (Activation)      (None, 3, 3, 384)    0           batch_normalization_90[0][0]     
__________________________________________________________________________________________________
conv2d_87 (Conv2D)              (None, 3, 3, 384)    442368      activation_86[0][0]              
__________________________________________________________________________________________________
conv2d_88 (Conv2D)              (None, 3, 3, 384)    442368      activation_86[0][0]              
__________________________________________________________________________________________________
conv2d_91 (Conv2D)              (None, 3, 3, 384)    442368      activation_90[0][0]              
__________________________________________________________________________________________________
conv2d_92 (Conv2D)              (None, 3, 3, 384)    442368      activation_90[0][0]              
__________________________________________________________________________________________________
average_pooling2d_8 (AveragePoo (None, 3, 3, 2048)   0           mixed9[0][0]                     
__________________________________________________________________________________________________
conv2d_85 (Conv2D)              (None, 3, 3, 320)    655360      mixed9[0][0]                     
__________________________________________________________________________________________________
batch_normalization_87 (BatchNo (None, 3, 3, 384)    1152        conv2d_87[0][0]                  
__________________________________________________________________________________________________
batch_normalization_88 (BatchNo (None, 3, 3, 384)    1152        conv2d_88[0][0]                  
__________________________________________________________________________________________________
batch_normalization_91 (BatchNo (None, 3, 3, 384)    1152        conv2d_91[0][0]                  
__________________________________________________________________________________________________
batch_normalization_92 (BatchNo (None, 3, 3, 384)    1152        conv2d_92[0][0]                  
__________________________________________________________________________________________________
conv2d_93 (Conv2D)              (None, 3, 3, 192)    393216      average_pooling2d_8[0][0]        
__________________________________________________________________________________________________
batch_normalization_85 (BatchNo (None, 3, 3, 320)    960         conv2d_85[0][0]                  
__________________________________________________________________________________________________
activation_87 (Activation)      (None, 3, 3, 384)    0           batch_normalization_87[0][0]     
__________________________________________________________________________________________________
activation_88 (Activation)      (None, 3, 3, 384)    0           batch_normalization_88[0][0]     
__________________________________________________________________________________________________
activation_91 (Activation)      (None, 3, 3, 384)    0           batch_normalization_91[0][0]     
__________________________________________________________________________________________________
activation_92 (Activation)      (None, 3, 3, 384)    0           batch_normalization_92[0][0]     
__________________________________________________________________________________________________
batch_normalization_93 (BatchNo (None, 3, 3, 192)    576         conv2d_93[0][0]                  
__________________________________________________________________________________________________
activation_85 (Activation)      (None, 3, 3, 320)    0           batch_normalization_85[0][0]     
__________________________________________________________________________________________________
mixed9_1 (Concatenate)          (None, 3, 3, 768)    0           activation_87[0][0]              
                                                                 activation_88[0][0]              
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 3, 3, 768)    0           activation_91[0][0]              
                                                                 activation_92[0][0]              
__________________________________________________________________________________________________
activation_93 (Activation)      (None, 3, 3, 192)    0           batch_normalization_93[0][0]     
__________________________________________________________________________________________________
mixed10 (Concatenate)           (None, 3, 3, 2048)   0           activation_85[0][0]              
                                                                 mixed9_1[0][0]                   
                                                                 concatenate_1[0][0]              
                                                                 activation_93[0][0]              
==================================================================================================
Total params: 21,802,784
Trainable params: 0
Non-trainable params: 21,802,784
__________________________________________________________________________________________________
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;last_layer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pre_trained_model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get_layer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;mixed7&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;last layer output shape: &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;last_layer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;output_shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;last_output&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;last_layer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;output&lt;/span&gt;


&lt;span class=&quot;c1&quot;&gt;# Expected Output:&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# (&amp;#39;last layer output shape: &amp;#39;, (None, 7, 7, 768))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;last layer output shape:  (None, 7, 7, 768)
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Define a Callback class that stops training once accuracy reaches 97.0%&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;myCallback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;callbacks&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Callback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;on_epoch_end&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;epoch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;logs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{}):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;logs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;accuracy&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.97&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
      &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;Reached 97.0&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;% a&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ccuracy so cancelling training!&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stop_training&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;

      
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tensorflow.keras.optimizers&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;RMSprop&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Flatten the output layer to 1 dimension&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Flatten&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;last_output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Add a fully connected layer with 1,024 hidden units and ReLU activation&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;activation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;relu&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Add a dropout rate of 0.2&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dropout&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;                  
&lt;span class=&quot;c1&quot;&gt;# Add a final sigmoid layer for classification&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;  &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;activation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;sigmoid&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;           

&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pre_trained_model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; 

&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;compile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;RMSprop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.0001&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; 
         &lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;binary_crossentropy&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
         &lt;span class=&quot;n&quot;&gt;metrics&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;accuracy&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;summary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Expected output will be large. Last few lines should be:&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# mixed7 (Concatenate)            (None, 7, 7, 768)    0           activation_248[0][0]             &lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#                                                                  activation_251[0][0]             &lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#                                                                  activation_256[0][0]             &lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#                                                                  activation_257[0][0]             &lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# __________________________________________________________________________________________________&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# flatten_4 (Flatten)             (None, 37632)        0           mixed7[0][0]                     &lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# __________________________________________________________________________________________________&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# dense_8 (Dense)                 (None, 1024)         38536192    flatten_4[0][0]                  &lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# __________________________________________________________________________________________________&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# dropout_4 (Dropout)             (None, 1024)         0           dense_8[0][0]                    &lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# __________________________________________________________________________________________________&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# dense_9 (Dense)                 (None, 1)            1025        dropout_4[0][0]                  &lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# ==================================================================================================&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Total params: 47,512,481&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Trainable params: 38,537,217&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Non-trainable params: 8,975,264&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Model: &amp;#34;model&amp;#34;
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 150, 150, 3) 0                                            
__________________________________________________________________________________________________
conv2d (Conv2D)                 (None, 74, 74, 32)   864         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization (BatchNorma (None, 74, 74, 32)   96          conv2d[0][0]                     
__________________________________________________________________________________________________
activation (Activation)         (None, 74, 74, 32)   0           batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 72, 72, 32)   9216        activation[0][0]                 
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 72, 72, 32)   96          conv2d_1[0][0]                   
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 72, 72, 32)   0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 72, 72, 64)   18432       activation_1[0][0]               
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 72, 72, 64)   192         conv2d_2[0][0]                   
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 72, 72, 64)   0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)    (None, 35, 35, 64)   0           activation_2[0][0]               
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 35, 35, 80)   5120        max_pooling2d[0][0]              
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 35, 35, 80)   240         conv2d_3[0][0]                   
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 35, 35, 80)   0           batch_normalization_3[0][0]      
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 33, 33, 192)  138240      activation_3[0][0]               
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 33, 33, 192)  576         conv2d_4[0][0]                   
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 33, 33, 192)  0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 16, 192)  0           activation_4[0][0]               
__________________________________________________________________________________________________
conv2d_8 (Conv2D)               (None, 16, 16, 64)   12288       max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
batch_normalization_8 (BatchNor (None, 16, 16, 64)   192         conv2d_8[0][0]                   
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 16, 16, 64)   0           batch_normalization_8[0][0]      
__________________________________________________________________________________________________
conv2d_6 (Conv2D)               (None, 16, 16, 48)   9216        max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
conv2d_9 (Conv2D)               (None, 16, 16, 96)   55296       activation_8[0][0]               
__________________________________________________________________________________________________
batch_normalization_6 (BatchNor (None, 16, 16, 48)   144         conv2d_6[0][0]                   
__________________________________________________________________________________________________
batch_normalization_9 (BatchNor (None, 16, 16, 96)   288         conv2d_9[0][0]                   
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 16, 16, 48)   0           batch_normalization_6[0][0]      
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 16, 16, 96)   0           batch_normalization_9[0][0]      
__________________________________________________________________________________________________
average_pooling2d (AveragePooli (None, 16, 16, 192)  0           max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 16, 16, 64)   12288       max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
conv2d_7 (Conv2D)               (None, 16, 16, 64)   76800       activation_6[0][0]               
__________________________________________________________________________________________________
conv2d_10 (Conv2D)              (None, 16, 16, 96)   82944       activation_9[0][0]               
__________________________________________________________________________________________________
conv2d_11 (Conv2D)              (None, 16, 16, 32)   6144        average_pooling2d[0][0]          
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 16, 16, 64)   192         conv2d_5[0][0]                   
__________________________________________________________________________________________________
batch_normalization_7 (BatchNor (None, 16, 16, 64)   192         conv2d_7[0][0]                   
__________________________________________________________________________________________________
batch_normalization_10 (BatchNo (None, 16, 16, 96)   288         conv2d_10[0][0]                  
__________________________________________________________________________________________________
batch_normalization_11 (BatchNo (None, 16, 16, 32)   96          conv2d_11[0][0]                  
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 16, 16, 64)   0           batch_normalization_5[0][0]      
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 16, 16, 64)   0           batch_normalization_7[0][0]      
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 16, 16, 96)   0           batch_normalization_10[0][0]     
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 16, 16, 32)   0           batch_normalization_11[0][0]     
__________________________________________________________________________________________________
mixed0 (Concatenate)            (None, 16, 16, 256)  0           activation_5[0][0]               
                                                                 activation_7[0][0]               
                                                                 activation_10[0][0]              
                                                                 activation_11[0][0]              
__________________________________________________________________________________________________
conv2d_15 (Conv2D)              (None, 16, 16, 64)   16384       mixed0[0][0]                     
__________________________________________________________________________________________________
batch_normalization_15 (BatchNo (None, 16, 16, 64)   192         conv2d_15[0][0]                  
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 16, 16, 64)   0           batch_normalization_15[0][0]     
__________________________________________________________________________________________________
conv2d_13 (Conv2D)              (None, 16, 16, 48)   12288       mixed0[0][0]                     
__________________________________________________________________________________________________
conv2d_16 (Conv2D)              (None, 16, 16, 96)   55296       activation_15[0][0]              
__________________________________________________________________________________________________
batch_normalization_13 (BatchNo (None, 16, 16, 48)   144         conv2d_13[0][0]                  
__________________________________________________________________________________________________
batch_normalization_16 (BatchNo (None, 16, 16, 96)   288         conv2d_16[0][0]                  
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 16, 16, 48)   0           batch_normalization_13[0][0]     
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 16, 16, 96)   0           batch_normalization_16[0][0]     
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 16, 16, 256)  0           mixed0[0][0]                     
__________________________________________________________________________________________________
conv2d_12 (Conv2D)              (None, 16, 16, 64)   16384       mixed0[0][0]                     
__________________________________________________________________________________________________
conv2d_14 (Conv2D)              (None, 16, 16, 64)   76800       activation_13[0][0]              
__________________________________________________________________________________________________
conv2d_17 (Conv2D)              (None, 16, 16, 96)   82944       activation_16[0][0]              
__________________________________________________________________________________________________
conv2d_18 (Conv2D)              (None, 16, 16, 64)   16384       average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
batch_normalization_12 (BatchNo (None, 16, 16, 64)   192         conv2d_12[0][0]                  
__________________________________________________________________________________________________
batch_normalization_14 (BatchNo (None, 16, 16, 64)   192         conv2d_14[0][0]                  
__________________________________________________________________________________________________
batch_normalization_17 (BatchNo (None, 16, 16, 96)   288         conv2d_17[0][0]                  
__________________________________________________________________________________________________
batch_normalization_18 (BatchNo (None, 16, 16, 64)   192         conv2d_18[0][0]                  
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 16, 16, 64)   0           batch_normalization_12[0][0]     
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 16, 16, 64)   0           batch_normalization_14[0][0]     
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 16, 16, 96)   0           batch_normalization_17[0][0]     
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 16, 16, 64)   0           batch_normalization_18[0][0]     
__________________________________________________________________________________________________
mixed1 (Concatenate)            (None, 16, 16, 288)  0           activation_12[0][0]              
                                                                 activation_14[0][0]              
                                                                 activation_17[0][0]              
                                                                 activation_18[0][0]              
__________________________________________________________________________________________________
conv2d_22 (Conv2D)              (None, 16, 16, 64)   18432       mixed1[0][0]                     
__________________________________________________________________________________________________
batch_normalization_22 (BatchNo (None, 16, 16, 64)   192         conv2d_22[0][0]                  
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 16, 16, 64)   0           batch_normalization_22[0][0]     
__________________________________________________________________________________________________
conv2d_20 (Conv2D)              (None, 16, 16, 48)   13824       mixed1[0][0]                     
__________________________________________________________________________________________________
conv2d_23 (Conv2D)              (None, 16, 16, 96)   55296       activation_22[0][0]              
__________________________________________________________________________________________________
batch_normalization_20 (BatchNo (None, 16, 16, 48)   144         conv2d_20[0][0]                  
__________________________________________________________________________________________________
batch_normalization_23 (BatchNo (None, 16, 16, 96)   288         conv2d_23[0][0]                  
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 16, 16, 48)   0           batch_normalization_20[0][0]     
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 16, 16, 96)   0           batch_normalization_23[0][0]     
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 16, 16, 288)  0           mixed1[0][0]                     
__________________________________________________________________________________________________
conv2d_19 (Conv2D)              (None, 16, 16, 64)   18432       mixed1[0][0]                     
__________________________________________________________________________________________________
conv2d_21 (Conv2D)              (None, 16, 16, 64)   76800       activation_20[0][0]              
__________________________________________________________________________________________________
conv2d_24 (Conv2D)              (None, 16, 16, 96)   82944       activation_23[0][0]              
__________________________________________________________________________________________________
conv2d_25 (Conv2D)              (None, 16, 16, 64)   18432       average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
batch_normalization_19 (BatchNo (None, 16, 16, 64)   192         conv2d_19[0][0]                  
__________________________________________________________________________________________________
batch_normalization_21 (BatchNo (None, 16, 16, 64)   192         conv2d_21[0][0]                  
__________________________________________________________________________________________________
batch_normalization_24 (BatchNo (None, 16, 16, 96)   288         conv2d_24[0][0]                  
__________________________________________________________________________________________________
batch_normalization_25 (BatchNo (None, 16, 16, 64)   192         conv2d_25[0][0]                  
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 16, 16, 64)   0           batch_normalization_19[0][0]     
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 16, 16, 64)   0           batch_normalization_21[0][0]     
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 16, 16, 96)   0           batch_normalization_24[0][0]     
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 16, 16, 64)   0           batch_normalization_25[0][0]     
__________________________________________________________________________________________________
mixed2 (Concatenate)            (None, 16, 16, 288)  0           activation_19[0][0]              
                                                                 activation_21[0][0]              
                                                                 activation_24[0][0]              
                                                                 activation_25[0][0]              
__________________________________________________________________________________________________
conv2d_27 (Conv2D)              (None, 16, 16, 64)   18432       mixed2[0][0]                     
__________________________________________________________________________________________________
batch_normalization_27 (BatchNo (None, 16, 16, 64)   192         conv2d_27[0][0]                  
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 16, 16, 64)   0           batch_normalization_27[0][0]     
__________________________________________________________________________________________________
conv2d_28 (Conv2D)              (None, 16, 16, 96)   55296       activation_27[0][0]              
__________________________________________________________________________________________________
batch_normalization_28 (BatchNo (None, 16, 16, 96)   288         conv2d_28[0][0]                  
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 16, 16, 96)   0           batch_normalization_28[0][0]     
__________________________________________________________________________________________________
conv2d_26 (Conv2D)              (None, 7, 7, 384)    995328      mixed2[0][0]                     
__________________________________________________________________________________________________
conv2d_29 (Conv2D)              (None, 7, 7, 96)     82944       activation_28[0][0]              
__________________________________________________________________________________________________
batch_normalization_26 (BatchNo (None, 7, 7, 384)    1152        conv2d_26[0][0]                  
__________________________________________________________________________________________________
batch_normalization_29 (BatchNo (None, 7, 7, 96)     288         conv2d_29[0][0]                  
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 7, 7, 384)    0           batch_normalization_26[0][0]     
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 7, 7, 96)     0           batch_normalization_29[0][0]     
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 7, 7, 288)    0           mixed2[0][0]                     
__________________________________________________________________________________________________
mixed3 (Concatenate)            (None, 7, 7, 768)    0           activation_26[0][0]              
                                                                 activation_29[0][0]              
                                                                 max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
conv2d_34 (Conv2D)              (None, 7, 7, 128)    98304       mixed3[0][0]                     
__________________________________________________________________________________________________
batch_normalization_34 (BatchNo (None, 7, 7, 128)    384         conv2d_34[0][0]                  
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 7, 7, 128)    0           batch_normalization_34[0][0]     
__________________________________________________________________________________________________
conv2d_35 (Conv2D)              (None, 7, 7, 128)    114688      activation_34[0][0]              
__________________________________________________________________________________________________
batch_normalization_35 (BatchNo (None, 7, 7, 128)    384         conv2d_35[0][0]                  
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 7, 7, 128)    0           batch_normalization_35[0][0]     
__________________________________________________________________________________________________
conv2d_31 (Conv2D)              (None, 7, 7, 128)    98304       mixed3[0][0]                     
__________________________________________________________________________________________________
conv2d_36 (Conv2D)              (None, 7, 7, 128)    114688      activation_35[0][0]              
__________________________________________________________________________________________________
batch_normalization_31 (BatchNo (None, 7, 7, 128)    384         conv2d_31[0][0]                  
__________________________________________________________________________________________________
batch_normalization_36 (BatchNo (None, 7, 7, 128)    384         conv2d_36[0][0]                  
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 7, 7, 128)    0           batch_normalization_31[0][0]     
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 7, 7, 128)    0           batch_normalization_36[0][0]     
__________________________________________________________________________________________________
conv2d_32 (Conv2D)              (None, 7, 7, 128)    114688      activation_31[0][0]              
__________________________________________________________________________________________________
conv2d_37 (Conv2D)              (None, 7, 7, 128)    114688      activation_36[0][0]              
__________________________________________________________________________________________________
batch_normalization_32 (BatchNo (None, 7, 7, 128)    384         conv2d_32[0][0]                  
__________________________________________________________________________________________________
batch_normalization_37 (BatchNo (None, 7, 7, 128)    384         conv2d_37[0][0]                  
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 7, 7, 128)    0           batch_normalization_32[0][0]     
__________________________________________________________________________________________________
activation_37 (Activation)      (None, 7, 7, 128)    0           batch_normalization_37[0][0]     
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 7, 7, 768)    0           mixed3[0][0]                     
__________________________________________________________________________________________________
conv2d_30 (Conv2D)              (None, 7, 7, 192)    147456      mixed3[0][0]                     
__________________________________________________________________________________________________
conv2d_33 (Conv2D)              (None, 7, 7, 192)    172032      activation_32[0][0]              
__________________________________________________________________________________________________
conv2d_38 (Conv2D)              (None, 7, 7, 192)    172032      activation_37[0][0]              
__________________________________________________________________________________________________
conv2d_39 (Conv2D)              (None, 7, 7, 192)    147456      average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
batch_normalization_30 (BatchNo (None, 7, 7, 192)    576         conv2d_30[0][0]                  
__________________________________________________________________________________________________
batch_normalization_33 (BatchNo (None, 7, 7, 192)    576         conv2d_33[0][0]                  
__________________________________________________________________________________________________
batch_normalization_38 (BatchNo (None, 7, 7, 192)    576         conv2d_38[0][0]                  
__________________________________________________________________________________________________
batch_normalization_39 (BatchNo (None, 7, 7, 192)    576         conv2d_39[0][0]                  
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 7, 7, 192)    0           batch_normalization_30[0][0]     
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 7, 7, 192)    0           batch_normalization_33[0][0]     
__________________________________________________________________________________________________
activation_38 (Activation)      (None, 7, 7, 192)    0           batch_normalization_38[0][0]     
__________________________________________________________________________________________________
activation_39 (Activation)      (None, 7, 7, 192)    0           batch_normalization_39[0][0]     
__________________________________________________________________________________________________
mixed4 (Concatenate)            (None, 7, 7, 768)    0           activation_30[0][0]              
                                                                 activation_33[0][0]              
                                                                 activation_38[0][0]              
                                                                 activation_39[0][0]              
__________________________________________________________________________________________________
conv2d_44 (Conv2D)              (None, 7, 7, 160)    122880      mixed4[0][0]                     
__________________________________________________________________________________________________
batch_normalization_44 (BatchNo (None, 7, 7, 160)    480         conv2d_44[0][0]                  
__________________________________________________________________________________________________
activation_44 (Activation)      (None, 7, 7, 160)    0           batch_normalization_44[0][0]     
__________________________________________________________________________________________________
conv2d_45 (Conv2D)              (None, 7, 7, 160)    179200      activation_44[0][0]              
__________________________________________________________________________________________________
batch_normalization_45 (BatchNo (None, 7, 7, 160)    480         conv2d_45[0][0]                  
__________________________________________________________________________________________________
activation_45 (Activation)      (None, 7, 7, 160)    0           batch_normalization_45[0][0]     
__________________________________________________________________________________________________
conv2d_41 (Conv2D)              (None, 7, 7, 160)    122880      mixed4[0][0]                     
__________________________________________________________________________________________________
conv2d_46 (Conv2D)              (None, 7, 7, 160)    179200      activation_45[0][0]              
__________________________________________________________________________________________________
batch_normalization_41 (BatchNo (None, 7, 7, 160)    480         conv2d_41[0][0]                  
__________________________________________________________________________________________________
batch_normalization_46 (BatchNo (None, 7, 7, 160)    480         conv2d_46[0][0]                  
__________________________________________________________________________________________________
activation_41 (Activation)      (None, 7, 7, 160)    0           batch_normalization_41[0][0]     
__________________________________________________________________________________________________
activation_46 (Activation)      (None, 7, 7, 160)    0           batch_normalization_46[0][0]     
__________________________________________________________________________________________________
conv2d_42 (Conv2D)              (None, 7, 7, 160)    179200      activation_41[0][0]              
__________________________________________________________________________________________________
conv2d_47 (Conv2D)              (None, 7, 7, 160)    179200      activation_46[0][0]              
__________________________________________________________________________________________________
batch_normalization_42 (BatchNo (None, 7, 7, 160)    480         conv2d_42[0][0]                  
__________________________________________________________________________________________________
batch_normalization_47 (BatchNo (None, 7, 7, 160)    480         conv2d_47[0][0]                  
__________________________________________________________________________________________________
activation_42 (Activation)      (None, 7, 7, 160)    0           batch_normalization_42[0][0]     
__________________________________________________________________________________________________
activation_47 (Activation)      (None, 7, 7, 160)    0           batch_normalization_47[0][0]     
__________________________________________________________________________________________________
average_pooling2d_4 (AveragePoo (None, 7, 7, 768)    0           mixed4[0][0]                     
__________________________________________________________________________________________________
conv2d_40 (Conv2D)              (None, 7, 7, 192)    147456      mixed4[0][0]                     
__________________________________________________________________________________________________
conv2d_43 (Conv2D)              (None, 7, 7, 192)    215040      activation_42[0][0]              
__________________________________________________________________________________________________
conv2d_48 (Conv2D)              (None, 7, 7, 192)    215040      activation_47[0][0]              
__________________________________________________________________________________________________
conv2d_49 (Conv2D)              (None, 7, 7, 192)    147456      average_pooling2d_4[0][0]        
__________________________________________________________________________________________________
batch_normalization_40 (BatchNo (None, 7, 7, 192)    576         conv2d_40[0][0]                  
__________________________________________________________________________________________________
batch_normalization_43 (BatchNo (None, 7, 7, 192)    576         conv2d_43[0][0]                  
__________________________________________________________________________________________________
batch_normalization_48 (BatchNo (None, 7, 7, 192)    576         conv2d_48[0][0]                  
__________________________________________________________________________________________________
batch_normalization_49 (BatchNo (None, 7, 7, 192)    576         conv2d_49[0][0]                  
__________________________________________________________________________________________________
activation_40 (Activation)      (None, 7, 7, 192)    0           batch_normalization_40[0][0]     
__________________________________________________________________________________________________
activation_43 (Activation)      (None, 7, 7, 192)    0           batch_normalization_43[0][0]     
__________________________________________________________________________________________________
activation_48 (Activation)      (None, 7, 7, 192)    0           batch_normalization_48[0][0]     
__________________________________________________________________________________________________
activation_49 (Activation)      (None, 7, 7, 192)    0           batch_normalization_49[0][0]     
__________________________________________________________________________________________________
mixed5 (Concatenate)            (None, 7, 7, 768)    0           activation_40[0][0]              
                                                                 activation_43[0][0]              
                                                                 activation_48[0][0]              
                                                                 activation_49[0][0]              
__________________________________________________________________________________________________
conv2d_54 (Conv2D)              (None, 7, 7, 160)    122880      mixed5[0][0]                     
__________________________________________________________________________________________________
batch_normalization_54 (BatchNo (None, 7, 7, 160)    480         conv2d_54[0][0]                  
__________________________________________________________________________________________________
activation_54 (Activation)      (None, 7, 7, 160)    0           batch_normalization_54[0][0]     
__________________________________________________________________________________________________
conv2d_55 (Conv2D)              (None, 7, 7, 160)    179200      activation_54[0][0]              
__________________________________________________________________________________________________
batch_normalization_55 (BatchNo (None, 7, 7, 160)    480         conv2d_55[0][0]                  
__________________________________________________________________________________________________
activation_55 (Activation)      (None, 7, 7, 160)    0           batch_normalization_55[0][0]     
__________________________________________________________________________________________________
conv2d_51 (Conv2D)              (None, 7, 7, 160)    122880      mixed5[0][0]                     
__________________________________________________________________________________________________
conv2d_56 (Conv2D)              (None, 7, 7, 160)    179200      activation_55[0][0]              
__________________________________________________________________________________________________
batch_normalization_51 (BatchNo (None, 7, 7, 160)    480         conv2d_51[0][0]                  
__________________________________________________________________________________________________
batch_normalization_56 (BatchNo (None, 7, 7, 160)    480         conv2d_56[0][0]                  
__________________________________________________________________________________________________
activation_51 (Activation)      (None, 7, 7, 160)    0           batch_normalization_51[0][0]     
__________________________________________________________________________________________________
activation_56 (Activation)      (None, 7, 7, 160)    0           batch_normalization_56[0][0]     
__________________________________________________________________________________________________
conv2d_52 (Conv2D)              (None, 7, 7, 160)    179200      activation_51[0][0]              
__________________________________________________________________________________________________
conv2d_57 (Conv2D)              (None, 7, 7, 160)    179200      activation_56[0][0]              
__________________________________________________________________________________________________
batch_normalization_52 (BatchNo (None, 7, 7, 160)    480         conv2d_52[0][0]                  
__________________________________________________________________________________________________
batch_normalization_57 (BatchNo (None, 7, 7, 160)    480         conv2d_57[0][0]                  
__________________________________________________________________________________________________
activation_52 (Activation)      (None, 7, 7, 160)    0           batch_normalization_52[0][0]     
__________________________________________________________________________________________________
activation_57 (Activation)      (None, 7, 7, 160)    0           batch_normalization_57[0][0]     
__________________________________________________________________________________________________
average_pooling2d_5 (AveragePoo (None, 7, 7, 768)    0           mixed5[0][0]                     
__________________________________________________________________________________________________
conv2d_50 (Conv2D)              (None, 7, 7, 192)    147456      mixed5[0][0]                     
__________________________________________________________________________________________________
conv2d_53 (Conv2D)              (None, 7, 7, 192)    215040      activation_52[0][0]              
__________________________________________________________________________________________________
conv2d_58 (Conv2D)              (None, 7, 7, 192)    215040      activation_57[0][0]              
__________________________________________________________________________________________________
conv2d_59 (Conv2D)              (None, 7, 7, 192)    147456      average_pooling2d_5[0][0]        
__________________________________________________________________________________________________
batch_normalization_50 (BatchNo (None, 7, 7, 192)    576         conv2d_50[0][0]                  
__________________________________________________________________________________________________
batch_normalization_53 (BatchNo (None, 7, 7, 192)    576         conv2d_53[0][0]                  
__________________________________________________________________________________________________
batch_normalization_58 (BatchNo (None, 7, 7, 192)    576         conv2d_58[0][0]                  
__________________________________________________________________________________________________
batch_normalization_59 (BatchNo (None, 7, 7, 192)    576         conv2d_59[0][0]                  
__________________________________________________________________________________________________
activation_50 (Activation)      (None, 7, 7, 192)    0           batch_normalization_50[0][0]     
__________________________________________________________________________________________________
activation_53 (Activation)      (None, 7, 7, 192)    0           batch_normalization_53[0][0]     
__________________________________________________________________________________________________
activation_58 (Activation)      (None, 7, 7, 192)    0           batch_normalization_58[0][0]     
__________________________________________________________________________________________________
activation_59 (Activation)      (None, 7, 7, 192)    0           batch_normalization_59[0][0]     
__________________________________________________________________________________________________
mixed6 (Concatenate)            (None, 7, 7, 768)    0           activation_50[0][0]              
                                                                 activation_53[0][0]              
                                                                 activation_58[0][0]              
                                                                 activation_59[0][0]              
__________________________________________________________________________________________________
conv2d_64 (Conv2D)              (None, 7, 7, 192)    147456      mixed6[0][0]                     
__________________________________________________________________________________________________
batch_normalization_64 (BatchNo (None, 7, 7, 192)    576         conv2d_64[0][0]                  
__________________________________________________________________________________________________
activation_64 (Activation)      (None, 7, 7, 192)    0           batch_normalization_64[0][0]     
__________________________________________________________________________________________________
conv2d_65 (Conv2D)              (None, 7, 7, 192)    258048      activation_64[0][0]              
__________________________________________________________________________________________________
batch_normalization_65 (BatchNo (None, 7, 7, 192)    576         conv2d_65[0][0]                  
__________________________________________________________________________________________________
activation_65 (Activation)      (None, 7, 7, 192)    0           batch_normalization_65[0][0]     
__________________________________________________________________________________________________
conv2d_61 (Conv2D)              (None, 7, 7, 192)    147456      mixed6[0][0]                     
__________________________________________________________________________________________________
conv2d_66 (Conv2D)              (None, 7, 7, 192)    258048      activation_65[0][0]              
__________________________________________________________________________________________________
batch_normalization_61 (BatchNo (None, 7, 7, 192)    576         conv2d_61[0][0]                  
__________________________________________________________________________________________________
batch_normalization_66 (BatchNo (None, 7, 7, 192)    576         conv2d_66[0][0]                  
__________________________________________________________________________________________________
activation_61 (Activation)      (None, 7, 7, 192)    0           batch_normalization_61[0][0]     
__________________________________________________________________________________________________
activation_66 (Activation)      (None, 7, 7, 192)    0           batch_normalization_66[0][0]     
__________________________________________________________________________________________________
conv2d_62 (Conv2D)              (None, 7, 7, 192)    258048      activation_61[0][0]              
__________________________________________________________________________________________________
conv2d_67 (Conv2D)              (None, 7, 7, 192)    258048      activation_66[0][0]              
__________________________________________________________________________________________________
batch_normalization_62 (BatchNo (None, 7, 7, 192)    576         conv2d_62[0][0]                  
__________________________________________________________________________________________________
batch_normalization_67 (BatchNo (None, 7, 7, 192)    576         conv2d_67[0][0]                  
__________________________________________________________________________________________________
activation_62 (Activation)      (None, 7, 7, 192)    0           batch_normalization_62[0][0]     
__________________________________________________________________________________________________
activation_67 (Activation)      (None, 7, 7, 192)    0           batch_normalization_67[0][0]     
__________________________________________________________________________________________________
average_pooling2d_6 (AveragePoo (None, 7, 7, 768)    0           mixed6[0][0]                     
__________________________________________________________________________________________________
conv2d_60 (Conv2D)              (None, 7, 7, 192)    147456      mixed6[0][0]                     
__________________________________________________________________________________________________
conv2d_63 (Conv2D)              (None, 7, 7, 192)    258048      activation_62[0][0]              
__________________________________________________________________________________________________
conv2d_68 (Conv2D)              (None, 7, 7, 192)    258048      activation_67[0][0]              
__________________________________________________________________________________________________
conv2d_69 (Conv2D)              (None, 7, 7, 192)    147456      average_pooling2d_6[0][0]        
__________________________________________________________________________________________________
batch_normalization_60 (BatchNo (None, 7, 7, 192)    576         conv2d_60[0][0]                  
__________________________________________________________________________________________________
batch_normalization_63 (BatchNo (None, 7, 7, 192)    576         conv2d_63[0][0]                  
__________________________________________________________________________________________________
batch_normalization_68 (BatchNo (None, 7, 7, 192)    576         conv2d_68[0][0]                  
__________________________________________________________________________________________________
batch_normalization_69 (BatchNo (None, 7, 7, 192)    576         conv2d_69[0][0]                  
__________________________________________________________________________________________________
activation_60 (Activation)      (None, 7, 7, 192)    0           batch_normalization_60[0][0]     
__________________________________________________________________________________________________
activation_63 (Activation)      (None, 7, 7, 192)    0           batch_normalization_63[0][0]     
__________________________________________________________________________________________________
activation_68 (Activation)      (None, 7, 7, 192)    0           batch_normalization_68[0][0]     
__________________________________________________________________________________________________
activation_69 (Activation)      (None, 7, 7, 192)    0           batch_normalization_69[0][0]     
__________________________________________________________________________________________________
mixed7 (Concatenate)            (None, 7, 7, 768)    0           activation_60[0][0]              
                                                                 activation_63[0][0]              
                                                                 activation_68[0][0]              
                                                                 activation_69[0][0]              
__________________________________________________________________________________________________
flatten (Flatten)               (None, 37632)        0           mixed7[0][0]                     
__________________________________________________________________________________________________
dense (Dense)                   (None, 1024)         38536192    flatten[0][0]                    
__________________________________________________________________________________________________
dropout (Dropout)               (None, 1024)         0           dense[0][0]                      
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 1)            1025        dropout[0][0]                    
==================================================================================================
Total params: 47,512,481
Trainable params: 38,537,217
Non-trainable params: 8,975,264
__________________________________________________________________________________________________
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Get the Horse or Human dataset&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;path_horse_or_human&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;sa&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getcwd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;/../tmp2/horse-or-human.zip&amp;quot;&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Get the Horse or Human Validation dataset&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;path_validation_horse_or_human&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;sa&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getcwd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;/../tmp2/validation-horse-or-human.zip&amp;quot;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tensorflow.keras.preprocessing.image&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ImageDataGenerator&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;os&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;zipfile&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;shutil&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;shutil&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rmtree&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;/tmp&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;local_zip&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;path_horse_or_human&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;zip_ref&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;zipfile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ZipFile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;local_zip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;r&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;zip_ref&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;extractall&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;/tmp/training&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;zip_ref&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;local_zip&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;path_validation_horse_or_human&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;zip_ref&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;zipfile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ZipFile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;local_zip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;r&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;zip_ref&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;extractall&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;/tmp/validation&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;zip_ref&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Define our example directories and files&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;train_dir&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;/tmp/training&amp;#39;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;validation_dir&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;/tmp/validation&amp;#39;&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;train_horses_dir&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_dir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;horses&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;train_humans_dir&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_dir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;humans&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;validation_horses_dir&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;validation_dir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;horses&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;validation_humans_dir&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;validation_dir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;humans&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;train_horses_fnames&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;listdir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_horses_dir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;train_humans_fnames&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;listdir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_humans_dir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;validation_horses_fnames&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;listdir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;validation_horses_dir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;validation_humans_fnames&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;listdir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;validation_humans_dir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_horses_fnames&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_humans_fnames&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;validation_horses_fnames&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;validation_humans_fnames&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Expected Output:&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# 500&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# 527&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# 128&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# 128&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;500
527
128
128
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Add our data-augmentation parameters to ImageDataGenerator&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;train_datagen&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ImageDataGenerator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rescale&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;255.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                   &lt;span class=&quot;n&quot;&gt;rotation_range&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;40&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                   &lt;span class=&quot;n&quot;&gt;width_shift_range&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                   &lt;span class=&quot;n&quot;&gt;height_shift_range&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                   &lt;span class=&quot;n&quot;&gt;shear_range&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                   &lt;span class=&quot;n&quot;&gt;zoom_range&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                   &lt;span class=&quot;n&quot;&gt;horizontal_flip&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Note that the validation data should not be augmented!&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;test_datagen&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ImageDataGenerator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rescale&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;255.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Flow training images in batches of 20 using train_datagen generator&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;train_generator&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train_datagen&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flow_from_directory&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_dir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                                    &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                                    &lt;span class=&quot;n&quot;&gt;class_mode&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;binary&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                                                    &lt;span class=&quot;n&quot;&gt;target_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;150&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;150&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;      

&lt;span class=&quot;c1&quot;&gt;# Flow validation images in batches of 20 using test_datagen generator&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;validation_generator&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;test_datagen&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flow_from_directory&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;validation_dir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                                          &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                                          &lt;span class=&quot;n&quot;&gt;class_mode&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;binary&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                                                          &lt;span class=&quot;n&quot;&gt;target_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;150&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;150&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Expected Output:&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Found 1027 images belonging to 2 classes.&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Found 256 images belonging to 2 classes.&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Found 1027 images belonging to 2 classes.
Found 256 images belonging to 2 classes.
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Run this and see how many epochs it should take before the callback&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# fires, and stops training at 97% accuracy&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;callbacks&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;myCallback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;history&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit_generator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;train_generator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;validation_data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;validation_generator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;steps_per_epoch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;epochs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;validation_steps&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;verbose&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;callbacks&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;myCallback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Epoch 1/3

Reached 97.0% accuracy so cancelling training!
100/100 - 84s - loss: 0.0352 - accuracy: 0.9889 - val_loss: 0.2615 - val_accuracy: 0.9750
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;matplotlib&lt;/span&gt; inline
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;plt&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;acc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;history&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;history&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;accuracy&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;val_acc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;history&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;history&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;val_accuracy&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;history&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;history&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;loss&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;val_loss&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;history&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;history&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;val_loss&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;epochs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;acc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;epochs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;acc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;r&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Training accuracy&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;epochs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;val_acc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;b&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Validation accuracy&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Training and validation accuracy&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;legend&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figure&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;


&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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JBcEHFKlb9X5LjCEJBHNAh7OiWE7cBJwBMlo4G8kr0NF+Rskr/MHEfFcHftu/O8JFLPdJh3SrwHOjIg/NXU81nxJmk5yYnlKU8fSHPmLYLZbSBpDcsXN30kuI/yI5FOwWb2k51NOBfo1dSzNlaeAbHc5BnidZO77ROB0n7Sz+pJ0Pcl3EX4YEX9r6niaK08BmZlllEcAZmYZ1azOAXTt2jV69uzZ1GGYmTUr8+fPXxcRn7r0ulklgJ49e1JaWtrUYZiZNSuSqv1GvKeAzMwyygnAzCyjnADMzDKqWZ0DMLPERx99RFlZGdu2bWvqUOwfSJs2bSgoKKBVq5puJbUjJwCzZqisrIx27drRs2dPkpurWtZFBOvXr6esrIxevXrVvgOeAjJrlrZt20aXLl385m+VJNGlS5c6jQqdAMyaKb/5W1V1/ZtwAjAzyygnADOrs/Xr19O/f3/69+/PfvvtR/fu3SvXP/zww7zauPjii1m2bNlO69x555386le/aoyQrRo+CWxmddalSxcWLlwIwJQpU2jbti1XXXXVDnUqf3h8j+o/Z9577721HuerX/1qw4PdzbZv307Lls3jrdUjADNrNCtXrqSwsJDzzz+fPn36sHbtWi677DJKSkro06cPU6dOrax7zDHHsHDhQrZv307Hjh2ZPHkyxcXFHH300bzzzjsAXHvttdx2222V9SdPnsyQIUM4/PDDee655EfA3n//fc444wwKCws588wzKSkpqUxOub773e8yePBg+vbty1e+8hUq7oS8fPlyRo0aRXFxMQMHDuSNN94A4Ic//CH9+vWjuLiYa665ZoeYAd566y0OOeQQAO655x5OO+00Ro4cyYknnsimTZsYNWoUAwcOpKioiN/+9n9/TO7ee++lqKiI4uJiLr74YjZu3MhBBx3E9u3bAdiwYcMO67tS80hTZlazb3wDqnnDa5D+/SF9462rV199lenTp1NSUgLADTfcQOfOndm+fTsjR47kzDPPpLCwcId9Nm7cyPDhw7nhhhu48sormTZtGpMnT/5U2xHBCy+8wKxZs5g6dSqPP/44P/nJT9hvv/14+OGHWbRoEQMHDqw2rq9//et873vfIyI477zzePzxxxk7dizjx49nypQpnHzyyWzbto1PPvmExx57jNmzZ/PCCy+w11578e6779ba7xdffJGFCxfSqVMnPvro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Mzj77LORRJs2bXjkkUdo374969at46ijjuKUU06p8fdq77rrLvbee2+WLl3K4sWLd7id83XXXUfnzp35+OOPOe6441i8eDFf+9rX+PGPf8zcuXPp2rXrDm3Nnz+fe++9l7/85S9EBEceeSTDhw+nU6dOrFixggceeICf//znnH322Tz88MNccMEFO+x/zDHH8PzzzyOJe+65hxtvvJFbbrmF73//+3To0IGXXnoJSO7ZX15ezqWXXsozzzxDr1698rpl9IoVK7jvvvs46qijauxf7969Oeecc3jwwQcZPHgwmzZtYq+99uLLX/4yv/jFL7jttttYvnw527Zto7i4uNZj7ozvBWRm9ZI7DZQ7/RMRfPvb36aoqIjjjz+e1atX8/bbb9fYzjPPPFP5RlxUVERRUVFl2cyZMxk4cCADBgxgyZIl1d7oLdezzz7L6aefzj777EPbtm0ZN24cf/rTnwDo1asX/fv3B2q+5XRZWRknnngi/fr146abbmLJkiUAPPHEEzv8OlmnTp14/vnnOfbYY+nVqxeQ3y2je/ToUfnmX1P/li1bxv7778/gwYMBaN++PS1btuSss87it7/9LR999BHTpk1jwoQJtR6vNh4BmDVzTXU36FNPPZVvfvObLFiwgK1btzJo0CAgublaeXk58+fPp1WrVvTs2bNet15etWoVN998M/PmzaNTp05MmDChXu1UqLiVNCS3k66402euK664giuvvJJTTjmFp59+milTptT5OLm3jIYdbxude8vouvZv7733ZvTo0fzmN79h5syZjfLtZ48AzKxe2rZty8iRI7nkkkt2OPlbcSvkVq1aMXfuXP7617/utJ1jjz2W+++/H4CXX36ZxYsXA8mtpPfZZx86dOjA22+/zezZsyv3adeuHZs3b/5UW8OGDePRRx9l69atvP/++zzyyCMMGzYs7z5t3LiR7t2T77ned999ldtHjx7NnXfeWbm+YcMGjjrqKJ555hlWrVoF7HjL6AULFgCwYMGCyvKqaurf4Ycfztq1a5k3bx4Amzdvrvztg4kTJ/K1r32NwYMHV/74TEM4AZhZvY0fP55FixbtkADOP/98SktL6devH9OnT6/1x00uv/xytmzZwhFHHMF3vvOdypFEcXExAwYMoHfv3px33nk73Er6sssuY8yYMYwcOXKHtgYOHMiECRMYMmQIRx55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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea &quot;&gt;
&lt;pre&gt;&amp;lt;Figure size 432x288 with 0 Axes&amp;gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;/div&gt;</content><author><name></name></author><summary type="html"></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://rafaelsf80.github.io/notebooks/images/kaggle.png" /><media:content medium="image" url="https://rafaelsf80.github.io/notebooks/images/kaggle.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Redes convolucionales imágenes de lenguaje de signos</title><link href="https://rafaelsf80.github.io/notebooks/tensorflow/2020/08/02/sign-language-multiclass.html" rel="alternate" type="text/html" title="Redes convolucionales imágenes de lenguaje de signos" /><published>2020-08-02T00:00:00-05:00</published><updated>2020-08-02T00:00:00-05:00</updated><id>https://rafaelsf80.github.io/notebooks/tensorflow/2020/08/02/sign-language-multiclass</id><content type="html" xml:base="https://rafaelsf80.github.io/notebooks/tensorflow/2020/08/02/sign-language-multiclass.html">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-08-02-sign-language-multiclass.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Introducci&amp;#243;n&quot;&gt;Introducci&amp;#243;n&lt;a class=&quot;anchor-link&quot; href=&quot;#Introducci&amp;#243;n&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;Se resolverá la competición de Kaggle sobre imágenes de lenguaje de signos (clasificación multiclase), disponible en &lt;a href=&quot;https://www.kaggle.com/datamunge/sign-language-mnist&quot;&gt;este enlace&lt;/a&gt;.&lt;br /&gt;
El dataset de lenguajes de signos surgió como una evolución de MNIST y Fashion MNIST, pero siguiendo la misma filosofía y formato: píxeles 28x28 en blanco y negro, con 26 etiquetas (0-25) correspondiente a letras A-Z (no hay casos para 9=J 25=Z por ser movimientos). El dataset de training contiene 27,455 muestras y el de pruebas 7,172.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;csv&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tensorflow&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tf&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tensorflow.keras.preprocessing.image&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ImageDataGenerator&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;os&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;getcwd&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# You will need to write code that will read the file passed&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;# into this function. The first line contains the column headers&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;# so you should ignore it&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;# Each successive line contians 785 comma separated values between 0 and 255&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;# The first value is the label&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;# The rest are the pixel values for that picture&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;# The function will return 2 np.array types. One with all the labels&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;# One with all the images&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;#&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;# Tips: &lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;# If you read a full line (as &amp;#39;row&amp;#39;) then row[0] has the label&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;# and row[1:785] has the 784 pixel values&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;# Take a look at np.array_split to turn the 784 pixels into 28x28&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;# You are reading in strings, but need the values to be floats&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;# Check out np.array().astype for a conversion&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;get_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# np.array of shape (data length, labels &amp;amp; pixels)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;my_arr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loadtxt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;delimiter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;skiprows&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# get label &amp;amp; image arrays&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;my_arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;astype&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;int&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;images&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;my_arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# reshape image from 784 to (28, 28)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;images&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;images&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;astype&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;float&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reshape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;images&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;28&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;28&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# just in case to avoid memory problem&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;my_arr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;images&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;path_sign_mnist_train&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;sa&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getcwd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;/../tmp2/sign_mnist_train.csv&amp;quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;path_sign_mnist_test&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;sa&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getcwd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;/../tmp2/sign_mnist_test.csv&amp;quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;training_images&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;training_labels&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;get_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path_sign_mnist_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;testing_images&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;testing_labels&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;get_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path_sign_mnist_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;


&lt;span class=&quot;c1&quot;&gt;# Keep these&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;training_images&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;training_labels&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;testing_images&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;testing_labels&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Their output should be:&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# (27455, 28, 28)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# (27455,)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# (7172, 28, 28)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# (7172,)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;(27455, 28, 28)
(27455,)
(7172, 28, 28)
(7172,)
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# In this section you will have to add another dimension to the data&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# So, for example, if your array is (10000, 28, 28)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# You will need to make it (10000, 28, 28, 1)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Hint: np.expand_dims&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;training_images&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;expand_dims&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;training_images&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;testing_images&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;expand_dims&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;testing_images&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Create an ImageDataGenerator and do Image Augmentation&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;train_datagen&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ImageDataGenerator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;rescale&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1.&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;255&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;rotation_range&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;40&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;width_shift_range&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;height_shift_range&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;shear_range&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;zoom_range&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;horizontal_flip&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;fill_mode&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;nearest&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;validation_datagen&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ImageDataGenerator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;rescale&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1.&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;255&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
&lt;span class=&quot;c1&quot;&gt;# Keep These&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;training_images&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;testing_images&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
&lt;span class=&quot;c1&quot;&gt;# Their output should be:&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# (27455, 28, 28, 1)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# (7172, 28, 28, 1)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;(27455, 28, 28, 1)
(7172, 28, 28, 1)
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Define the model&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Use no more than 2 Conv2D and 2 MaxPooling2D&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;models&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Sequential&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Conv2D&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;128&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;activation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;relu&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;input_shape&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;28&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;28&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)),&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;MaxPooling2D&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Conv2D&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;activation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;relu&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;MaxPooling2D&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; 
    &lt;span class=&quot;c1&quot;&gt;# Flatten the results to feed into a DNN&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Flatten&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; 
    &lt;span class=&quot;c1&quot;&gt;# 512 neuron hidden layer&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;512&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;activation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;relu&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; 
    
    &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;25&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;activation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;softmax&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; 
&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Compile Model. &lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;compile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;adam&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
              &lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;categorical_crossentropy&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
              &lt;span class=&quot;n&quot;&gt;metrics&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;accuracy&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Train the Model&lt;/span&gt;


&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tensorflow.keras.utils&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;to_categorical&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;training_labels1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;to_categorical&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;training_labels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;testing_labels1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;to_categorical&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;testing_labels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;


&lt;span class=&quot;n&quot;&gt;train_generator&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train_datagen&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flow&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;training_images&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;training_labels1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                                    &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;500&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; 
&lt;span class=&quot;n&quot;&gt;validation_generator&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;validation_datagen&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flow&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;testing_images&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;testing_labels1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                                    &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;500&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; 

&lt;span class=&quot;n&quot;&gt;history&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit_generator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_generator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                              &lt;span class=&quot;n&quot;&gt;validation_data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;validation_generator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                              &lt;span class=&quot;n&quot;&gt;steps_per_epoch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                              &lt;span class=&quot;n&quot;&gt;epochs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                              &lt;span class=&quot;n&quot;&gt;validation_steps&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;30&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                              &lt;span class=&quot;n&quot;&gt;verbose&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;evaluate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;testing_images&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;testing_labels1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;verbose&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Epoch 1/3
100/100 - 33s - loss: 3.0163 - accuracy: 0.0977 - val_loss: 2.5446 - val_accuracy: 0.2448
Epoch 2/3
100/100 - 31s - loss: 2.5668 - accuracy: 0.2247 - val_loss: 1.9653 - val_accuracy: 0.4085
Epoch 3/3
100/100 - 32s - loss: 2.1926 - accuracy: 0.3254 - val_loss: 1.5454 - val_accuracy: 0.4992
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;[306.7763181091751, 0.18335192]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Plot the chart for accuracy and loss on both training and validation&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;matplotlib&lt;/span&gt; inline
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;plt&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;acc&lt;/span&gt;      &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;history&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;history&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;accuracy&amp;#39;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;val_acc&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;history&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;history&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;val_accuracy&amp;#39;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;history&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;history&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;loss&amp;#39;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;val_loss&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;history&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;history&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;val_loss&amp;#39;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;epochs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;acc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;epochs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;acc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;r&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Training accuracy&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;epochs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;val_acc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;b&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Validation accuracy&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Training and validation accuracy&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;legend&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figure&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;epochs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;r&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Training Loss&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;epochs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;val_loss&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;b&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Validation Loss&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Training and validation loss&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;legend&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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6YczwIEDBzjllFOoUKECe/bsIT4+HoCyZctyxhln8OmnnwKWvPfv30/Hjh0ZNWoUBw4cAEituqlevTrz588HYPz48ZnGtGvXLs4880wKFy7MtGnT2LDBmmHat2/P2LFjU68XWiXUt29f+vTpQ//+/U/qfjiXG3bsgA8+gD594Mwz4aKL4Nln4fTT4ZlnYOlSWLsW/vUvuOyyvJXkIZ9MgZBfNGnShLp161K7dm2qVatGq1atIv4ad999NzfeeCN169ZN/SlTpswxx5QvX56bbrqJunXrUrFiRVq0aJG67/333+e2227j4YcfpmjRosTHx6fWp8fFxVGkSBG6du3K448/zl/+8heuueYahg8fnlrVlJEbbriBrl270qBBA5o3b06tWrUAq1r661//SuvWrSlcuDBNmzblzTffBKBPnz4MHTqUa665JuL3yLmTpQpLlqSV2r/91rpEVqhgJfYuXeDSS6Fs2ayvlRfkuTVj4+LiNP3CI8uXL6dOnTpRiihvSUpKIikpiWLFirFq1SouvfRSVq1ale8aM8eMGcPUqVPD6nZ6PP7ZcJGyfz/MmJGW3NcHI4AaN05L7s2aQaFC0Y0zMyIyX1XjMtqXv7KDY+/evXTo0IGkpCRUlddffz3fJfk77riD6dOnM2XKlGiH4gq4devSEvvMmdZr5rTToGNHG8x0+eU2mCm/y18ZwnH66aen1pvnV8OHD492CK6AOnLEqmFSkntKE9c558DAgXDFFdC6NQT9IGKGJ3rnXEzbuhWmTLHEPnWqjVAtXNgS+i23WJXMuefm3GClvMATvXMupqjamMqUUvt339m2P/wBevSwxN6xI5QuHe1Ic48neudcvrd3L0yfbon9889h40bb3qwZPPqoJfcmTWxumYLIE71zLl9avTqt1P7f/8Lhw1CqlHV7vOIK68/+hz9EO8q8oYD+fcuedu3a/W7w00svvcQdd9xx3PNKliwJwMaNG+ndu3eGx7Rt25b03UnTe+mll9i/f3/q88svv5zffvstnNCdixmHD1v3xz//GWrXhlq1bOqrX36BQYNs+oFt22D8eOjXz5N8KE/0YbjuuusYM2bMMdvGjBnDddddF9b5Z5999nFHlmYlfaL//PPPOf3000/4erlNVVOnUnAuO3791eZo793bBit16GCjT6tVg5dftlL9jz/CCy9A+/YQMruIC+GJPgy9e/dm0qRJqYuMrFu3jo0bN3LxxRen9mtv0qQJDRo04JNPPvnd+evWraN+/fqATU9w7bXXUqdOHXr06JE67QBY//KUKY4fffRRAF555RU2btxIu3btaNeuHWBTE2zbtg2AF198kfr161O/fv3UKY7XrVtHnTp1uPXWW6lXrx6XXnrpMa+T4tNPP6VFixY0btyYSy65hM2bNwPWV79///40aNCAhg0bpk6hMGXKFJo0aUKjRo3o0KEDYPPzP//886nXrF+/PuvWrWPdunWcd9553HjjjdSvX5/169dn+P4A5s2bx4UXXkijRo1o3rw5e/bsoXXr1sdMv3zRRRfxww8/ZOv35vKfo0dh3jwYMsTq1ytWhJtvhv/9D669FiZMgO3brffMPfdYt0iXtXxXRx+NWYrLlStH8+bNmTx5Mt27d2fMmDFcffXViAjFihXj448/pnTp0mzbto2WLVvSrVu3TNczHT58OCVKlGD58uUsWrTomGmGn3zyScqVK0dycjIdOnRg0aJF3HPPPbz44ovMnDmTChUqHHOt+fPn89Zbb/Hdd9+hqrRo0YI2bdpQtmxZVq1axejRo3njjTe4+uqriY+Pp2/fvsecf9FFFzFnzhxEhJEjR/Lss8/ywgsv8Pjjj1OmTBkWL14M2JzxW7du5dZbb2X27NnUqFEjrKmMV61axdtvv03Lli0zfX+1a9fmmmuuYezYsTRr1ozdu3dTvHhxbrnlFv7zn//w0ksvsXLlSg4ePEijRo2yfE2X/+zefeyCHJs3W1fHli3hiSesITUn52ovCPJdoo+WlOqblESfMmeLqvLQQw8xe/ZsTjnlFDZs2MDmzZs566yzMrzO7NmzueeeewBo2LAhDUOWlBk3bhwjRowgKSmJTZs2sWzZsmP2p/f111/To0eP1Jkke/bsyVdffUW3bt2oUaMG559/PnDsNMehEhMTueaaa9i0aROHDx+mRo0agE1bHFpVVbZsWT799FNat26dekw4UxlXq1YtNcln9v5EhIoVK9KsWTMASgd93q666ioef/xxnnvuOUaNGkW/fv2yfD2XP6jCypWW2D/7DL76CpKSbIKwTp0ssXfubAt1uMjId4k+WrMUd+/enT/96U8sWLCA/fv307SpLaL1/vvvs3XrVubPn0+RIkWoXr36CU0J/NNPP/H8888zb948ypYtS79+/U7o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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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B+bNg6pVdfTMzTfrRVVjQsSP6rldu3blnnvuYe3atRw7dozmzZsDMGPGDBITE1mzZg0RERFER0enWjI3Izt37mTMmDF89dVXlC5dmv79+5/VfpIkld4FLb+bmS6X1Jx//vmsXbuWDz/8kBEjRtChQwceffRRVq9ezSeffMKcOXOYMGECn376aZaOA9ZC98f558Mzz0BCArz9tj5+9FFN7FdfDR98YK12k2sUK1aM9u3bc/PNN//lYuihQ4c455xziIiIYOnSpXz33Xfp7ueSSy5h5syZAGzatIkNGzYAWnq3aNGilCxZkn379p1eKQigePHiHD58+G/7atOmDe+99x7Hjh3j6NGjzJs3jzZt2mTp50xrn3v27KFIkSL07duX+++/n7Vr13LkyBEOHTpEly5deO6551i/fn2Wjp3EWuh+KlgQevbU27ffasmBqVPh/ff1Quott2irvWpVvyM1Jkv69OlDt27d/jLi5YYbbuCqq66iYcOGxMTEUKdOnXT3cccddzBgwADq1q1L3bp1T7f0GzduTNOmTalTpw5VqlT5S+ndgQMH0qlTJ6Kioli6dOnp55s1a0b//v258MILAbj11ltp2rRpwN0rAE8++eTpC58ACQkJqe7zo48+4v777ydfvnxEREQwadIkDh8+TNeuXfn9999xzjF27NiAj5uevFs+N1z9+ae20CdP1gWwATp31gupV1wBXo1mYwJl5XNzLiufm9NFREC3bjqWPT4eRozQYQnduukF1REjYOdOv6M0xoQhS+jhLDoaRo2C776D+fO1psy//w01akDHjjB3rrbojTGGABK6iFQRkaUiskVENovI3alsU1JE3heR9d42A0ITbh5VoIBeLH3/fdi1Cx57TMe39+ihfe3DhsGOHX5HacKYX12r5uydze8skBb6CWCoc64ecBEwWETqpdhmMLDFOdcYaAf8R0QKYoKvShVN6Dt3wsKF0LIljBkDtWpBhw66nN7x435HacJIZGQkBw4csKSegzjnOHDgAJGRkZl6XyCLRO8F9nr3D4tIHFAJSD5y3wHFRad4FQN+Rv8QmFDJnx+6dNHbnj3w2ms6I7V3byhXDm66SS+k1q7td6TGZ5UrVyYhIYHExES/QzGZEBkZSeXKlTP1nkyNchGRaGAZ0MA592uy54sDC4A6QHHgOufcwlTePxAYCFC1atXmGY07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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;/div&gt;</content><author><name></name></author><summary type="html"></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://rafaelsf80.github.io/notebooks/images/kaggle.png" /><media:content medium="image" url="https://rafaelsf80.github.io/notebooks/images/kaggle.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Redes convolucionales Cats-Dogs</title><link href="https://rafaelsf80.github.io/notebooks/tensorflow/2020/08/02/cats-dogs-augmentation.html" rel="alternate" type="text/html" title="Redes convolucionales Cats-Dogs" /><published>2020-08-02T00:00:00-05:00</published><updated>2020-08-02T00:00:00-05:00</updated><id>https://rafaelsf80.github.io/notebooks/tensorflow/2020/08/02/cats-dogs-augmentation</id><content type="html" xml:base="https://rafaelsf80.github.io/notebooks/tensorflow/2020/08/02/cats-dogs-augmentation.html">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-08-02-cats-dogs-augmentation.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Introducci&amp;#243;n&quot;&gt;Introducci&amp;#243;n&lt;a class=&quot;anchor-link&quot; href=&quot;#Introducci&amp;#243;n&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;Se va a resolver la competición de Kaggle expuesta &lt;a href=&quot;https://www.kaggle.com/c/dogs-vs-cats/data&quot;&gt;aqui&lt;/a&gt;.
Se usarán 25,000&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# ATTENTION: Please do not alter any of the provided code in the exercise. Only add your own code where indicated&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# ATTENTION: Please do not add or remove any cells in the exercise. The grader will check specific cells based on the cell position.&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# ATTENTION: Please use the provided epoch values when training.&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# In this exercise you will train a CNN on the FULL Cats-v-dogs dataset&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# This will require you doing a lot of data preprocessing because&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# the dataset isn&amp;#39;t split into training and validation for you&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# This code block has all the required inputs&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;os&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;zipfile&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;random&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;shutil&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tensorflow&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tf&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tensorflow.keras.optimizers&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;RMSprop&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tensorflow.keras.preprocessing.image&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ImageDataGenerator&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;shutil&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;copyfile&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;os&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;getcwd&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# This code block unzips the full Cats-v-Dogs dataset to /tmp&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# which will create a tmp/PetImages directory containing subdirectories&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# called &amp;#39;Cat&amp;#39; and &amp;#39;Dog&amp;#39; (that&amp;#39;s how the original researchers structured it)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;path_cats_and_dogs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;sa&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getcwd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;/../tmp2/cats-and-dogs.zip&amp;quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;shutil&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rmtree&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;/tmp&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;local_zip&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;path_cats_and_dogs&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;zip_ref&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;zipfile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ZipFile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;local_zip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;r&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;zip_ref&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;extractall&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;/tmp&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;zip_ref&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;listdir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;/tmp/PetImages/Cat/&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;listdir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;/tmp/PetImages/Dog/&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Expected Output:&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# 1500&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# 1500&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;1500
1500
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Use os.mkdir to create your directories&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# You will need a directory for cats-v-dogs, and subdirectories for training&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# and testing. These in turn will need subdirectories for &amp;#39;cats&amp;#39; and &amp;#39;dogs&amp;#39;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;chdir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;/tmp&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mkdir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;cats-v-dogs&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mkdir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;cats-v-dogs/training&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mkdir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;cats-v-dogs/testing&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mkdir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;cats-v-dogs/training/dogs&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mkdir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;cats-v-dogs/training/cats&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mkdir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;cats-v-dogs/testing/dogs&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mkdir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;cats-v-dogs/testing/cats&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;except&lt;/span&gt; &lt;span class=&quot;ne&quot;&gt;OSError&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;pass&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Write a python function called split_data which takes&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# a SOURCE directory containing the files&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# a TRAINING directory that a portion of the files will be copied to&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# a TESTING directory that a portion of the files will be copie to&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# a SPLIT SIZE to determine the portion&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# The files should also be randomized, so that the training set is a random&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# X% of the files, and the test set is the remaining files&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# SO, for example, if SOURCE is PetImages/Cat, and SPLIT SIZE is .9&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Then 90% of the images in PetImages/Cat will be copied to the TRAINING dir&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# and 10% of the images will be copied to the TESTING dir&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Also -- All images should be checked, and if they have a zero file length,&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# they will not be copied over&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# os.listdir(DIRECTORY) gives you a listing of the contents of that directory&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# os.path.getsize(PATH) gives you the size of the file&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# copyfile(source, destination) copies a file from source to destination&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# random.sample(list, len(list)) shuffles a list&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;split_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SOURCE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TRAINING&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TESTING&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SPLIT_SIZE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# YOUR CODE STARTS HERE&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;lista_ficheros&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;listdir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SOURCE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sample&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lista_ficheros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lista_ficheros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;lista_ficheros_training&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lista_ficheros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;round&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SPLIT_SIZE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lista_ficheros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;lista_ficheros_testing&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lista_ficheros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;round&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SPLIT_SIZE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lista_ficheros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)):]&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fichero&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lista_ficheros_training&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getsize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SOURCE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fichero&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;copyfile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SOURCE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fichero&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TRAINING&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fichero&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fichero&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lista_ficheros_testing&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getsize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SOURCE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fichero&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;copyfile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SOURCE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fichero&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TESTING&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fichero&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# YOUR CODE ENDS HERE&lt;/span&gt;


&lt;span class=&quot;n&quot;&gt;CAT_SOURCE_DIR&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;/tmp/PetImages/Cat/&amp;quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;TRAINING_CATS_DIR&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;/tmp/cats-v-dogs/training/cats/&amp;quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;TESTING_CATS_DIR&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;/tmp/cats-v-dogs/testing/cats/&amp;quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;DOG_SOURCE_DIR&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;/tmp/PetImages/Dog/&amp;quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;TRAINING_DOGS_DIR&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;/tmp/cats-v-dogs/training/dogs/&amp;quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;TESTING_DOGS_DIR&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;/tmp/cats-v-dogs/testing/dogs/&amp;quot;&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;split_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;split_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;CAT_SOURCE_DIR&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TRAINING_CATS_DIR&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TESTING_CATS_DIR&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;split_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;split_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DOG_SOURCE_DIR&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TRAINING_DOGS_DIR&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TESTING_DOGS_DIR&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;split_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;listdir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;/tmp/cats-v-dogs/training/cats/&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;listdir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;/tmp/cats-v-dogs/training/dogs/&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;listdir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;/tmp/cats-v-dogs/testing/cats/&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;listdir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;/tmp/cats-v-dogs/testing/dogs/&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Expected output:&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# 1350&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# 1350&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# 150&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# 150&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;1350
1350
150
150
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# DEFINE A KERAS MODEL TO CLASSIFY CATS V DOGS&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# USE AT LEAST 3 CONVOLUTION LAYERS&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;models&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Sequential&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Conv2D&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;activation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;relu&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;input_shape&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;150&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;150&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)),&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;MaxPooling2D&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Conv2D&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;activation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;relu&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;MaxPooling2D&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; 
    &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Conv2D&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;activation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;relu&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; 
    &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;MaxPooling2D&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Flatten the results to feed into a DNN&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Flatten&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; 
    &lt;span class=&quot;c1&quot;&gt;# 512 neuron hidden layer&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;512&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;activation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;relu&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; 
    &lt;span class=&quot;c1&quot;&gt;# Only 1 output neuron. It will contain a value from 0-1 where 0 for 1 class (&amp;#39;cats&amp;#39;) and 1 for the other (&amp;#39;dogs&amp;#39;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;activation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;sigmoid&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; 
&lt;span class=&quot;c1&quot;&gt;# YOUR CODE HERE&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;compile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;RMSprop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.001&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;binary_crossentropy&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;metrics&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;acc&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;NOTE:&quot;&gt;NOTE:&lt;a class=&quot;anchor-link&quot; href=&quot;#NOTE:&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;In the cell below you &lt;strong&gt;MUST&lt;/strong&gt; use a batch size of 10 (&lt;code&gt;batch_size=10&lt;/code&gt;) for the &lt;code&gt;train_generator&lt;/code&gt; and the &lt;code&gt;validation_generator&lt;/code&gt;. Using a batch size greater than 10 will exceed memory limits on the Coursera platform.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TRAINING_DIR&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;/tmp/cats-v-dogs/training/&amp;#39;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;train_datagen&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ImageDataGenerator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;rescale&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1.&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;255&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;rotation_range&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;width_shift_range&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;height_shift_range&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;shear_range&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;zoom_range&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;horizontal_flip&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;fill_mode&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;nearest&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# NOTE: YOU MUST USE A BATCH SIZE OF 10 (batch_size=10) FOR THE &lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# TRAIN GENERATOR.&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;train_generator&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train_datagen&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flow_from_directory&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TRAINING_DIR&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                                    &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                                    &lt;span class=&quot;n&quot;&gt;class_mode&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;binary&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                                    &lt;span class=&quot;n&quot;&gt;target_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;150&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;150&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; 

&lt;span class=&quot;n&quot;&gt;VALIDATION_DIR&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;/tmp/cats-v-dogs/testing/&amp;#39;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;validation_datagen&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ImageDataGenerator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rescale&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;255.&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# NOTE: YOU MUST USE A BACTH SIZE OF 10 (batch_size=10) FOR THE &lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# VALIDATION GENERATOR.&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;validation_generator&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;validation_datagen&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flow_from_directory&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;VALIDATION_DIR&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                                         &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                                         &lt;span class=&quot;n&quot;&gt;class_mode&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;binary&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                                         &lt;span class=&quot;n&quot;&gt;target_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;150&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;150&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;


&lt;span class=&quot;c1&quot;&gt;# Expected Output:&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Found 2700 images belonging to 2 classes.&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Found 300 images belonging to 2 classes.&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Found 2700 images belonging to 2 classes.
Found 300 images belonging to 2 classes.
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;history&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit_generator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_generator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                              &lt;span class=&quot;n&quot;&gt;epochs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                              &lt;span class=&quot;n&quot;&gt;verbose&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                              &lt;span class=&quot;n&quot;&gt;validation_data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;validation_generator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Epoch 1/2
270/270 [==============================] - 66s 243ms/step - loss: 0.6589 - acc: 0.6241 - val_loss: 0.5918 - val_acc: 0.6767
Epoch 2/2
270/270 [==============================] - 61s 226ms/step - loss: 0.6444 - acc: 0.6400 - val_loss: 0.6259 - val_acc: 0.6567
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# PLOT LOSS AND ACCURACY&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;matplotlib&lt;/span&gt; inline

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib.image&lt;/span&gt;  &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;mpimg&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;plt&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;#-----------------------------------------------------------&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Retrieve a list of list results on training and test data&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# sets for each training epoch&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#-----------------------------------------------------------&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;acc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;history&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;history&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;acc&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;val_acc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;history&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;history&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;val_acc&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;history&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;history&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;loss&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;val_loss&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;history&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;history&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;val_loss&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;epochs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;acc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# Get number of epochs&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;#------------------------------------------------&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Plot training and validation accuracy per epoch&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#------------------------------------------------&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;epochs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;acc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;r&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;Training Accuracy&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;epochs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;val_acc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;b&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;Validation Accuracy&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Training and validation accuracy&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figure&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;#------------------------------------------------&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Plot training and validation loss per epoch&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#------------------------------------------------&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;epochs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;r&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;Training Loss&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;epochs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;val_loss&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;b&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;Validation Loss&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;


&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Training and validation loss&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Desired output. Charts with training and validation metrics. No crash :)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;Text(0.5, 1.0, &amp;#39;Training and validation loss&amp;#39;)&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;/div&gt;</content><author><name></name></author><summary type="html"></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://rafaelsf80.github.io/notebooks/images/kaggle.png" /><media:content medium="image" url="https://rafaelsf80.github.io/notebooks/images/kaggle.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Redes convolucionales imágenes de perros y gatos. Data augmentation</title><link href="https://rafaelsf80.github.io/notebooks/tensorflow/2020/08/02/cats-dogs-25k.html" rel="alternate" type="text/html" title="Redes convolucionales imágenes de perros y gatos. Data augmentation" /><published>2020-08-02T00:00:00-05:00</published><updated>2020-08-02T00:00:00-05:00</updated><id>https://rafaelsf80.github.io/notebooks/tensorflow/2020/08/02/cats-dogs-25k</id><content type="html" xml:base="https://rafaelsf80.github.io/notebooks/tensorflow/2020/08/02/cats-dogs-25k.html">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-08-02-cats-dogs-25k.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Introducción&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Se&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;va&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;resolver&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;la&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;competición&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;de&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Kaggle&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;expuesta&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;aqui&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Se&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;usarán&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;25&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;000&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# ATTENTION: Please do not alter any of the provided code in the exercise. Only add your own code where indicated&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# ATTENTION: Please do not add or remove any cells in the exercise. The grader will check specific cells based on the cell position.&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# ATTENTION: Please use the provided epoch values when training.&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# In this exercise you will train a CNN on the FULL Cats-v-dogs dataset&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# This will require you doing a lot of data preprocessing because&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# the dataset isn&amp;#39;t split into training and validation for you&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# This code block has all the required inputs&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;os&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;zipfile&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;random&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tensorflow&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tf&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;shutil&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tensorflow.keras.optimizers&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;RMSprop&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tensorflow.keras.preprocessing.image&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ImageDataGenerator&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;shutil&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;copyfile&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;os&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;getcwd&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path_cats_and_dogs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;sa&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getcwd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;/../tmp2/cats-and-dogs.zip&amp;quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;shutil&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rmtree&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;/tmp&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;local_zip&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;path_cats_and_dogs&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;zip_ref&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;zipfile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ZipFile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;local_zip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;r&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;zip_ref&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;extractall&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;/tmp&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;zip_ref&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;listdir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;/tmp/PetImages/Cat/&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;listdir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;/tmp/PetImages/Dog/&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Expected Output:&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# 1500&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# 1500&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;1500
1500
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Use os.mkdir to create your directories&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# You will need a directory for cats-v-dogs, and subdirectories for training&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# and testing. These in turn will need subdirectories for &amp;#39;cats&amp;#39; and &amp;#39;dogs&amp;#39;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;chdir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;/tmp&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mkdir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;cats-v-dogs&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mkdir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;cats-v-dogs/training&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mkdir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;cats-v-dogs/testing&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mkdir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;cats-v-dogs/training/dogs&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mkdir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;cats-v-dogs/training/cats&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mkdir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;cats-v-dogs/testing/dogs&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mkdir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;cats-v-dogs/testing/cats&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;except&lt;/span&gt; &lt;span class=&quot;ne&quot;&gt;OSError&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;pass&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Write a python function called split_data which takes&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# a SOURCE directory containing the files&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# a TRAINING directory that a portion of the files will be copied to&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# a TESTING directory that a portion of the files will be copie to&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# a SPLIT SIZE to determine the portion&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# The files should also be randomized, so that the training set is a random&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# X% of the files, and the test set is the remaining files&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# SO, for example, if SOURCE is PetImages/Cat, and SPLIT SIZE is .9&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Then 90% of the images in PetImages/Cat will be copied to the TRAINING dir&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# and 10% of the images will be copied to the TESTING dir&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Also -- All images should be checked, and if they have a zero file length,&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# they will not be copied over&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# os.listdir(DIRECTORY) gives you a listing of the contents of that directory&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# os.path.getsize(PATH) gives you the size of the file&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# copyfile(source, destination) copies a file from source to destination&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# random.sample(list, len(list)) shuffles a list&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;split_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SOURCE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TRAINING&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TESTING&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SPLIT_SIZE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# YOUR CODE STARTS HERE&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;lista_ficheros&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;listdir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SOURCE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sample&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lista_ficheros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lista_ficheros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;lista_ficheros_training&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lista_ficheros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;round&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SPLIT_SIZE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lista_ficheros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;lista_ficheros_testing&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lista_ficheros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;round&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SPLIT_SIZE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lista_ficheros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)):]&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fichero&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lista_ficheros_training&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getsize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SOURCE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fichero&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;copyfile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SOURCE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fichero&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TRAINING&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fichero&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fichero&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lista_ficheros_testing&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getsize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SOURCE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fichero&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;copyfile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SOURCE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fichero&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TESTING&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fichero&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# YOUR CODE ENDS HERE&lt;/span&gt;


&lt;span class=&quot;n&quot;&gt;CAT_SOURCE_DIR&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;/tmp/PetImages/Cat/&amp;quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;TRAINING_CATS_DIR&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;/tmp/cats-v-dogs/training/cats/&amp;quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;TESTING_CATS_DIR&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;/tmp/cats-v-dogs/testing/cats/&amp;quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;DOG_SOURCE_DIR&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;/tmp/PetImages/Dog/&amp;quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;TRAINING_DOGS_DIR&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;/tmp/cats-v-dogs/training/dogs/&amp;quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;TESTING_DOGS_DIR&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;/tmp/cats-v-dogs/testing/dogs/&amp;quot;&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;split_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;split_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;CAT_SOURCE_DIR&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TRAINING_CATS_DIR&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TESTING_CATS_DIR&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;split_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;split_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DOG_SOURCE_DIR&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TRAINING_DOGS_DIR&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TESTING_DOGS_DIR&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;split_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;listdir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;/tmp/cats-v-dogs/training/cats/&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;listdir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;/tmp/cats-v-dogs/training/dogs/&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;listdir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;/tmp/cats-v-dogs/testing/cats/&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;listdir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;/tmp/cats-v-dogs/testing/dogs/&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Expected output:&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# 1350&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# 1350&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# 150&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# 150&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;1350
1350
150
150
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# DEFINE A KERAS MODEL TO CLASSIFY CATS V DOGS&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# USE AT LEAST 3 CONVOLUTION LAYERS&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;models&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Sequential&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Conv2D&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;activation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;relu&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;input_shape&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;150&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;150&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)),&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;MaxPooling2D&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Conv2D&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;activation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;relu&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;MaxPooling2D&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; 
    &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Conv2D&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;activation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;relu&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; 
    &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;MaxPooling2D&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Flatten the results to feed into a DNN&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Flatten&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; 
    &lt;span class=&quot;c1&quot;&gt;# 512 neuron hidden layer&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;512&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;activation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;relu&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; 
    &lt;span class=&quot;c1&quot;&gt;# Only 1 output neuron. It will contain a value from 0-1 where 0 for 1 class (&amp;#39;cats&amp;#39;) and 1 for the other (&amp;#39;dogs&amp;#39;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;activation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;sigmoid&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;compile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;RMSprop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.001&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;binary_crossentropy&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;metrics&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;acc&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;NOTE:&quot;&gt;NOTE:&lt;a class=&quot;anchor-link&quot; href=&quot;#NOTE:&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;In the cell below you &lt;strong&gt;MUST&lt;/strong&gt; use a batch size of 10 (&lt;code&gt;batch_size=10&lt;/code&gt;) for the &lt;code&gt;train_generator&lt;/code&gt; and the &lt;code&gt;validation_generator&lt;/code&gt;. Using a batch size greater than 10 will exceed memory limits on the Coursera platform.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TRAINING_DIR&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;/tmp/cats-v-dogs/training/&amp;#39;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;train_datagen&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ImageDataGenerator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rescale&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;255.&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# NOTE: YOU MUST USE A BATCH SIZE OF 10 (batch_size=10) FOR THE &lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# TRAIN GENERATOR.&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;train_generator&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train_datagen&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flow_from_directory&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TRAINING_DIR&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                                    &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                                    &lt;span class=&quot;n&quot;&gt;class_mode&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;binary&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                                    &lt;span class=&quot;n&quot;&gt;target_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;150&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;150&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; 

&lt;span class=&quot;n&quot;&gt;VALIDATION_DIR&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;/tmp/cats-v-dogs/testing/&amp;#39;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;validation_datagen&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ImageDataGenerator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rescale&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;255.&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# NOTE: YOU MUST USE A BACTH SIZE OF 10 (batch_size=10) FOR THE &lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# VALIDATION GENERATOR.&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;validation_generator&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;validation_datagen&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flow_from_directory&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;VALIDATION_DIR&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                                         &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                                         &lt;span class=&quot;n&quot;&gt;class_mode&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;binary&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                                         &lt;span class=&quot;n&quot;&gt;target_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;150&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;150&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;



&lt;span class=&quot;c1&quot;&gt;# Expected Output:&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Found 2700 images belonging to 2 classes.&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Found 300 images belonging to 2 classes.&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Found 2700 images belonging to 2 classes.
Found 300 images belonging to 2 classes.
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;history&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit_generator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_generator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                              &lt;span class=&quot;n&quot;&gt;epochs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                              &lt;span class=&quot;n&quot;&gt;verbose&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                              &lt;span class=&quot;n&quot;&gt;validation_data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;validation_generator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Epoch 1/2
270/270 [==============================] - 41s 150ms/step - loss: 0.5252 - acc: 0.7322 - val_loss: 0.6337 - val_acc: 0.6700
Epoch 2/2
270/270 [==============================] - 40s 149ms/step - loss: 0.4512 - acc: 0.7930 - val_loss: 0.5766 - val_acc: 0.7333
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# PLOT LOSS AND ACCURACY&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;matplotlib&lt;/span&gt; inline

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib.image&lt;/span&gt;  &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;mpimg&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;plt&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;#-----------------------------------------------------------&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Retrieve a list of list results on training and test data&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# sets for each training epoch&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#-----------------------------------------------------------&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;acc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;history&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;history&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;acc&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;val_acc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;history&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;history&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;val_acc&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;history&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;history&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;loss&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;val_loss&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;history&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;history&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;val_loss&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;epochs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;acc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# Get number of epochs&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;#------------------------------------------------&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Plot training and validation accuracy per epoch&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#------------------------------------------------&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;epochs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;acc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;r&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;Training Accuracy&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;epochs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;val_acc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;b&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;Validation Accuracy&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Training and validation accuracy&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figure&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;#------------------------------------------------&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Plot training and validation loss per epoch&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#------------------------------------------------&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;epochs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;r&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;Training Loss&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;epochs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;val_loss&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;b&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;Validation Loss&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;


&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Training and validation loss&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Desired output. Charts with training and validation metrics. No crash :)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;Text(0.5, 1.0, &amp;#39;Training and validation loss&amp;#39;)&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAccAAAEICAYAAAAqQj/TAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4xLjEsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy8QZhcZAAAaV0lEQVR4nO3debgkVZ3m8e8LxVKsJRSyKZYLLrTiVmPjQre2jCIq6Egj4IYtarvTLqPjStuuj479tLaD0owriiKKMtquiKIoaoGA4NYuqKioyCoFKMVv/ohISI837827c+t+P8+Tz42MOBlxTmTVfe85cTIjVYUkSbrJJotdAUmSbm4MR0mSGoajJEkNw1GSpIbhKElSw3CUJKlhOEpjSLJpkj8k2WMuyy6mJHdIMuef5UqyX5ILh57/IMm+45SdwbGOS/LSmb5eGmXFYldAmg9J/jD0dCvgOmBD//zpVfWB6eyvqjYA28x12eWgqu40F/tJciTw+Kp64NC+j5yLfUstw1Ebpaq6MZz6nsmRVfWFUeWTrKiq6xeibtJU/Pe4+BxW1bKU5DVJPpzkhCRXAY9Pct8kZya5PMmvk7w1yWZ9+RVJKsma/vnx/fZPJ7kqydeT3Ha6ZfvtD0vywyRXJHlbkjOSHDGi3uPU8elJfpTksiRvHXrtpkn+Ncnvk/wE2H+S8/OyJB9q1r09yVv65SOTfK9vz4/7Xt2ofV2U5IH98lZJ3t/X7QLg3k3Zlyf5Sb/fC5Ic2K+/G/DvwL79kPUlQ+f26KHX/2Pf9t8n+XiSXcc5N9M5z4P6JPlCkkuTXJzkfw4d5xX9Obkyyboku000hJ3kq4P3uT+fp/fHuRR4eZI9k5zWH+OS/rxtP/T62/Rt/F2//d+SbNnX+S5D5XZNsj7JjqPaq79kOGo5ezTwQWB74MPA9cDzgNXA/enC4+mTvP5w4BXADsDPgX+ZbtkktwROBF7UH/enwH0m2c84dTyALnTuSRf6+/XrnwE8BLg78N+AQyY5zgnAI5Js3ddzBfD3dOcL4DfAw4HtgKcCb0uy9yT7G3g1cGvgdn09n9Rs/2Hfru2B1wIfTLJzVX0HeDbwlarapqpWtztO8pB+/wcDuwO/Atrh81HnpjXyPPcB9QXg/wG7AncEvtS/7kX98fcHVgFHAtdOdkKG3A/4HrAT8EYgwGuAXYC96M7ZK/o6rAA+BfwIWEN3Tk+sqmvp/j09fmi/hwOfrarfj1kPAVSVDx8b9QO4ENivWfca4ItTvO6FwEf65RVAAWv658cD7xgqeyBw/gzK/gPdL/zBtgC/Bo4Ys20T1XGfoe0fA17YL59ON7w82HZA9ytg5L7PBA7vlx8G/GCSsp8EntUv7wdcOLTtIuCB/fLPh98L4JnDZSfY7/nAw/vlI4EvNduPB47ul98LvG5o23Z015lvNdW5meZ5fgLwrRHlfjyob7P+Du25Br46eJ/7tv1kijocPDgusC9wMbDpBOXuT/dHVvrn5wD/Y67/X23sD3uOWs5+MfwkyZ2TfKofJruSrhfyFz2UIRcPLa9n8kk4o8ruNlyP6n6bXTRqJ2PWcaxjAT+bpL7Q9RIP65cP56ZeI0kekeQb/ZDf5XQ90snO1cCuk9UhyRFJzu2HBi8H7jzmfqFr3437q6orgcvoepEDY71nU5znW9OF4EQm2zaV9t/jLklOTPLLvg7vaepwYXWTv/5MVZ1B1/N9QJK7AnvQ9TI1DYajlrP2YwzvpOup3KGqtgNeSdeTm0+/puvZAJAk/Pkv89Zs6vhrul+qA1N91OREYL8kuwMH0YdjkpXAScDrgZ2rahXwuTHrcfGoOiS5HXAM3fDvjv1+vz+036k+dvIr4DZD+9sWuAXwyzHq1ZrsPP8CuP2I143adnVfp62G1u3SlGnb90a6WdZ36+twRFOH2yTZdEQ93kc3tPoEuuHW60aU0wiGo3STbYErgKv7CQ2TXW+cK58E7pXkkf11pOfRXXOajzqeCByVZPd+csaLJytcVRfTDf29h25I9b/6TVsAmwO/AzYkeQTw4GnU4aVJVqX7HOizh7ZtQxcQv6P7O+GpdD3Hgd8AtxqeGNM4AXhKkr2TbEEX3l+pqpE98UlMdp5PAfZI8uwkWyTZLsngOvFxwGuS3D6deyTZge6PgovprnNumuRpDAX5JHW4Grgiya3phnYHvg78HnhduklOK5Pcf2j7++mGYQ+nC0pNk+Eo3eQFdBNErqLrOXx4vg9YVb8BHgu8he6X3e2Bb9P1GOa6jscApwLfAb5F1/ubygfpriHeOKRaVZcD/wScDFxK90v4k2PW4VV0PdgLgU8z9Iu7qs4D3gZ8sy9zJ+AbQ6/9PPBfwG+SDA+PDl7/Gbrhz5P71+8BPG7MerVGnuequgL478Bj6AL7h8Df9pvfBHyc7jxfCRwLbNkPlz8VeClwCd01yOG2TeRVdJOzrqAL5I8O1eF64BHAXeh6kT+nex8G2y+ke5+vq6qvTbPt4qYLtpJuBvphsl8BB1fVVxa7Plq6kryPbpLP0Ytdl6XILwGQFlmS/elmhl4D/C/gT3S9J2lG+uu3BwF3W+y6LFUOq0qL7wHAT+iutT0UeLQTKDRTSV4PnEv3sZafL3Z9liqHVSVJathzlCSp4TXHjcTq1atrzZo1i10NSVoyzjrrrEuqasKPThmOG4k1a9awbt26xa6GJC0ZSUZ+S5TDqpIkNQxHSZIahqMkSQ3DUZKkhuEoSVJj0nBMclqShzbrjkpyzBSv+0P/c7ckE365cZIvJVk7xX6OGr7FS5L/TLJqstdMR5JzknxorvYnSdo4TNVzPAE4tFl3aL9+SlX1q6o6eOqSIx0F3BiOVXVAf0eAWetvQ7MpsG+SredinyOO48dlJGmJmSocTwIenmRzgCRr6O62/ZUk2yQ5NcnZSb6T5KD2xUnWJDm/X16Z5ENJvpfkZGDlULljkqxLckGSf+7XPbc/1mlJTuvXXZhkdb/8/CTn94+jho73vST/0e/rc/2NWSdyGN09zz5H9wW9g7rcIckX+ruRn53k9v36F/ftPDfJG/p1N/Z+k6xOcmG/fESSU5J8ETh1snOV5IlJzuv3+/4k2yb56eCedf294m58Lkmaf5P2aqrq0iTfBB4GfIKu13hiVVWSa+m+IPnKPrDOTHJKjf6y1mcA66vqLkn2Bs4e2vay/lib0oXJ3lX11iTPBx5UVZcM7yjJvYEnA39Nd2fsbyT5MnAZsCdwWFU9NcmJdPdcO36C+jyW7p5sdwaew033q/sA8IaqOjnJlsAmSR5GF6B/XVXr+5uXTuVewN59u1ZMdK6AvYCXA/erqkuS7FBVVyX5EvBwuvvCHQp8rKr+1B6gv2Hq0wD22GOqm7pLksY1zoSc4aHV4SHV0N2F+jzgC8DuwM6T7Odv6EOqv6npeUPbDklyNt1NXv+KLjQm8wDg5Kq6uqr+AHwM2Lff9tOqOqdfPgtY07647+1d0n9j/anAPZPskGRbYPeqOrmv57VVtZ7uZq/v7pepqkunqB/A54fKjTpXfwd8ZBD+Q+WPowt/+p/vnugAVXVsVa2tqrU77TTZzeMlSdMxTjh+AnhwknsBW1XVWf36xwE7AfeuqnvQ3RF7y+lWIMltgRcCD66qvYFPzWQ/Q4Zv9bOBiXvHhwF37odBfwxsR9fDnK7ruekctnW+emh5Wueqqs4A1iR5ILBpVZ0/g7pJkmZoynDse2anAe/izyfibA/8tqr+lORBwG2m2NXpwOEASe4K7N2v344uSK5IsjPdEO7AVcC2E+zrK8CjkmzVT6Z5dL9uSkk2AQ4B7lZVa6pqDd2Q6WFVdRVwUZJH9WW36GfLfh548mDm7NCw6oXAvfvlySYejTpXXwT+PsmOzX4B3kc31Dthr1GSNH/G/ZzjCcDd+fNw/ACwNsl3gCcC359iH8cA2yT5HvBquiFPqupcuuHU79OFwRlDrzkW+MxgQs5AVZ0NvIfubunfAI6rqm+P2ZZ9gV9W1a+G1p0O7JVkV+AJwHP7IdCvAbtU1WeAU4B1Sc6h6+kCvBl4RpJvA6snOeaE56qqLgBeC3w5ybnAW5rX3IIxZwZLkuaONzu+mUpyMHBQVT1hnPJr164t78ohSeNLclZVTfh5ez+DdzOU5G10w8sHLHZdJGk5MhxvhqrqOYtdB0lazvxuVUmSGoajJEkNw1GSpIbhKElSw3CUJKlhOEqS1DAcJUlqGI6SJDUMR0mSGoajJEkNw1GSpIbhKElSw3CUJKlhOEqS1DAcJUlqGI6SJDUMR0mSGoajJEkNw1GSpIbhKElSw3CUJKlhOEqS1DAcJUlqGI6SJDUMR0mSGoajJEkNw1GSpIbhKElSw3CUJKlhOEqS1DAcJUlqGI6SJDVWLHYFJEnL3A03wDXXwPr1cPXV3c+pHoNyW24Jr3/9nFfJcJQkjfanP00dUOMG2ajHtddOv16bbAJbbw23upXhKEnqVcF1181tSE1U7vrrp1+3zTfvgmurrf7yseOOf/58VLmJHsNlN9sMkrk/rz3DUZLm2oYNNw0TzmePq2r6dRsVOqtWwW67jR9Oox4rV8KKpR8tS78FkjQdw8OE89Xjuu666ddr001Hh8/OO8++p7XVVt31uXnsbW1MDEdJNw9V3bWnuR4WbB8zGSbcYovRobN69ex6WoPH5pvP/TnVjBmOkqbWDhPOR4/rmmumP0yYjA6bW9wCdt99/IAaVW7lyq5Xp2XFcJSWsqrJZxPOVZjNdpiwDZ5ddpl9T2vrrbsencOEmgeGozRf2mHCue5tDcpu2DD9um255ejAueUtZ35Na/ix2WZzf06lBWI4annasGH+e1vr10+/XoNhwolCZ4cdus90zaanNZiU4TChNCnDUTcvEw0Tzsf1rT/+cfp122yz0aGzatXselmDh8OE0s2C4ajx3XDD1LMJ5yLMZjJMuHLlxGGzzTZ/Pkw402nwK1c6TCgtI4bjcveCF8CVV45/jWu6NtlkdOhMNgV+OkG2cmV3HEk3exN9sc9EPyfbNvxz223hM5+Z+3oajsvdiSd2PcI2cAbDhLOdBr/55g4TSkvI4DvAxw2nmQTbDTdMr06Dic+DR/s39nwwHJe7X/xisWsgaRquv37uel0T/bzmmunXaYst/jK0Bpfihz9qOtOfi/H9CIajJM2Rqm6u12zCaaqAm+5csuHvSWhDZ/CtdJOF01TBtdVWG+fkZ8NR0rIxmFM2X72umcwna78rYXh5xx1n1tsaXvbrVGfGcJR0s7Fhw/z2umYyp2zwtaptCG2/Pey663i9q8l+zvOdlzRDhqOksQw+gjoXEzJG/ZzJt9SNCp2ddoI1a2Y+XLj11hvN3Zc0A77t0kZi8G11sx0anGzbdIcMBzdrnyiMdthh5r2twfLKlfa6ND8MR2mBDH9j3Xz0utavn/5NLYZv2D78c9ttb/pu8NkMG/pJHi1VhqPUGwwZzleva6ZDhhOFzurVsMces59l6JChNDH/a2hJGL7BxXzNNJzuPXAHQ4YThdGqVbObpDGYZegX/0iLw3DUnLjhhtnPMJwq4GYyZDhR+Ay+bnW2swwdMpQ2XobjMnfqqTcF0mwC7dprp3/slSsnDp0dd+yGDGf74WSHDCXNlL8+lrlHPnLir4safF/4RGG0225zM8vQIUNJN1eG4zL3xS9OPGPR2wpKWs4Mx2Vun30WuwaSdPPjwJYkSQ3DUZKkhuEoSVLDcJQkqWE4SpLUMBwlSWoYjpIkNQxHSZIahqMkSQ3DUZKkhuEoSVLDcJQkqWE4SpLUMBwlSWoYjpIkNQxHSZIahqMkSQ3DUZKkhuEoSVLDcJQkqWE4SpLUMBwlSWoYjpIkNQxHSZIahqMkSQ3DUZKkhuEoSVLDcJQkqWE4SpLUMBwlSWoYjpIkNQxHSZIahqMkSQ3DUZKkhuEoSVLDcJQkqWE4SpLUMBwlSWoYjpIkNQxHSZIahqMkSQ3DUZKkhuEoSVLDcJQkqWE4SpLUMBwlSWoYjpIkNQxHSZIahqMkSQ3DUZKkhuEoSVLDcJQkqWE4SpLUMBwlSWoYjpIkNQxHSZIahqMkSQ3DUZKkhuEoSVLDcJQkqWE4SpLUMBwlSWoYjpIkNQxHSZIahqMkSQ3DUZKkhuEoSVLDcJQkqWE4SpLUMBwlSWoYjpIkNQxHSZIahqMkSQ3DUZKkhuEoSVLDcJQkqWE4SpLUMBwlSWoYjpIkNQxHSZIahqMkSQ3DUZKkhuEoSVLDcJQkqWE4SpLUMBwlSWoYjpIkNQxHSZIahqMkSQ3DUZKkhuEoSVLDcJQkqWE4SpLUMBwlSWoYjpIkNQxHSZIahqMkSQ3DUZKkhuEoSVLDcJQkqWE4SpLUMBwlSWoYjpIkNQxHSZIahqMkSQ3DUZKkhuEoSVLDcJQkqWE4SpLUMBwlSWoYjpIkNQxHSZIahqMkSQ3DUZKkhuEoSVLDcJQkqWE4SpLUMBwlSWoYjpIkNQxHSZIahqMkSQ3DUZKkhuEoSVLDcJQkqWE4SpLUMBwlSWoYjpIkNWYdjkl2THJO/7g4yS+Hnm8+5j7eneROU5R5VpLHzba+Q/vbOcn1SY6cq31KkjYOK2a7g6r6PXAPgCRHA3+oqjcPl0kSIFV1w4h9PHmM47x9tnVtHAJ8HTgMOG6O932jJCuq6vr52r8kae7N27Bqkjsk+W6SDwAXALsmOTbJuiQXJHnlUNmvJrlHkhVJLk/yhiTnJvl6klv2ZV6T5Kih8m9I8s0kP0hyv3791kk+2h/3pP5Y9xhRxcOAo4DbJdl1qC4PT3J2f/zP9eu2TfLeJOf1j0cN6jr0ukOTHNcvH5/kmCTfBF6XZJ++Ld9OckaSPftyK5L8a5Lz+/0+M8lDkpw0tN+HJfnIXLwnkqTxzLrnOIU7A0+sqnUASV5SVZcmWQGcluSkqvpu85rtgS9X1UuSvAX4B+ANE+w7VXWfJAcCrwT2B54DXFxVj0lyd+DsiSqVZA2wQ1Wd1QfPIcC/JdkFOAbYt6p+lmSH/iVHA7+rqr37XvCqMdq+K7BPVd2QZPt+n9cn2R94DfBY4BnAbsDdq2pDf7zLgX9PsmPfK38y8K4R7Xga8DSAPfbYY4wqSZLGMd8Tcn48CMbeYUnOpgutuwB7TfCaa6rq0/3yWcCaEfv+2ARlHgB8CKCqzqXrsU7kUODD/fKH6HqRAPcFTquqn/X7uLRfvx/w9n5dVdVlI/Y77CNDw8irgI8mOR94M/BXQ/t9R1VtGByvf80HgMP7sLw38LmJDlBVx1bV2qpau9NOO41RJUnSOOa753j1YKEfSnwecJ+qujzJ8cCWE7zmj0PLGxhdx+vGKDPKYcDqJE/qn++W5HbT3McNQIaet225emj5tcBnq+r/JLkD8Jkp9v0u4KP98ocH4SlJWhgL+VGO7YCrgCv7a3wPnYdjnEE3REqSuzFBzzTJXsCKqtq9qtZU1RrgTXS9ya8BD0pym77sYFj188Cz+nVJcou+h3dZkj2TbAI8epJ6bQ/8sl8+Ymj954F/TLLp8PGq6hfAJcBLgPdM5wRIkmZvIcPxbOC7wPeB99EF2Vx7G7B7ku8Cr+qPd0VT5jDg5GbdR4HDquo3dNcBP5HkXLrhTYB/Bnbuh0XPAfbt178Y+CxdqF40Sb3eCLypH1Ie7m2+E7gYOK8/3iFD2z4I/LSqfjh5kyVJcy1Vtdh1mDP9RJ8VVXVtP4z7OWDPpfhRiiTvAL5eVe8dp/zatWtr3bp1UxeUJAGQ5KyqWjvRtvm+5rjQtgFO7UMywNOXaDCeA1wGPHex6yJJy9FGFY5VdTnd7M4lrapGfTZTkrQA/G5VSZIahqMkSY2NakLOcpbkd8DPZvjy1XQfHVlObPPGb7m1F2zzdN2mqib8BhXDUSRZN2rG1sbKNm/8llt7wTbPJYdVJUlqGI6SJDUMRwEcu9gVWAS2eeO33NoLtnnOeM1RkqSGPUdJkhqGoyRJDcNxGUmyf5IfJPlRkpdMsH2LJB/ut38jyZqFr+XcGaO9z0/y3STnJTl1cKuypWyqNg+Ve0ySSrLkp/2P0+Ykh/Tv9QVJPrjQdZxrY/zb3iPJaUm+3f/7PmAx6jlXkrwryW/7OyNNtD1J3tqfj/OS3GvWB60qH8vgAWwK/Bi4HbA5cC6wV1PmmcA7+uVD6W60vOh1n8f2PgjYql9+xlJu77ht7sttC5wOnAmsXex6L8D7vCfwbeAW/fNbLna9F6DNxwLP6Jf3Ai5c7HrPss1/A9wLOH/E9gOAT9PdcGIf4BuzPaY9x+XjPsCPquonVfVH4EPAQU2Zg4DBLbJOAh6cJCxNU7a3qk6rqvX90zOBWy1wHefaOO8xwL/Q3WP02oWs3DwZp81PBd5eVZcBVNVvF7iOc22cNhfdDeahu9n6rxawfnOuqk4HLp2kyEHA+6pzJrAqya6zOabhuHzsDvxi6PlF/boJy1R3q68rgB0XpHZzb5z2DnsK3V+eS9mUbe6Hm25dVZ9ayIrNo3He5zsCd0xyRpIzk+y/YLWbH+O0+Wjg8UkuAv4TeM7CVG3RTPf/+5Q2qltWSTOR5PHAWuBvF7su8ynJJsBbgCMWuSoLbQXd0OoD6UYHTk9yt+pucbexOgx4T1X97yT3Bd6f5K5VdcNiV2ypsOe4fPwSuPXQ81v16yYs098wenvg9wtSu7k3TntJsh/wMuDAqrpugeo2X6Zq87bAXYEvJbmQ7trMKUt8Us447/NFwClV9aeq+inwQ7qwXKrGafNTgBMBqurrwJZ0X9C9sRrr//t0GI7Lx7eAPZPcNsnmdBNuTmnKnAI8qV8+GPhi9Ve7l6Ap25vknsA76YJxqV+HginaXFVXVNXqqlpTVWvorrMeWFXrFqe6c2Kcf9cfp+s1kmQ13TDrTxayknNsnDb/HHgwQJK70IXj7xa0lgvrFOCJ/azVfYArqurXs9mhw6rLRFVdn+TZwGfpZru9q6ouSPJqYF1VnQL8X7rhlx/RXfw+dPFqPDtjtvdNwDbAR/p5Rz+vqgMXrdKzNGabNypjtvmzwEOSfBfYALyoqpbqiMi4bX4B8B9J/olucs4RS/gPXZKcQPcHzur+OuqrgM0AquoddNdVDwB+BKwHnjzrYy7h8yVJ0rxwWFWSpIbhKElSw3CUJKlhOEqS1DAcJUlqGI6SJDUMR0mSGv8f7SSOc/8K8KUAAAAASUVORK5CYII=
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;/div&gt;</content><author><name></name></author><summary type="html"></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://rafaelsf80.github.io/notebooks/images/kaggle.png" /><media:content medium="image" url="https://rafaelsf80.github.io/notebooks/images/kaggle.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Redes convolucionales Happy-Sad</title><link href="https://rafaelsf80.github.io/notebooks/tensorflow/2020/08/01/happy-sad.html" rel="alternate" type="text/html" title="Redes convolucionales Happy-Sad" /><published>2020-08-01T00:00:00-05:00</published><updated>2020-08-01T00:00:00-05:00</updated><id>https://rafaelsf80.github.io/notebooks/tensorflow/2020/08/01/happy-sad</id><content type="html" xml:base="https://rafaelsf80.github.io/notebooks/tensorflow/2020/08/01/happy-sad.html">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-08-01-happy-sad.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Introducci&amp;#243;n&quot;&gt;Introducci&amp;#243;n&lt;a class=&quot;anchor-link&quot; href=&quot;#Introducci&amp;#243;n&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;Below is code with a link to a happy or sad dataset which contains 80 images, 40 happy and 40 sad. 
Create a convolutional neural network that trains to 100% accuracy on these images,  which cancels training upon hitting training accuracy of &amp;gt;.999&lt;/p&gt;
&lt;p&gt;Hint -- it will work best with 3 convolutional layers.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tensorflow&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tf&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;os&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;zipfile&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;os&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;getcwd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;chdir&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# DO NOT CHANGE THE LINE BELOW. If you are developing in a local&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# environment, then grab happy-or-sad.zip from the Coursera Jupyter Notebook&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# and place it inside a local folder and edit the path to that location&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;sa&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getcwd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;/../tmp2/happy-or-sad.zip&amp;quot;&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;zip_ref&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;zipfile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ZipFile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;r&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;zip_ref&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;extractall&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;/tmp/h-or-s&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;zip_ref&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# GRADED FUNCTION: train_happy_sad_model&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;train_happy_sad_model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Please write your code only where you are indicated.&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# please do not remove # model fitting inline comments.&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;DESIRED_ACCURACY&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.999&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;myCallback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;callbacks&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Callback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;on_epoch_end&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;epoch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;logs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{}):&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;logs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;acc&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DESIRED_ACCURACY&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
              &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;Reached 99.9&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;% a&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ccuracy so cancelling training!&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
              &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stop_training&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;callbacks&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;myCallback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# This Code Block should Define and Compile the Model. Please assume the images are 150 X 150 in your implementation.&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;models&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Sequential&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Conv2D&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;activation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;relu&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;input_shape&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;150&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;150&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)),&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# Input 300x300, 3 canales&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;MaxPooling2D&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Conv2D&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;activation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;relu&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;MaxPooling2D&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Conv2D&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;activation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;relu&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;MaxPooling2D&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Flatten&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# Aplanar hacia DNN&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;512&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;activation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;relu&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# 512 unidades&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;activation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;sigmoid&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

    &lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tensorflow.keras.optimizers&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;RMSprop&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;compile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;binary_crossentropy&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
              &lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;RMSprop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.001&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
              &lt;span class=&quot;n&quot;&gt;metrics&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;accuracy&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;        

    &lt;span class=&quot;c1&quot;&gt;# This code block should create an instance of an ImageDataGenerator called train_datagen &lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# And a train_generator by calling train_datagen.flow_from_directory&lt;/span&gt;

    &lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tensorflow.keras.preprocessing.image&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ImageDataGenerator&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;train_datagen&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ImageDataGenerator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rescale&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;255&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# Reescalado&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;validation_datagen&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ImageDataGenerator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rescale&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;255&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    
    &lt;span class=&quot;c1&quot;&gt;# Please use a target_size of 150 X 150.&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;train_generator&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train_datagen&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flow_from_directory&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;s1&quot;&gt;&amp;#39;/tmp/h-or-s/&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# Directorio&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;target_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;150&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;150&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# Reescalado a 300x300&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;128&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;          &lt;span class=&quot;c1&quot;&gt;# Batches de 128&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;class_mode&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;binary&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;     &lt;span class=&quot;c1&quot;&gt;# Horses vs Humans&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Expected output: &amp;#39;Found 80 images belonging to 2 classes&amp;#39;&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# This code block should call model.fit_generator and train for&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# a number of epochs.&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# model fitting&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;history&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit_generator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;train_generator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;steps_per_epoch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  
      &lt;span class=&quot;n&quot;&gt;epochs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;verbose&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;callbacks&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;callbacks&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# model fitting&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;history&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;history&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;acc&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# The Expected output: &amp;quot;Reached 99.9% accuracy so cancelling training!&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;train_happy_sad_model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Found 80 images belonging to 2 classes.
Epoch 1/15
8/8 [==============================] - 4s 462ms/step - loss: 1.8616 - acc: 0.5000
Epoch 2/15
8/8 [==============================] - 3s 314ms/step - loss: 0.5336 - acc: 0.7125
Epoch 3/15
8/8 [==============================] - 2s 312ms/step - loss: 0.1999 - acc: 0.9156
Epoch 4/15
8/8 [==============================] - 2s 312ms/step - loss: 0.0734 - acc: 0.9859
Epoch 5/15
7/8 [=========================&amp;gt;....] - ETA: 0s - loss: 0.0201 - acc: 1.0000
Reached 99.9% accuracy so cancelling training!
8/8 [==============================] - 3s 313ms/step - loss: 0.0190 - acc: 1.0000
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;1.0&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;/div&gt;</content><author><name></name></author><summary type="html"></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://rafaelsf80.github.io/notebooks/images/kaggle.png" /><media:content medium="image" url="https://rafaelsf80.github.io/notebooks/images/kaggle.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Redes convolucionales Fashion MNIST</title><link href="https://rafaelsf80.github.io/notebooks/tensorflow/2020/08/01/fashion-mnist-conv.html" rel="alternate" type="text/html" title="Redes convolucionales Fashion MNIST" /><published>2020-08-01T00:00:00-05:00</published><updated>2020-08-01T00:00:00-05:00</updated><id>https://rafaelsf80.github.io/notebooks/tensorflow/2020/08/01/fashion-mnist-conv</id><content type="html" xml:base="https://rafaelsf80.github.io/notebooks/tensorflow/2020/08/01/fashion-mnist-conv.html">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-08-01-fashion-mnist-conv.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Introducci&amp;#243;n&quot;&gt;Introducci&amp;#243;n&lt;a class=&quot;anchor-link&quot; href=&quot;#Introducci&amp;#243;n&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;In the videos you looked at how you would improve Fashion MNIST using Convolutions. For your exercise see if you can improve MNIST to 99.8% accuracy or more using only a single convolutional layer and a single MaxPooling 2D. You should stop training once the accuracy goes above this amount. It should happen in less than 20 epochs, so it's ok to hard code the number of epochs for training, but your training must end once it hits the above metric. If it doesn't, then you'll need to redesign your layers.&lt;/p&gt;
&lt;p&gt;I've started the code for you -- you need to finish it!&lt;/p&gt;
&lt;p&gt;When 99.8% accuracy has been hit, you should print out the string &quot;Reached 99.8% accuracy so cancelling training!&quot;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tensorflow&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tf&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;os&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;getcwd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;chdir&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# DO NOT CHANGE THE LINE BELOW. If you are developing in a local&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# environment, then grab mnist.npz from the Coursera Jupyter Notebook&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# and place it inside a local folder and edit the path to that location&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;sa&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getcwd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;/../tmp2/mnist.npz&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;config&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ConfigProto&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gpu_options&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;allow_growth&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sess&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# GRADED FUNCTION: train_mnist_conv&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;train_mnist_conv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Please write your code only where you are indicated.&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# please do not remove model fitting inline comments.&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# YOUR CODE STARTS HERE&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;myCallback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;callbacks&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Callback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;on_epoch_end&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;epoch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;logs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{}):&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;logs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;acc&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.998&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
              &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;Reached 99.8&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;% a&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ccuracy so cancelling training!&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
              &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stop_training&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;callbacks&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;myCallback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
  
    &lt;span class=&quot;c1&quot;&gt;# YOUR CODE ENDS HERE&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;mnist&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;datasets&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mnist&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;training_images&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;training_labels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test_images&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;test_labels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mnist&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;load_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# YOUR CODE STARTS HERE&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;training_images&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;training_images&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reshape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;60000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;28&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;28&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;training_images&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;training_images&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;255.0&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;test_images&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;test_images&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reshape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;28&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;28&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;test_images&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test_images&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;255.0&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# YOUR CODE ENDS HERE&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;models&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Sequential&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;# YOUR CODE STARTS HERE&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Conv2D&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;activation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;relu&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;input_shape&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;28&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;28&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)),&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;MaxPooling2D&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;

          &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Flatten&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;128&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;activation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;relu&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;activation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;softmax&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

            &lt;span class=&quot;c1&quot;&gt;# YOUR CODE ENDS HERE&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;compile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;adam&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;sparse_categorical_crossentropy&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;metrics&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;accuracy&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# model fitting&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;history&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# YOUR CODE STARTS HERE&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;training_images&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;training_labels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;epochs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;callbacks&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;callbacks&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# YOUR CODE ENDS HERE&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# model fitting&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;history&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;epoch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;history&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;history&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;acc&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train_mnist_conv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Epoch 1/20
60000/60000 [==============================] - 16s 265us/sample - loss: 0.1334 - acc: 0.9595
Epoch 2/20
60000/60000 [==============================] - 16s 267us/sample - loss: 0.0470 - acc: 0.9854
Epoch 3/20
60000/60000 [==============================] - 17s 284us/sample - loss: 0.0298 - acc: 0.9902
Epoch 4/20
60000/60000 [==============================] - 17s 289us/sample - loss: 0.0190 - acc: 0.9937 - l
Epoch 5/20
60000/60000 [==============================] - 18s 307us/sample - loss: 0.0141 - acc: 0.9951
Epoch 6/20
60000/60000 [==============================] - 17s 281us/sample - loss: 0.0093 - acc: 0.9966
Epoch 7/20
60000/60000 [==============================] - 17s 285us/sample - loss: 0.0083 - acc: 0.9972
Epoch 8/20
59968/60000 [============================&amp;gt;.] - ETA: 0s - loss: 0.0044 - acc: 0.9986
Reached 99.8% accuracy so cancelling training!
60000/60000 [==============================] - 17s 285us/sample - loss: 0.0044 - acc: 0.9986
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;/div&gt;</content><author><name></name></author><summary type="html"></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://rafaelsf80.github.io/notebooks/images/kaggle.png" /><media:content medium="image" url="https://rafaelsf80.github.io/notebooks/images/kaggle.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">AutoML NLP Classifier with a large confussion matrix</title><link href="https://rafaelsf80.github.io/notebooks/googlecloud/automl/2020/06/26/automl-nlp-classifier-with-confussion-matrix.html" rel="alternate" type="text/html" title="AutoML NLP Classifier with a large confussion matrix" /><published>2020-06-26T00:00:00-05:00</published><updated>2020-06-26T00:00:00-05:00</updated><id>https://rafaelsf80.github.io/notebooks/googlecloud/automl/2020/06/26/automl-nlp-classifier-with-confussion-matrix</id><content type="html" xml:base="https://rafaelsf80.github.io/notebooks/googlecloud/automl/2020/06/26/automl-nlp-classifier-with-confussion-matrix.html">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-06-26-automl-nlp-classifier-with confussion-matrix.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;This notebook shows how to predict an existing trained model using AutoML NLP, in order to manually get bigger than 10x10 confussion matrix, which is the maximum supported by the AutoML service&lt;/p&gt;
&lt;p&gt;We will use a &lt;a href=&quot;https://console.cloud.google.com/marketplace/details/stack-exchange/stack-overflow&quot;&gt;public dataset about Stack Overflow questions&lt;/a&gt; available in Google Cloud marketplace, that has been trained using AutoML NLP. You can explore the dataset in &lt;a href=&quot;https://cloud.google.com/bigquery/&quot;&gt;BigQuery&lt;/a&gt; just by following the instructions of the former link. In this notebook,the model is already built and deployed in AutoML NLP service. To keep things simple our pre-processed table includes questions containing 4 possible programming-related tags: Java, Javascript, Python or C#. Confussion matrix bigger than 10x10 will be implied.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;BigQuery has a  public dataset that includes more than 17 million Stack Overflow questions. We are going to download some posts labeled as one of the four most used languages today: java, javascript, python and C#, but to make this a harder problem to our model, we have replaced every instance of that word with another less used language today (but well-known some decades ago) called &lt;code&gt;blank&lt;/code&gt;. Otherwise, it will be very easy for the model to detect that a post is a java-related post just by finding the word &lt;code&gt;java&lt;/code&gt; on it.&lt;/p&gt;
&lt;p&gt;You can access the pre-processed fortran-filled dataset as a tar file &lt;a href=&quot;PENDING&quot;&gt;here&lt;/a&gt;. Each of the four labels has approximate 10k samples for training/eval and 10k samples for test.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Authenticate-in-Google-Cloud-from-Colab&quot;&gt;Authenticate in Google Cloud from Colab&lt;a class=&quot;anchor-link&quot; href=&quot;#Authenticate-in-Google-Cloud-from-Colab&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;google.colab&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;auth&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;auth&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;authenticate_user&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Authenticated&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Batch-predict-on-AutoML-NLP&quot;&gt;Batch predict on AutoML NLP&lt;a class=&quot;anchor-link&quot; href=&quot;#Batch-predict-on-AutoML-NLP&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;We will make a batch predict on an already deployed AutoML NLP model&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Batch predict for an already trained AutoML NLP model&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;google.cloud&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;automl&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;project_id&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;windy-site-254307&amp;quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model_id&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;TCN627409922111307776&amp;quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;input_uri&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;gs://stackoverflow-automl-nlp/dataset_batchpredict.csv&amp;quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;output_uri&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;gs://stackoverflow-automl-nlp&amp;quot;&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;prediction_client&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;automl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;PredictionServiceClient&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Get the full path of the model.&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model_full_id&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;prediction_client&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model_path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;project_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;us-central1&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model_id&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;gcs_source&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;automl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;types&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;GcsSource&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input_uris&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input_uri&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;input_config&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;automl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;types&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BatchPredictInputConfig&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gcs_source&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gcs_source&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;gcs_destination&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;automl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;types&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;GcsDestination&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;output_uri_prefix&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;output_uri&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;output_config&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;automl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;types&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BatchPredictOutputConfig&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;gcs_destination&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gcs_destination&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;response&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;prediction_client&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch_predict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;model_full_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;input_config&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;output_config&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Waiting for operation to complete...&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;Batch Prediction results saved to Cloud Storage bucket. &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;response&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Download results from GCS. See first line for reference and modify URI accordingly&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;gsutil ls gs://stackoverflow-automl-nlp/prediction-stackoverflow_4labels_20200602-2020-06-29T08:49:31.326Z
&lt;span class=&quot;n&quot;&gt;file_list&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
            
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;file&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;gsutil cp &lt;span class=&quot;nv&quot;&gt;$file&lt;/span&gt; .
    &lt;span class=&quot;n&quot;&gt;file_list&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;/&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;strip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Copying gs://stackoverflow-automl-nlp/prediction-stackoverflow_4labels_20200602-2020-06-29T08:49:31.326Z/text_classification_1.jsonl...

Operation completed over 1 objects/120.0 KiB.                                    
Copying gs://stackoverflow-automl-nlp/prediction-stackoverflow_4labels_20200602-2020-06-29T08:49:31.326Z/text_classification_10.jsonl...

Operation completed over 1 objects/221.5 KiB.                                    
Copying gs://stackoverflow-automl-nlp/prediction-stackoverflow_4labels_20200602-2020-06-29T08:49:31.326Z/text_classification_11.jsonl...

Operation completed over 1 objects/96.5 KiB.                                     
Copying gs://stackoverflow-automl-nlp/prediction-stackoverflow_4labels_20200602-2020-06-29T08:49:31.326Z/text_classification_12.jsonl...

Operation completed over 1 objects/24.6 KiB.                                     
Copying gs://stackoverflow-automl-nlp/prediction-stackoverflow_4labels_20200602-2020-06-29T08:49:31.326Z/text_classification_13.jsonl...

Operation completed over 1 objects/26.7 KiB.                                     
Copying gs://stackoverflow-automl-nlp/prediction-stackoverflow_4labels_20200602-2020-06-29T08:49:31.326Z/text_classification_14.jsonl...

Operation completed over 1 objects/10.7 KiB.                                     
Copying gs://stackoverflow-automl-nlp/prediction-stackoverflow_4labels_20200602-2020-06-29T08:49:31.326Z/text_classification_15.jsonl...

Operation completed over 1 objects/37.2 KiB.                                     
Copying gs://stackoverflow-automl-nlp/prediction-stackoverflow_4labels_20200602-2020-06-29T08:49:31.326Z/text_classification_16.jsonl...

Operation completed over 1 objects/60.5 KiB.                                     
Copying gs://stackoverflow-automl-nlp/prediction-stackoverflow_4labels_20200602-2020-06-29T08:49:31.326Z/text_classification_17.jsonl...

Operation completed over 1 objects/21.3 KiB.                                     
Copying gs://stackoverflow-automl-nlp/prediction-stackoverflow_4labels_20200602-2020-06-29T08:49:31.326Z/text_classification_18.jsonl...

Operation completed over 1 objects/14.8 KiB.                                     
Copying gs://stackoverflow-automl-nlp/prediction-stackoverflow_4labels_20200602-2020-06-29T08:49:31.326Z/text_classification_19.jsonl...

Operation completed over 1 objects/47.1 KiB.                                     
Copying gs://stackoverflow-automl-nlp/prediction-stackoverflow_4labels_20200602-2020-06-29T08:49:31.326Z/text_classification_2.jsonl...

Operation completed over 1 objects/87.8 KiB.                                     
Copying gs://stackoverflow-automl-nlp/prediction-stackoverflow_4labels_20200602-2020-06-29T08:49:31.326Z/text_classification_20.jsonl...

Operation completed over 1 objects/27.4 KiB.                                     
Copying gs://stackoverflow-automl-nlp/prediction-stackoverflow_4labels_20200602-2020-06-29T08:49:31.326Z/text_classification_21.jsonl...

Operation completed over 1 objects/8.2 KiB.                                      
Copying gs://stackoverflow-automl-nlp/prediction-stackoverflow_4labels_20200602-2020-06-29T08:49:31.326Z/text_classification_22.jsonl...

Operation completed over 1 objects/6.6 KiB.                                      
Copying gs://stackoverflow-automl-nlp/prediction-stackoverflow_4labels_20200602-2020-06-29T08:49:31.326Z/text_classification_23.jsonl...

Operation completed over 1 objects/206.2 KiB.                                    
Copying gs://stackoverflow-automl-nlp/prediction-stackoverflow_4labels_20200602-2020-06-29T08:49:31.326Z/text_classification_24.jsonl...

Operation completed over 1 objects/199.6 KiB.                                    
Copying gs://stackoverflow-automl-nlp/prediction-stackoverflow_4labels_20200602-2020-06-29T08:49:31.326Z/text_classification_25.jsonl...

Operation completed over 1 objects/60.5 KiB.                                     
Copying gs://stackoverflow-automl-nlp/prediction-stackoverflow_4labels_20200602-2020-06-29T08:49:31.326Z/text_classification_26.jsonl...

Operation completed over 1 objects/46.7 KiB.                                     
Copying gs://stackoverflow-automl-nlp/prediction-stackoverflow_4labels_20200602-2020-06-29T08:49:31.326Z/text_classification_27.jsonl...

Operation completed over 1 objects/59.4 KiB.                                     
Copying gs://stackoverflow-automl-nlp/prediction-stackoverflow_4labels_20200602-2020-06-29T08:49:31.326Z/text_classification_28.jsonl...

Operation completed over 1 objects/31.6 KiB.                                     
Copying gs://stackoverflow-automl-nlp/prediction-stackoverflow_4labels_20200602-2020-06-29T08:49:31.326Z/text_classification_29.jsonl...

Operation completed over 1 objects/9.2 KiB.                                      
Copying gs://stackoverflow-automl-nlp/prediction-stackoverflow_4labels_20200602-2020-06-29T08:49:31.326Z/text_classification_3.jsonl...

Operation completed over 1 objects/107.3 KiB.                                    
Copying gs://stackoverflow-automl-nlp/prediction-stackoverflow_4labels_20200602-2020-06-29T08:49:31.326Z/text_classification_30.jsonl...

Operation completed over 1 objects/4.1 KiB.                                      
Copying gs://stackoverflow-automl-nlp/prediction-stackoverflow_4labels_20200602-2020-06-29T08:49:31.326Z/text_classification_31.jsonl...

Operation completed over 1 objects/103.1 KiB.                                    
Copying gs://stackoverflow-automl-nlp/prediction-stackoverflow_4labels_20200602-2020-06-29T08:49:31.326Z/text_classification_32.jsonl...

Operation completed over 1 objects/94.4 KiB.                                     
Copying gs://stackoverflow-automl-nlp/prediction-stackoverflow_4labels_20200602-2020-06-29T08:49:31.326Z/text_classification_4.jsonl...

Operation completed over 1 objects/18.5 KiB.                                     
Copying gs://stackoverflow-automl-nlp/prediction-stackoverflow_4labels_20200602-2020-06-29T08:49:31.326Z/text_classification_5.jsonl...

Operation completed over 1 objects/45.5 KiB.                                     
Copying gs://stackoverflow-automl-nlp/prediction-stackoverflow_4labels_20200602-2020-06-29T08:49:31.326Z/text_classification_6.jsonl...

Operation completed over 1 objects/35.1 KiB.                                     
Copying gs://stackoverflow-automl-nlp/prediction-stackoverflow_4labels_20200602-2020-06-29T08:49:31.326Z/text_classification_7.jsonl...

Operation completed over 1 objects/64.5 KiB.                                     
Copying gs://stackoverflow-automl-nlp/prediction-stackoverflow_4labels_20200602-2020-06-29T08:49:31.326Z/text_classification_8.jsonl...

Operation completed over 1 objects/42.6 KiB.                                     
Copying gs://stackoverflow-automl-nlp/prediction-stackoverflow_4labels_20200602-2020-06-29T08:49:31.326Z/text_classification_9.jsonl...
/ [0 files][    0.0 B/ 98.1 KiB]/ [1 files][ 98.1 KiB/ 98.1 KiB]
Operation completed over 1 objects/98.1 KiB.                                     
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Process-result-files&quot;&gt;Process result files&lt;a class=&quot;anchor-link&quot; href=&quot;#Process-result-files&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Example of annotations&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# [{&amp;#39;annotationSpecId&amp;#39;: &amp;#39;1249570775711612928&amp;#39;, &amp;#39;classification&amp;#39;: {&amp;#39;score&amp;#39;: 0.020207971}, &amp;#39;displayName&amp;#39;: &amp;#39;java&amp;#39;}, {&amp;#39;annotationSpecId&amp;#39;: &amp;#39;2402492280318459904&amp;#39;, &amp;#39;classification&amp;#39;: {&amp;#39;score&amp;#39;: 0.96145684}, &amp;#39;displayName&amp;#39;: &amp;#39;csharp&amp;#39;}, {&amp;#39;annotationSpecId&amp;#39;: &amp;#39;5861256794139000832&amp;#39;, &amp;#39;classification&amp;#39;: {&amp;#39;score&amp;#39;: 0.0013875663000000001}, &amp;#39;displayName&amp;#39;: &amp;#39;javascript&amp;#39;}, {&amp;#39;annotationSpecId&amp;#39;: &amp;#39;7014178298745847808&amp;#39;, &amp;#39;classification&amp;#39;: {&amp;#39;score&amp;#39;: 0.017511099999999998}, &amp;#39;displayName&amp;#39;: &amp;#39;python&amp;#39;}]&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Example of textSnippet&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# {&amp;#39;contentUri&amp;#39;: &amp;#39;gs://stackoverflow-automl-nlp/test/csharp/1003.txt&amp;#39;}&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pandas&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pd&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Init enum&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;enum&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Enum&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Language&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Enum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;java&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;csharp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;javascript&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;python&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;
    
&lt;span class=&quot;c1&quot;&gt;# Init vectors for the confussion matrix&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;y_true&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Read downloaded files one by one and generate y_true and y_pred vectos for the confussion matrix&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;file&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;file_list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;#file=&amp;quot;text_classification_1.jsonl&amp;quot;&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# Read file&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read_json&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;file&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lines&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Reading &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{0}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; annotations and &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{1}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; text snippets of &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{2}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;annotations&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to_list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()),&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;textSnippet&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to_list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;file&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

    &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;json&lt;/span&gt;    
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;annotations&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to_list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())):&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;# Decode textSnippet and get true_label&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;textsnippet_str&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;textSnippet&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to_list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;replace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&amp;#39;&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;quot;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; 
        &lt;span class=&quot;n&quot;&gt;textsnippet_decoded&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;json&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;textsnippet_str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;true_label&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;textsnippet_decoded&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;contentUri&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;/&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;strip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;y_true&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;true_label&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;# Decode annotations &lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;annotation_str&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;annotations&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to_list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;replace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&amp;#39;&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;quot;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; 
        &lt;span class=&quot;n&quot;&gt;annotation_decoded&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;json&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;annotation_str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;# Decode scores and add them to the corresponding line in the confussion matrix&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;scores&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; \
            &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;annotation_decoded&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Language&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;java&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;classification&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;score&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; 
             &lt;span class=&quot;n&quot;&gt;annotation_decoded&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Language&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;csharp&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;classification&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;score&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; 
             &lt;span class=&quot;n&quot;&gt;annotation_decoded&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Language&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;javascript&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;classification&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;score&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; 
             &lt;span class=&quot;n&quot;&gt;annotation_decoded&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Language&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;python&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;classification&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;score&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;max_value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;scores&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;max_index&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;scores&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;max_value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  
        &lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Language&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;max_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Reading 236 annotations and 236 text snippets of text_classification_1.jsonl
Reading 435 annotations and 435 text snippets of text_classification_10.jsonl
Reading 190 annotations and 190 text snippets of text_classification_11.jsonl
Reading 48 annotations and 48 text snippets of text_classification_12.jsonl
Reading 52 annotations and 52 text snippets of text_classification_13.jsonl
Reading 21 annotations and 21 text snippets of text_classification_14.jsonl
Reading 73 annotations and 73 text snippets of text_classification_15.jsonl
Reading 119 annotations and 119 text snippets of text_classification_16.jsonl
Reading 42 annotations and 42 text snippets of text_classification_17.jsonl
Reading 29 annotations and 29 text snippets of text_classification_18.jsonl
Reading 92 annotations and 92 text snippets of text_classification_19.jsonl
Reading 172 annotations and 172 text snippets of text_classification_2.jsonl
Reading 54 annotations and 54 text snippets of text_classification_20.jsonl
Reading 16 annotations and 16 text snippets of text_classification_21.jsonl
Reading 13 annotations and 13 text snippets of text_classification_22.jsonl
Reading 405 annotations and 405 text snippets of text_classification_23.jsonl
Reading 392 annotations and 392 text snippets of text_classification_24.jsonl
Reading 119 annotations and 119 text snippets of text_classification_25.jsonl
Reading 92 annotations and 92 text snippets of text_classification_26.jsonl
Reading 116 annotations and 116 text snippets of text_classification_27.jsonl
Reading 62 annotations and 62 text snippets of text_classification_28.jsonl
Reading 18 annotations and 18 text snippets of text_classification_29.jsonl
Reading 211 annotations and 211 text snippets of text_classification_3.jsonl
Reading 8 annotations and 8 text snippets of text_classification_30.jsonl
Reading 203 annotations and 203 text snippets of text_classification_31.jsonl
Reading 185 annotations and 185 text snippets of text_classification_32.jsonl
Reading 36 annotations and 36 text snippets of text_classification_4.jsonl
Reading 89 annotations and 89 text snippets of text_classification_5.jsonl
Reading 69 annotations and 69 text snippets of text_classification_6.jsonl
Reading 127 annotations and 127 text snippets of text_classification_7.jsonl
Reading 84 annotations and 84 text snippets of text_classification_8.jsonl
Reading 192 annotations and 192 text snippets of text_classification_9.jsonl
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Get-confusion-matrix&quot;&gt;Get confusion matrix&lt;a class=&quot;anchor-link&quot; href=&quot;#Get-confusion-matrix&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sklearn.metrics&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;confusion_matrix&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;matriz_de_confusion&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;confusion_matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;java&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;javascript&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;csharp&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;python&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;#DO NOT USE THIS MATRIX&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#conf_max_12x12 = confusion_matrix(y_train, y_train_pred)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#conf_max_12x12=([[1000,     3,     24,    9,    10,   49,   49,   50,   26,   23,   12,   98 ],&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#                [  23,  2000,     24,    9,    10,   49,   49,   50,   26,   23,   12,   98 ],&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#                [  56,     3,   1300,    9,    10,   49,   49,   50,   26,   23,   12,   98 ],&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#                [  23,     3,     24, 1400,    10,   49,   49,   50,   26,   23,   12,   98 ],&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#                [  35,     3,     24,    9,  1500,   49,   49,   50,   26,   23,   12,   98 ],&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#                [  35,     3,     24,    9,    10, 1400,   49,   50,   26,   23,   12,   98 ], &lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#                [  35,     3,     24,    9,    10,   49, 1300,   50,   26,   23,   12,   98 ], &lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#                [  35,     3,     24,    9,    10,   49,   49, 1200,   26,   23,   12,   98 ], &lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#                [  35,     3,     24,    9,    10,   49,   49,   50, 1100,   23,   12,   98 ], &lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#                [  35,     3,     24,    9,    10,   49,   49,   50,   26, 1000,   12,   98 ], &lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#                [  35,     3,     24,    9,    10,   49,   49,   50,   26,   23, 1100,   98 ], &lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#                [  35,     3,     24,    9,    10,   49,   49,   50,   26,   23,   12, 1200 ]])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;#!pip3 install seaborn&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;plt&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;seaborn&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sns&lt;/span&gt;


&lt;span class=&quot;c1&quot;&gt;# Normalise and Plot&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;target_names&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;java&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;csharp&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;javascript&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;python&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;cmn&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;matriz_de_confusion&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;astype&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;float&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;matriz_de_confusion&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[:,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;newaxis&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;fig&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;subplots&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figsize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sns&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;heatmap&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cmn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;annot&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fmt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;.2f&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;xticklabels&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;target_names&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;yticklabels&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;target_names&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ylabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Actual&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Predicted&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;block&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_svg output_subarea &quot;&gt;
&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; standalone=&quot;no&quot;?&gt;
&amp;lt;!DOCTYPE svg PUBLIC &quot;-//W3C//DTD SVG 1.1//EN&quot;
  &quot;http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd&quot;&amp;gt;
&lt;!-- Created with matplotlib (https://matplotlib.org/) --&gt;
&lt;svg height=&quot;588.35625pt&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 569.139375 588.35625&quot; width=&quot;569.139375pt&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; xmlns:xlink=&quot;http://www.w3.org/1999/xlink&quot;&gt;
 &lt;defs&gt;
  &lt;style type=&quot;text/css&quot;&gt;
*{stroke-linecap:butt;stroke-linejoin:round;}
  &lt;/style&gt;
 &lt;/defs&gt;
 &lt;g id=&quot;figure_1&quot;&gt;
  &lt;g id=&quot;patch_1&quot;&gt;
   &lt;path d=&quot;M 0 588.35625 
L 569.139375 588.35625 
L 569.139375 0 
L 0 0 
z
&quot; style=&quot;fill:none;&quot; /&gt;
  &lt;/g&gt;
  &lt;g id=&quot;axes_1&quot;&gt;
   &lt;g id=&quot;patch_2&quot;&gt;
    &lt;path d=&quot;M 37.55625 550.8 
L 483.95625 550.8 
L 483.95625 7.2 
L 37.55625 7.2 
z
&quot; style=&quot;fill:#ffffff;&quot; /&gt;
   &lt;/g&gt;
   &lt;g id=&quot;QuadMesh_1&quot;&gt;
    &lt;path clip-path=&quot;url(#p89171f4a4a)&quot; d=&quot;M 37.55625 7.2 
L 149.15625 7.2 
L 149.15625 143.1 
L 37.55625 143.1 
L 37.55625 7.2 
&quot; style=&quot;fill:#f7d0b5;&quot; /&gt;
    &lt;path clip-path=&quot;url(#p89171f4a4a)&quot; d=&quot;M 149.15625 7.2 
L 260.75625 7.2 
L 260.75625 143.1 
L 149.15625 143.1 
L 149.15625 7.2 
&quot; style=&quot;fill:#04051a;&quot; /&gt;
    &lt;path clip-path=&quot;url(#p89171f4a4a)&quot; d=&quot;M 260.75625 7.2 
L 372.35625 7.2 
L 372.35625 143.1 
L 260.75625 143.1 
L 260.75625 7.2 
&quot; style=&quot;fill:#1e122d;&quot; /&gt;
    &lt;path clip-path=&quot;url(#p89171f4a4a)&quot; d=&quot;M 372.35625 7.2 
L 483.95625 7.2 
L 483.95625 143.1 
L 372.35625 143.1 
L 372.35625 7.2 
&quot; style=&quot;fill:#06071c;&quot; /&gt;
    &lt;path clip-path=&quot;url(#p89171f4a4a)&quot; d=&quot;M 37.55625 143.1 
L 149.15625 143.1 
L 149.15625 279 
L 37.55625 279 
L 37.55625 143.1 
&quot; style=&quot;fill:#03051a;&quot; /&gt;
    &lt;path clip-path=&quot;url(#p89171f4a4a)&quot; d=&quot;M 149.15625 143.1 
L 260.75625 143.1 
L 260.75625 279 
L 149.15625 279 
L 149.15625 143.1 
&quot; style=&quot;fill:#faebdd;&quot; /&gt;
    &lt;path clip-path=&quot;url(#p89171f4a4a)&quot; d=&quot;M 260.75625 143.1 
L 372.35625 143.1 
L 372.35625 279 
L 260.75625 279 
L 260.75625 143.1 
&quot; style=&quot;fill:#07071d;&quot; /&gt;
    &lt;path clip-path=&quot;url(#p89171f4a4a)&quot; d=&quot;M 372.35625 143.1 
L 483.95625 143.1 
L 483.95625 279 
L 372.35625 279 
L 372.35625 143.1 
&quot; style=&quot;fill:#05061b;&quot; /&gt;
    &lt;path clip-path=&quot;url(#p89171f4a4a)&quot; d=&quot;M 37.55625 279 
L 149.15625 279 
L 149.15625 414.9 
L 37.55625 414.9 
L 37.55625 279 
&quot; style=&quot;fill:#1b112b;&quot; /&gt;
    &lt;path clip-path=&quot;url(#p89171f4a4a)&quot; d=&quot;M 149.15625 279 
L 260.75625 279 
L 260.75625 414.9 
L 149.15625 414.9 
L 149.15625 279 
&quot; style=&quot;fill:#04051a;&quot; /&gt;
    &lt;path clip-path=&quot;url(#p89171f4a4a)&quot; d=&quot;M 260.75625 279 
L 372.35625 279 
L 372.35625 414.9 
L 260.75625 414.9 
L 260.75625 279 
&quot; style=&quot;fill:#f8d9c3;&quot; /&gt;
    &lt;path clip-path=&quot;url(#p89171f4a4a)&quot; d=&quot;M 372.35625 279 
L 483.95625 279 
L 483.95625 414.9 
L 372.35625 414.9 
L 372.35625 279 
&quot; style=&quot;fill:#03051a;&quot; /&gt;
    &lt;path clip-path=&quot;url(#p89171f4a4a)&quot; d=&quot;M 37.55625 414.9 
L 149.15625 414.9 
L 149.15625 550.8 
L 37.55625 550.8 
L 37.55625 414.9 
&quot; style=&quot;fill:#06071c;&quot; /&gt;
    &lt;path clip-path=&quot;url(#p89171f4a4a)&quot; d=&quot;M 149.15625 414.9 
L 260.75625 414.9 
L 260.75625 550.8 
L 149.15625 550.8 
L 149.15625 414.9 
&quot; style=&quot;fill:#04051a;&quot; /&gt;
    &lt;path clip-path=&quot;url(#p89171f4a4a)&quot; d=&quot;M 260.75625 414.9 
L 372.35625 414.9 
L 372.35625 550.8 
L 260.75625 550.8 
L 260.75625 414.9 
&quot; style=&quot;fill:#04051a;&quot; /&gt;
    &lt;path clip-path=&quot;url(#p89171f4a4a)&quot; d=&quot;M 372.35625 414.9 
L 483.95625 414.9 
L 483.95625 550.8 
L 372.35625 550.8 
L 372.35625 414.9 
&quot; style=&quot;fill:#faebdd;&quot; /&gt;
   &lt;/g&gt;
   &lt;g id=&quot;matplotlib.axis_1&quot;&gt;
    &lt;g id=&quot;xtick_1&quot;&gt;
     &lt;g id=&quot;line2d_1&quot;&gt;
      &lt;defs&gt;
       &lt;path d=&quot;M 0 0 
L 0 3.5 
&quot; id=&quot;m3dd78abba5&quot; style=&quot;stroke:#000000;stroke-width:0.8;&quot; /&gt;
      &lt;/defs&gt;
      &lt;g&gt;
       &lt;use style=&quot;stroke:#000000;stroke-width:0.8;&quot; x=&quot;93.35625&quot; xlink:href=&quot;#m3dd78abba5&quot; y=&quot;550.8&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
     &lt;g id=&quot;text_1&quot;&gt;
      &lt;!-- java --&gt;
      &lt;defs&gt;
       &lt;path d=&quot;M 9.421875 54.6875 
L 18.40625 54.6875 
L 18.40625 -0.984375 
Q 18.40625 -11.421875 14.421875 -16.109375 
Q 10.453125 -20.796875 1.609375 -20.796875 
L -1.8125 -20.796875 
L -1.8125 -13.1875 
L 0.59375 -13.1875 
Q 5.71875 -13.1875 7.5625 -10.8125 
Q 9.421875 -8.453125 9.421875 -0.984375 
z
M 9.421875 75.984375 
L 18.40625 75.984375 
L 18.40625 64.59375 
L 9.421875 64.59375 
z
&quot; id=&quot;DejaVuSans-106&quot; /&gt;
       &lt;path d=&quot;M 34.28125 27.484375 
Q 23.390625 27.484375 19.1875 25 
Q 14.984375 22.515625 14.984375 16.5 
Q 14.984375 11.71875 18.140625 8.90625 
Q 21.296875 6.109375 26.703125 6.109375 
Q 34.1875 6.109375 38.703125 11.40625 
Q 43.21875 16.703125 43.21875 25.484375 
L 43.21875 27.484375 
z
M 52.203125 31.203125 
L 52.203125 0 
L 43.21875 0 
L 43.21875 8.296875 
Q 40.140625 3.328125 35.546875 0.953125 
Q 30.953125 -1.421875 24.3125 -1.421875 
Q 15.921875 -1.421875 10.953125 3.296875 
Q 6 8.015625 6 15.921875 
Q 6 25.140625 12.171875 29.828125 
Q 18.359375 34.515625 30.609375 34.515625 
L 43.21875 34.515625 
L 43.21875 35.40625 
Q 43.21875 41.609375 39.140625 45 
Q 35.0625 48.390625 27.6875 48.390625 
Q 23 48.390625 18.546875 47.265625 
Q 14.109375 46.140625 10.015625 43.890625 
L 10.015625 52.203125 
Q 14.9375 54.109375 19.578125 55.046875 
Q 24.21875 56 28.609375 56 
Q 40.484375 56 46.34375 49.84375 
Q 52.203125 43.703125 52.203125 31.203125 
z
&quot; id=&quot;DejaVuSans-97&quot; /&gt;
       &lt;path d=&quot;M 2.984375 54.6875 
L 12.5 54.6875 
L 29.59375 8.796875 
L 46.6875 54.6875 
L 56.203125 54.6875 
L 35.6875 0 
L 23.484375 0 
z
&quot; id=&quot;DejaVuSans-118&quot; /&gt;
      &lt;/defs&gt;
      &lt;g transform=&quot;translate(82.879688 565.398438)scale(0.1 -0.1)&quot;&gt;
       &lt;use xlink:href=&quot;#DejaVuSans-106&quot; /&gt;
       &lt;use x=&quot;27.783203&quot; xlink:href=&quot;#DejaVuSans-97&quot; /&gt;
       &lt;use x=&quot;89.0625&quot; xlink:href=&quot;#DejaVuSans-118&quot; /&gt;
       &lt;use x=&quot;148.242188&quot; xlink:href=&quot;#DejaVuSans-97&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
    &lt;/g&gt;
    &lt;g id=&quot;xtick_2&quot;&gt;
     &lt;g id=&quot;line2d_2&quot;&gt;
      &lt;g&gt;
       &lt;use style=&quot;stroke:#000000;stroke-width:0.8;&quot; x=&quot;204.95625&quot; xlink:href=&quot;#m3dd78abba5&quot; y=&quot;550.8&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
     &lt;g id=&quot;text_2&quot;&gt;
      &lt;!-- csharp --&gt;
      &lt;defs&gt;
       &lt;path d=&quot;M 48.78125 52.59375 
L 48.78125 44.1875 
Q 44.96875 46.296875 41.140625 47.34375 
Q 37.3125 48.390625 33.40625 48.390625 
Q 24.65625 48.390625 19.8125 42.84375 
Q 14.984375 37.3125 14.984375 27.296875 
Q 14.984375 17.28125 19.8125 11.734375 
Q 24.65625 6.203125 33.40625 6.203125 
Q 37.3125 6.203125 41.140625 7.25 
Q 44.96875 8.296875 48.78125 10.40625 
L 48.78125 2.09375 
Q 45.015625 0.34375 40.984375 -0.53125 
Q 36.96875 -1.421875 32.421875 -1.421875 
Q 20.0625 -1.421875 12.78125 6.34375 
Q 5.515625 14.109375 5.515625 27.296875 
Q 5.515625 40.671875 12.859375 48.328125 
Q 20.21875 56 33.015625 56 
Q 37.15625 56 41.109375 55.140625 
Q 45.0625 54.296875 48.78125 52.59375 
z
&quot; id=&quot;DejaVuSans-99&quot; /&gt;
       &lt;path d=&quot;M 44.28125 53.078125 
L 44.28125 44.578125 
Q 40.484375 46.53125 36.375 47.5 
Q 32.28125 48.484375 27.875 48.484375 
Q 21.1875 48.484375 17.84375 46.4375 
Q 14.5 44.390625 14.5 40.28125 
Q 14.5 37.15625 16.890625 35.375 
Q 19.28125 33.59375 26.515625 31.984375 
L 29.59375 31.296875 
Q 39.15625 29.25 43.1875 25.515625 
Q 47.21875 21.78125 47.21875 15.09375 
Q 47.21875 7.46875 41.1875 3.015625 
Q 35.15625 -1.421875 24.609375 -1.421875 
Q 20.21875 -1.421875 15.453125 -0.5625 
Q 10.6875 0.296875 5.421875 2 
L 5.421875 11.28125 
Q 10.40625 8.6875 15.234375 7.390625 
Q 20.0625 6.109375 24.8125 6.109375 
Q 31.15625 6.109375 34.5625 8.28125 
Q 37.984375 10.453125 37.984375 14.40625 
Q 37.984375 18.0625 35.515625 20.015625 
Q 33.0625 21.96875 24.703125 23.78125 
L 21.578125 24.515625 
Q 13.234375 26.265625 9.515625 29.90625 
Q 5.8125 33.546875 5.8125 39.890625 
Q 5.8125 47.609375 11.28125 51.796875 
Q 16.75 56 26.8125 56 
Q 31.78125 56 36.171875 55.265625 
Q 40.578125 54.546875 44.28125 53.078125 
z
&quot; id=&quot;DejaVuSans-115&quot; /&gt;
       &lt;path d=&quot;M 54.890625 33.015625 
L 54.890625 0 
L 45.90625 0 
L 45.90625 32.71875 
Q 45.90625 40.484375 42.875 44.328125 
Q 39.84375 48.1875 33.796875 48.1875 
Q 26.515625 48.1875 22.3125 43.546875 
Q 18.109375 38.921875 18.109375 30.90625 
L 18.109375 0 
L 9.078125 0 
L 9.078125 75.984375 
L 18.109375 75.984375 
L 18.109375 46.1875 
Q 21.34375 51.125 25.703125 53.5625 
Q 30.078125 56 35.796875 56 
Q 45.21875 56 50.046875 50.171875 
Q 54.890625 44.34375 54.890625 33.015625 
z
&quot; id=&quot;DejaVuSans-104&quot; /&gt;
       &lt;path d=&quot;M 41.109375 46.296875 
Q 39.59375 47.171875 37.8125 47.578125 
Q 36.03125 48 33.890625 48 
Q 26.265625 48 22.1875 43.046875 
Q 18.109375 38.09375 18.109375 28.8125 
L 18.109375 0 
L 9.078125 0 
L 9.078125 54.6875 
L 18.109375 54.6875 
L 18.109375 46.1875 
Q 20.953125 51.171875 25.484375 53.578125 
Q 30.03125 56 36.53125 56 
Q 37.453125 56 38.578125 55.875 
Q 39.703125 55.765625 41.0625 55.515625 
z
&quot; id=&quot;DejaVuSans-114&quot; /&gt;
       &lt;path d=&quot;M 18.109375 8.203125 
L 18.109375 -20.796875 
L 9.078125 -20.796875 
L 9.078125 54.6875 
L 18.109375 54.6875 
L 18.109375 46.390625 
Q 20.953125 51.265625 25.265625 53.625 
Q 29.59375 56 35.59375 56 
Q 45.5625 56 51.78125 48.09375 
Q 58.015625 40.1875 58.015625 27.296875 
Q 58.015625 14.40625 51.78125 6.484375 
Q 45.5625 -1.421875 35.59375 -1.421875 
Q 29.59375 -1.421875 25.265625 0.953125 
Q 20.953125 3.328125 18.109375 8.203125 
z
M 48.6875 27.296875 
Q 48.6875 37.203125 44.609375 42.84375 
Q 40.53125 48.484375 33.40625 48.484375 
Q 26.265625 48.484375 22.1875 42.84375 
Q 18.109375 37.203125 18.109375 27.296875 
Q 18.109375 17.390625 22.1875 11.75 
Q 26.265625 6.109375 33.40625 6.109375 
Q 40.53125 6.109375 44.609375 11.75 
Q 48.6875 17.390625 48.6875 27.296875 
z
&quot; id=&quot;DejaVuSans-112&quot; /&gt;
      &lt;/defs&gt;
      &lt;g transform=&quot;translate(188.139844 565.398438)scale(0.1 -0.1)&quot;&gt;
       &lt;use xlink:href=&quot;#DejaVuSans-99&quot; /&gt;
       &lt;use x=&quot;54.980469&quot; xlink:href=&quot;#DejaVuSans-115&quot; /&gt;
       &lt;use x=&quot;107.080078&quot; xlink:href=&quot;#DejaVuSans-104&quot; /&gt;
       &lt;use x=&quot;170.458984&quot; xlink:href=&quot;#DejaVuSans-97&quot; /&gt;
       &lt;use x=&quot;231.738281&quot; xlink:href=&quot;#DejaVuSans-114&quot; /&gt;
       &lt;use x=&quot;272.851562&quot; xlink:href=&quot;#DejaVuSans-112&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
    &lt;/g&gt;
    &lt;g id=&quot;xtick_3&quot;&gt;
     &lt;g id=&quot;line2d_3&quot;&gt;
      &lt;g&gt;
       &lt;use style=&quot;stroke:#000000;stroke-width:0.8;&quot; x=&quot;316.55625&quot; xlink:href=&quot;#m3dd78abba5&quot; y=&quot;550.8&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
     &lt;g id=&quot;text_3&quot;&gt;
      &lt;!-- javascript --&gt;
      &lt;defs&gt;
       &lt;path d=&quot;M 9.421875 54.6875 
L 18.40625 54.6875 
L 18.40625 0 
L 9.421875 0 
z
M 9.421875 75.984375 
L 18.40625 75.984375 
L 18.40625 64.59375 
L 9.421875 64.59375 
z
&quot; id=&quot;DejaVuSans-105&quot; /&gt;
       &lt;path d=&quot;M 18.3125 70.21875 
L 18.3125 54.6875 
L 36.8125 54.6875 
L 36.8125 47.703125 
L 18.3125 47.703125 
L 18.3125 18.015625 
Q 18.3125 11.328125 20.140625 9.421875 
Q 21.96875 7.515625 27.59375 7.515625 
L 36.8125 7.515625 
L 36.8125 0 
L 27.59375 0 
Q 17.1875 0 13.234375 3.875 
Q 9.28125 7.765625 9.28125 18.015625 
L 9.28125 47.703125 
L 2.6875 47.703125 
L 2.6875 54.6875 
L 9.28125 54.6875 
L 9.28125 70.21875 
z
&quot; id=&quot;DejaVuSans-116&quot; /&gt;
      &lt;/defs&gt;
      &lt;g transform=&quot;translate(292.146875 565.398438)scale(0.1 -0.1)&quot;&gt;
       &lt;use xlink:href=&quot;#DejaVuSans-106&quot; /&gt;
       &lt;use x=&quot;27.783203&quot; xlink:href=&quot;#DejaVuSans-97&quot; /&gt;
       &lt;use x=&quot;89.0625&quot; xlink:href=&quot;#DejaVuSans-118&quot; /&gt;
       &lt;use x=&quot;148.242188&quot; xlink:href=&quot;#DejaVuSans-97&quot; /&gt;
       &lt;use x=&quot;209.521484&quot; xlink:href=&quot;#DejaVuSans-115&quot; /&gt;
       &lt;use x=&quot;261.621094&quot; xlink:href=&quot;#DejaVuSans-99&quot; /&gt;
       &lt;use x=&quot;316.601562&quot; xlink:href=&quot;#DejaVuSans-114&quot; /&gt;
       &lt;use x=&quot;357.714844&quot; xlink:href=&quot;#DejaVuSans-105&quot; /&gt;
       &lt;use x=&quot;385.498047&quot; xlink:href=&quot;#DejaVuSans-112&quot; /&gt;
       &lt;use x=&quot;448.974609&quot; xlink:href=&quot;#DejaVuSans-116&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
    &lt;/g&gt;
    &lt;g id=&quot;xtick_4&quot;&gt;
     &lt;g id=&quot;line2d_4&quot;&gt;
      &lt;g&gt;
       &lt;use style=&quot;stroke:#000000;stroke-width:0.8;&quot; x=&quot;428.15625&quot; xlink:href=&quot;#m3dd78abba5&quot; y=&quot;550.8&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
     &lt;g id=&quot;text_4&quot;&gt;
      &lt;!-- python --&gt;
      &lt;defs&gt;
       &lt;path d=&quot;M 32.171875 -5.078125 
Q 28.375 -14.84375 24.75 -17.8125 
Q 21.140625 -20.796875 15.09375 -20.796875 
L 7.90625 -20.796875 
L 7.90625 -13.28125 
L 13.1875 -13.28125 
Q 16.890625 -13.28125 18.9375 -11.515625 
Q 21 -9.765625 23.484375 -3.21875 
L 25.09375 0.875 
L 2.984375 54.6875 
L 12.5 54.6875 
L 29.59375 11.921875 
L 46.6875 54.6875 
L 56.203125 54.6875 
z
&quot; id=&quot;DejaVuSans-121&quot; /&gt;
       &lt;path d=&quot;M 30.609375 48.390625 
Q 23.390625 48.390625 19.1875 42.75 
Q 14.984375 37.109375 14.984375 27.296875 
Q 14.984375 17.484375 19.15625 11.84375 
Q 23.34375 6.203125 30.609375 6.203125 
Q 37.796875 6.203125 41.984375 11.859375 
Q 46.1875 17.53125 46.1875 27.296875 
Q 46.1875 37.015625 41.984375 42.703125 
Q 37.796875 48.390625 30.609375 48.390625 
z
M 30.609375 56 
Q 42.328125 56 49.015625 48.375 
Q 55.71875 40.765625 55.71875 27.296875 
Q 55.71875 13.875 49.015625 6.21875 
Q 42.328125 -1.421875 30.609375 -1.421875 
Q 18.84375 -1.421875 12.171875 6.21875 
Q 5.515625 13.875 5.515625 27.296875 
Q 5.515625 40.765625 12.171875 48.375 
Q 18.84375 56 30.609375 56 
z
&quot; id=&quot;DejaVuSans-111&quot; /&gt;
       &lt;path d=&quot;M 54.890625 33.015625 
L 54.890625 0 
L 45.90625 0 
L 45.90625 32.71875 
Q 45.90625 40.484375 42.875 44.328125 
Q 39.84375 48.1875 33.796875 48.1875 
Q 26.515625 48.1875 22.3125 43.546875 
Q 18.109375 38.921875 18.109375 30.90625 
L 18.109375 0 
L 9.078125 0 
L 9.078125 54.6875 
L 18.109375 54.6875 
L 18.109375 46.1875 
Q 21.34375 51.125 25.703125 53.5625 
Q 30.078125 56 35.796875 56 
Q 45.21875 56 50.046875 50.171875 
Q 54.890625 44.34375 54.890625 33.015625 
z
&quot; id=&quot;DejaVuSans-110&quot; /&gt;
      &lt;/defs&gt;
      &lt;g transform=&quot;translate(410.665625 565.398438)scale(0.1 -0.1)&quot;&gt;
       &lt;use xlink:href=&quot;#DejaVuSans-112&quot; /&gt;
       &lt;use x=&quot;63.476562&quot; xlink:href=&quot;#DejaVuSans-121&quot; /&gt;
       &lt;use x=&quot;122.65625&quot; xlink:href=&quot;#DejaVuSans-116&quot; /&gt;
       &lt;use x=&quot;161.865234&quot; xlink:href=&quot;#DejaVuSans-104&quot; /&gt;
       &lt;use x=&quot;225.244141&quot; xlink:href=&quot;#DejaVuSans-111&quot; /&gt;
       &lt;use x=&quot;286.425781&quot; xlink:href=&quot;#DejaVuSans-110&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
    &lt;/g&gt;
    &lt;g id=&quot;text_5&quot;&gt;
     &lt;!-- Predicted --&gt;
     &lt;defs&gt;
      &lt;path d=&quot;M 19.671875 64.796875 
L 19.671875 37.40625 
L 32.078125 37.40625 
Q 38.96875 37.40625 42.71875 40.96875 
Q 46.484375 44.53125 46.484375 51.125 
Q 46.484375 57.671875 42.71875 61.234375 
Q 38.96875 64.796875 32.078125 64.796875 
z
M 9.8125 72.90625 
L 32.078125 72.90625 
Q 44.34375 72.90625 50.609375 67.359375 
Q 56.890625 61.8125 56.890625 51.125 
Q 56.890625 40.328125 50.609375 34.8125 
Q 44.34375 29.296875 32.078125 29.296875 
L 19.671875 29.296875 
L 19.671875 0 
L 9.8125 0 
z
&quot; id=&quot;DejaVuSans-80&quot; /&gt;
      &lt;path d=&quot;M 56.203125 29.59375 
L 56.203125 25.203125 
L 14.890625 25.203125 
Q 15.484375 15.921875 20.484375 11.0625 
Q 25.484375 6.203125 34.421875 6.203125 
Q 39.59375 6.203125 44.453125 7.46875 
Q 49.3125 8.734375 54.109375 11.28125 
L 54.109375 2.78125 
Q 49.265625 0.734375 44.1875 -0.34375 
Q 39.109375 -1.421875 33.890625 -1.421875 
Q 20.796875 -1.421875 13.15625 6.1875 
Q 5.515625 13.8125 5.515625 26.8125 
Q 5.515625 40.234375 12.765625 48.109375 
Q 20.015625 56 32.328125 56 
Q 43.359375 56 49.78125 48.890625 
Q 56.203125 41.796875 56.203125 29.59375 
z
M 47.21875 32.234375 
Q 47.125 39.59375 43.09375 43.984375 
Q 39.0625 48.390625 32.421875 48.390625 
Q 24.90625 48.390625 20.390625 44.140625 
Q 15.875 39.890625 15.1875 32.171875 
z
&quot; id=&quot;DejaVuSans-101&quot; /&gt;
      &lt;path d=&quot;M 45.40625 46.390625 
L 45.40625 75.984375 
L 54.390625 75.984375 
L 54.390625 0 
L 45.40625 0 
L 45.40625 8.203125 
Q 42.578125 3.328125 38.25 0.953125 
Q 33.9375 -1.421875 27.875 -1.421875 
Q 17.96875 -1.421875 11.734375 6.484375 
Q 5.515625 14.40625 5.515625 27.296875 
Q 5.515625 40.1875 11.734375 48.09375 
Q 17.96875 56 27.875 56 
Q 33.9375 56 38.25 53.625 
Q 42.578125 51.265625 45.40625 46.390625 
z
M 14.796875 27.296875 
Q 14.796875 17.390625 18.875 11.75 
Q 22.953125 6.109375 30.078125 6.109375 
Q 37.203125 6.109375 41.296875 11.75 
Q 45.40625 17.390625 45.40625 27.296875 
Q 45.40625 37.203125 41.296875 42.84375 
Q 37.203125 48.484375 30.078125 48.484375 
Q 22.953125 48.484375 18.875 42.84375 
Q 14.796875 37.203125 14.796875 27.296875 
z
&quot; id=&quot;DejaVuSans-100&quot; /&gt;
     &lt;/defs&gt;
     &lt;g transform=&quot;translate(237.285938 579.076563)scale(0.1 -0.1)&quot;&gt;
      &lt;use xlink:href=&quot;#DejaVuSans-80&quot; /&gt;
      &lt;use x=&quot;58.552734&quot; xlink:href=&quot;#DejaVuSans-114&quot; /&gt;
      &lt;use x=&quot;97.416016&quot; xlink:href=&quot;#DejaVuSans-101&quot; /&gt;
      &lt;use x=&quot;158.939453&quot; xlink:href=&quot;#DejaVuSans-100&quot; /&gt;
      &lt;use x=&quot;222.416016&quot; xlink:href=&quot;#DejaVuSans-105&quot; /&gt;
      &lt;use x=&quot;250.199219&quot; xlink:href=&quot;#DejaVuSans-99&quot; /&gt;
      &lt;use x=&quot;305.179688&quot; xlink:href=&quot;#DejaVuSans-116&quot; /&gt;
      &lt;use x=&quot;344.388672&quot; xlink:href=&quot;#DejaVuSans-101&quot; /&gt;
      &lt;use x=&quot;405.912109&quot; xlink:href=&quot;#DejaVuSans-100&quot; /&gt;
     &lt;/g&gt;
    &lt;/g&gt;
   &lt;/g&gt;
   &lt;g id=&quot;matplotlib.axis_2&quot;&gt;
    &lt;g id=&quot;ytick_1&quot;&gt;
     &lt;g id=&quot;line2d_5&quot;&gt;
      &lt;defs&gt;
       &lt;path d=&quot;M 0 0 
L -3.5 0 
&quot; id=&quot;me445582932&quot; style=&quot;stroke:#000000;stroke-width:0.8;&quot; /&gt;
      &lt;/defs&gt;
      &lt;g&gt;
       &lt;use style=&quot;stroke:#000000;stroke-width:0.8;&quot; x=&quot;37.55625&quot; xlink:href=&quot;#me445582932&quot; y=&quot;75.15&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
     &lt;g id=&quot;text_6&quot;&gt;
      &lt;!-- java --&gt;
      &lt;g transform=&quot;translate(28.476563 92.303906)rotate(-90)scale(0.1 -0.1)&quot;&gt;
       &lt;use xlink:href=&quot;#DejaVuSans-106&quot; /&gt;
       &lt;use x=&quot;27.783203&quot; xlink:href=&quot;#DejaVuSans-97&quot; /&gt;
       &lt;use x=&quot;89.0625&quot; xlink:href=&quot;#DejaVuSans-118&quot; /&gt;
       &lt;use x=&quot;148.242188&quot; xlink:href=&quot;#DejaVuSans-97&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
    &lt;/g&gt;
    &lt;g id=&quot;ytick_2&quot;&gt;
     &lt;g id=&quot;line2d_6&quot;&gt;
      &lt;g&gt;
       &lt;use style=&quot;stroke:#000000;stroke-width:0.8;&quot; x=&quot;37.55625&quot; xlink:href=&quot;#me445582932&quot; y=&quot;211.05&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
     &lt;g id=&quot;text_7&quot;&gt;
      &lt;!-- csharp --&gt;
      &lt;g transform=&quot;translate(28.476563 240.883594)rotate(-90)scale(0.1 -0.1)&quot;&gt;
       &lt;use xlink:href=&quot;#DejaVuSans-99&quot; /&gt;
       &lt;use x=&quot;54.980469&quot; xlink:href=&quot;#DejaVuSans-115&quot; /&gt;
       &lt;use x=&quot;107.080078&quot; xlink:href=&quot;#DejaVuSans-104&quot; /&gt;
       &lt;use x=&quot;170.458984&quot; xlink:href=&quot;#DejaVuSans-97&quot; /&gt;
       &lt;use x=&quot;231.738281&quot; xlink:href=&quot;#DejaVuSans-114&quot; /&gt;
       &lt;use x=&quot;272.851562&quot; xlink:href=&quot;#DejaVuSans-112&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
    &lt;/g&gt;
    &lt;g id=&quot;ytick_3&quot;&gt;
     &lt;g id=&quot;line2d_7&quot;&gt;
      &lt;g&gt;
       &lt;use style=&quot;stroke:#000000;stroke-width:0.8;&quot; x=&quot;37.55625&quot; xlink:href=&quot;#me445582932&quot; y=&quot;346.95&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
     &lt;g id=&quot;text_8&quot;&gt;
      &lt;!-- javascript --&gt;
      &lt;g transform=&quot;translate(28.476563 391.969531)rotate(-90)scale(0.1 -0.1)&quot;&gt;
       &lt;use xlink:href=&quot;#DejaVuSans-106&quot; /&gt;
       &lt;use x=&quot;27.783203&quot; xlink:href=&quot;#DejaVuSans-97&quot; /&gt;
       &lt;use x=&quot;89.0625&quot; xlink:href=&quot;#DejaVuSans-118&quot; /&gt;
       &lt;use x=&quot;148.242188&quot; xlink:href=&quot;#DejaVuSans-97&quot; /&gt;
       &lt;use x=&quot;209.521484&quot; xlink:href=&quot;#DejaVuSans-115&quot; /&gt;
       &lt;use x=&quot;261.621094&quot; xlink:href=&quot;#DejaVuSans-99&quot; /&gt;
       &lt;use x=&quot;316.601562&quot; xlink:href=&quot;#DejaVuSans-114&quot; /&gt;
       &lt;use x=&quot;357.714844&quot; xlink:href=&quot;#DejaVuSans-105&quot; /&gt;
       &lt;use x=&quot;385.498047&quot; xlink:href=&quot;#DejaVuSans-112&quot; /&gt;
       &lt;use x=&quot;448.974609&quot; xlink:href=&quot;#DejaVuSans-116&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
    &lt;/g&gt;
    &lt;g id=&quot;ytick_4&quot;&gt;
     &lt;g id=&quot;line2d_8&quot;&gt;
      &lt;g&gt;
       &lt;use style=&quot;stroke:#000000;stroke-width:0.8;&quot; x=&quot;37.55625&quot; xlink:href=&quot;#me445582932&quot; y=&quot;482.85&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
     &lt;g id=&quot;text_9&quot;&gt;
      &lt;!-- python --&gt;
      &lt;g transform=&quot;translate(28.476563 514.032031)rotate(-90)scale(0.1 -0.1)&quot;&gt;
       &lt;use xlink:href=&quot;#DejaVuSans-112&quot; /&gt;
       &lt;use x=&quot;63.476562&quot; xlink:href=&quot;#DejaVuSans-121&quot; /&gt;
       &lt;use x=&quot;122.65625&quot; xlink:href=&quot;#DejaVuSans-116&quot; /&gt;
       &lt;use x=&quot;161.865234&quot; xlink:href=&quot;#DejaVuSans-104&quot; /&gt;
       &lt;use x=&quot;225.244141&quot; xlink:href=&quot;#DejaVuSans-111&quot; /&gt;
       &lt;use x=&quot;286.425781&quot; xlink:href=&quot;#DejaVuSans-110&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
    &lt;/g&gt;
    &lt;g id=&quot;text_10&quot;&gt;
     &lt;!-- Actual --&gt;
     &lt;defs&gt;
      &lt;path d=&quot;M 34.1875 63.1875 
L 20.796875 26.90625 
L 47.609375 26.90625 
z
M 28.609375 72.90625 
L 39.796875 72.90625 
L 67.578125 0 
L 57.328125 0 
L 50.6875 18.703125 
L 17.828125 18.703125 
L 11.1875 0 
L 0.78125 0 
z
&quot; id=&quot;DejaVuSans-65&quot; /&gt;
      &lt;path d=&quot;M 8.5 21.578125 
L 8.5 54.6875 
L 17.484375 54.6875 
L 17.484375 21.921875 
Q 17.484375 14.15625 20.5 10.265625 
Q 23.53125 6.390625 29.59375 6.390625 
Q 36.859375 6.390625 41.078125 11.03125 
Q 45.3125 15.671875 45.3125 23.6875 
L 45.3125 54.6875 
L 54.296875 54.6875 
L 54.296875 0 
L 45.3125 0 
L 45.3125 8.40625 
Q 42.046875 3.421875 37.71875 1 
Q 33.40625 -1.421875 27.6875 -1.421875 
Q 18.265625 -1.421875 13.375 4.4375 
Q 8.5 10.296875 8.5 21.578125 
z
M 31.109375 56 
z
&quot; id=&quot;DejaVuSans-117&quot; /&gt;
      &lt;path d=&quot;M 9.421875 75.984375 
L 18.40625 75.984375 
L 18.40625 0 
L 9.421875 0 
z
&quot; id=&quot;DejaVuSans-108&quot; /&gt;
     &lt;/defs&gt;
     &lt;g transform=&quot;translate(14.798438 294.664063)rotate(-90)scale(0.1 -0.1)&quot;&gt;
      &lt;use xlink:href=&quot;#DejaVuSans-65&quot; /&gt;
      &lt;use x=&quot;66.658203&quot; xlink:href=&quot;#DejaVuSans-99&quot; /&gt;
      &lt;use x=&quot;121.638672&quot; xlink:href=&quot;#DejaVuSans-116&quot; /&gt;
      &lt;use x=&quot;160.847656&quot; xlink:href=&quot;#DejaVuSans-117&quot; /&gt;
      &lt;use x=&quot;224.226562&quot; xlink:href=&quot;#DejaVuSans-97&quot; /&gt;
      &lt;use x=&quot;285.505859&quot; xlink:href=&quot;#DejaVuSans-108&quot; /&gt;
     &lt;/g&gt;
    &lt;/g&gt;
   &lt;/g&gt;
   &lt;g id=&quot;text_11&quot;&gt;
    &lt;!-- 0.86 --&gt;
    &lt;defs&gt;
     &lt;path d=&quot;M 31.78125 66.40625 
Q 24.171875 66.40625 20.328125 58.90625 
Q 16.5 51.421875 16.5 36.375 
Q 16.5 21.390625 20.328125 13.890625 
Q 24.171875 6.390625 31.78125 6.390625 
Q 39.453125 6.390625 43.28125 13.890625 
Q 47.125 21.390625 47.125 36.375 
Q 47.125 51.421875 43.28125 58.90625 
Q 39.453125 66.40625 31.78125 66.40625 
z
M 31.78125 74.21875 
Q 44.046875 74.21875 50.515625 64.515625 
Q 56.984375 54.828125 56.984375 36.375 
Q 56.984375 17.96875 50.515625 8.265625 
Q 44.046875 -1.421875 31.78125 -1.421875 
Q 19.53125 -1.421875 13.0625 8.265625 
Q 6.59375 17.96875 6.59375 36.375 
Q 6.59375 54.828125 13.0625 64.515625 
Q 19.53125 74.21875 31.78125 74.21875 
z
&quot; id=&quot;DejaVuSans-48&quot; /&gt;
     &lt;path d=&quot;M 10.6875 12.40625 
L 21 12.40625 
L 21 0 
L 10.6875 0 
z
&quot; id=&quot;DejaVuSans-46&quot; /&gt;
     &lt;path d=&quot;M 31.78125 34.625 
Q 24.75 34.625 20.71875 30.859375 
Q 16.703125 27.09375 16.703125 20.515625 
Q 16.703125 13.921875 20.71875 10.15625 
Q 24.75 6.390625 31.78125 6.390625 
Q 38.8125 6.390625 42.859375 10.171875 
Q 46.921875 13.96875 46.921875 20.515625 
Q 46.921875 27.09375 42.890625 30.859375 
Q 38.875 34.625 31.78125 34.625 
z
M 21.921875 38.8125 
Q 15.578125 40.375 12.03125 44.71875 
Q 8.5 49.078125 8.5 55.328125 
Q 8.5 64.0625 14.71875 69.140625 
Q 20.953125 74.21875 31.78125 74.21875 
Q 42.671875 74.21875 48.875 69.140625 
Q 55.078125 64.0625 55.078125 55.328125 
Q 55.078125 49.078125 51.53125 44.71875 
Q 48 40.375 41.703125 38.8125 
Q 48.828125 37.15625 52.796875 32.3125 
Q 56.78125 27.484375 56.78125 20.515625 
Q 56.78125 9.90625 50.3125 4.234375 
Q 43.84375 -1.421875 31.78125 -1.421875 
Q 19.734375 -1.421875 13.25 4.234375 
Q 6.78125 9.90625 6.78125 20.515625 
Q 6.78125 27.484375 10.78125 32.3125 
Q 14.796875 37.15625 21.921875 38.8125 
z
M 18.3125 54.390625 
Q 18.3125 48.734375 21.84375 45.5625 
Q 25.390625 42.390625 31.78125 42.390625 
Q 38.140625 42.390625 41.71875 45.5625 
Q 45.3125 48.734375 45.3125 54.390625 
Q 45.3125 60.0625 41.71875 63.234375 
Q 38.140625 66.40625 31.78125 66.40625 
Q 25.390625 66.40625 21.84375 63.234375 
Q 18.3125 60.0625 18.3125 54.390625 
z
&quot; id=&quot;DejaVuSans-56&quot; /&gt;
     &lt;path d=&quot;M 33.015625 40.375 
Q 26.375 40.375 22.484375 35.828125 
Q 18.609375 31.296875 18.609375 23.390625 
Q 18.609375 15.53125 22.484375 10.953125 
Q 26.375 6.390625 33.015625 6.390625 
Q 39.65625 6.390625 43.53125 10.953125 
Q 47.40625 15.53125 47.40625 23.390625 
Q 47.40625 31.296875 43.53125 35.828125 
Q 39.65625 40.375 33.015625 40.375 
z
M 52.59375 71.296875 
L 52.59375 62.3125 
Q 48.875 64.0625 45.09375 64.984375 
Q 41.3125 65.921875 37.59375 65.921875 
Q 27.828125 65.921875 22.671875 59.328125 
Q 17.53125 52.734375 16.796875 39.40625 
Q 19.671875 43.65625 24.015625 45.921875 
Q 28.375 48.1875 33.59375 48.1875 
Q 44.578125 48.1875 50.953125 41.515625 
Q 57.328125 34.859375 57.328125 23.390625 
Q 57.328125 12.15625 50.6875 5.359375 
Q 44.046875 -1.421875 33.015625 -1.421875 
Q 20.359375 -1.421875 13.671875 8.265625 
Q 6.984375 17.96875 6.984375 36.375 
Q 6.984375 53.65625 15.1875 63.9375 
Q 23.390625 74.21875 37.203125 74.21875 
Q 40.921875 74.21875 44.703125 73.484375 
Q 48.484375 72.75 52.59375 71.296875 
z
&quot; id=&quot;DejaVuSans-54&quot; /&gt;
    &lt;/defs&gt;
    &lt;g style=&quot;fill:#262626;&quot; transform=&quot;translate(82.223438 77.909375)scale(0.1 -0.1)&quot;&gt;
     &lt;use xlink:href=&quot;#DejaVuSans-48&quot; /&gt;
     &lt;use x=&quot;63.623047&quot; xlink:href=&quot;#DejaVuSans-46&quot; /&gt;
     &lt;use x=&quot;95.410156&quot; xlink:href=&quot;#DejaVuSans-56&quot; /&gt;
     &lt;use x=&quot;159.033203&quot; xlink:href=&quot;#DejaVuSans-54&quot; /&gt;
    &lt;/g&gt;
   &lt;/g&gt;
   &lt;g id=&quot;text_12&quot;&gt;
    &lt;!-- 0.02 --&gt;
    &lt;defs&gt;
     &lt;path d=&quot;M 19.1875 8.296875 
L 53.609375 8.296875 
L 53.609375 0 
L 7.328125 0 
L 7.328125 8.296875 
Q 12.9375 14.109375 22.625 23.890625 
Q 32.328125 33.6875 34.8125 36.53125 
Q 39.546875 41.84375 41.421875 45.53125 
Q 43.3125 49.21875 43.3125 52.78125 
Q 43.3125 58.59375 39.234375 62.25 
Q 35.15625 65.921875 28.609375 65.921875 
Q 23.96875 65.921875 18.8125 64.3125 
Q 13.671875 62.703125 7.8125 59.421875 
L 7.8125 69.390625 
Q 13.765625 71.78125 18.9375 73 
Q 24.125 74.21875 28.421875 74.21875 
Q 39.75 74.21875 46.484375 68.546875 
Q 53.21875 62.890625 53.21875 53.421875 
Q 53.21875 48.921875 51.53125 44.890625 
Q 49.859375 40.875 45.40625 35.40625 
Q 44.1875 33.984375 37.640625 27.21875 
Q 31.109375 20.453125 19.1875 8.296875 
z
&quot; id=&quot;DejaVuSans-50&quot; /&gt;
    &lt;/defs&gt;
    &lt;g style=&quot;fill:#ffffff;&quot; transform=&quot;translate(193.823438 77.909375)scale(0.1 -0.1)&quot;&gt;
     &lt;use xlink:href=&quot;#DejaVuSans-48&quot; /&gt;
     &lt;use x=&quot;63.623047&quot; xlink:href=&quot;#DejaVuSans-46&quot; /&gt;
     &lt;use x=&quot;95.410156&quot; xlink:href=&quot;#DejaVuSans-48&quot; /&gt;
     &lt;use x=&quot;159.033203&quot; xlink:href=&quot;#DejaVuSans-50&quot; /&gt;
    &lt;/g&gt;
   &lt;/g&gt;
   &lt;g id=&quot;text_13&quot;&gt;
    &lt;!-- 0.09 --&gt;
    &lt;defs&gt;
     &lt;path d=&quot;M 10.984375 1.515625 
L 10.984375 10.5 
Q 14.703125 8.734375 18.5 7.8125 
Q 22.3125 6.890625 25.984375 6.890625 
Q 35.75 6.890625 40.890625 13.453125 
Q 46.046875 20.015625 46.78125 33.40625 
Q 43.953125 29.203125 39.59375 26.953125 
Q 35.25 24.703125 29.984375 24.703125 
Q 19.046875 24.703125 12.671875 31.3125 
Q 6.296875 37.9375 6.296875 49.421875 
Q 6.296875 60.640625 12.9375 67.421875 
Q 19.578125 74.21875 30.609375 74.21875 
Q 43.265625 74.21875 49.921875 64.515625 
Q 56.59375 54.828125 56.59375 36.375 
Q 56.59375 19.140625 48.40625 8.859375 
Q 40.234375 -1.421875 26.421875 -1.421875 
Q 22.703125 -1.421875 18.890625 -0.6875 
Q 15.09375 0.046875 10.984375 1.515625 
z
M 30.609375 32.421875 
Q 37.25 32.421875 41.125 36.953125 
Q 45.015625 41.5 45.015625 49.421875 
Q 45.015625 57.28125 41.125 61.84375 
Q 37.25 66.40625 30.609375 66.40625 
Q 23.96875 66.40625 20.09375 61.84375 
Q 16.21875 57.28125 16.21875 49.421875 
Q 16.21875 41.5 20.09375 36.953125 
Q 23.96875 32.421875 30.609375 32.421875 
z
&quot; id=&quot;DejaVuSans-57&quot; /&gt;
    &lt;/defs&gt;
    &lt;g style=&quot;fill:#ffffff;&quot; transform=&quot;translate(305.423438 77.909375)scale(0.1 -0.1)&quot;&gt;
     &lt;use xlink:href=&quot;#DejaVuSans-48&quot; /&gt;
     &lt;use x=&quot;63.623047&quot; xlink:href=&quot;#DejaVuSans-46&quot; /&gt;
     &lt;use x=&quot;95.410156&quot; xlink:href=&quot;#DejaVuSans-48&quot; /&gt;
     &lt;use x=&quot;159.033203&quot; xlink:href=&quot;#DejaVuSans-57&quot; /&gt;
    &lt;/g&gt;
   &lt;/g&gt;
   &lt;g id=&quot;text_14&quot;&gt;
    &lt;!-- 0.03 --&gt;
    &lt;defs&gt;
     &lt;path d=&quot;M 40.578125 39.3125 
Q 47.65625 37.796875 51.625 33 
Q 55.609375 28.21875 55.609375 21.1875 
Q 55.609375 10.40625 48.1875 4.484375 
Q 40.765625 -1.421875 27.09375 -1.421875 
Q 22.515625 -1.421875 17.65625 -0.515625 
Q 12.796875 0.390625 7.625 2.203125 
L 7.625 11.71875 
Q 11.71875 9.328125 16.59375 8.109375 
Q 21.484375 6.890625 26.8125 6.890625 
Q 36.078125 6.890625 40.9375 10.546875 
Q 45.796875 14.203125 45.796875 21.1875 
Q 45.796875 27.640625 41.28125 31.265625 
Q 36.765625 34.90625 28.71875 34.90625 
L 20.21875 34.90625 
L 20.21875 43.015625 
L 29.109375 43.015625 
Q 36.375 43.015625 40.234375 45.921875 
Q 44.09375 48.828125 44.09375 54.296875 
Q 44.09375 59.90625 40.109375 62.90625 
Q 36.140625 65.921875 28.71875 65.921875 
Q 24.65625 65.921875 20.015625 65.03125 
Q 15.375 64.15625 9.8125 62.3125 
L 9.8125 71.09375 
Q 15.4375 72.65625 20.34375 73.4375 
Q 25.25 74.21875 29.59375 74.21875 
Q 40.828125 74.21875 47.359375 69.109375 
Q 53.90625 64.015625 53.90625 55.328125 
Q 53.90625 49.265625 50.4375 45.09375 
Q 46.96875 40.921875 40.578125 39.3125 
z
&quot; id=&quot;DejaVuSans-51&quot; /&gt;
    &lt;/defs&gt;
    &lt;g style=&quot;fill:#ffffff;&quot; transform=&quot;translate(417.023438 77.909375)scale(0.1 -0.1)&quot;&gt;
     &lt;use xlink:href=&quot;#DejaVuSans-48&quot; /&gt;
     &lt;use x=&quot;63.623047&quot; xlink:href=&quot;#DejaVuSans-46&quot; /&gt;
     &lt;use x=&quot;95.410156&quot; xlink:href=&quot;#DejaVuSans-48&quot; /&gt;
     &lt;use x=&quot;159.033203&quot; xlink:href=&quot;#DejaVuSans-51&quot; /&gt;
    &lt;/g&gt;
   &lt;/g&gt;
   &lt;g id=&quot;text_15&quot;&gt;
    &lt;!-- 0.02 --&gt;
    &lt;g style=&quot;fill:#ffffff;&quot; transform=&quot;translate(82.223438 213.809375)scale(0.1 -0.1)&quot;&gt;
     &lt;use xlink:href=&quot;#DejaVuSans-48&quot; /&gt;
     &lt;use x=&quot;63.623047&quot; xlink:href=&quot;#DejaVuSans-46&quot; /&gt;
     &lt;use x=&quot;95.410156&quot; xlink:href=&quot;#DejaVuSans-48&quot; /&gt;
     &lt;use x=&quot;159.033203&quot; xlink:href=&quot;#DejaVuSans-50&quot; /&gt;
    &lt;/g&gt;
   &lt;/g&gt;
   &lt;g id=&quot;text_16&quot;&gt;
    &lt;!-- 0.93 --&gt;
    &lt;g style=&quot;fill:#262626;&quot; transform=&quot;translate(193.823438 213.809375)scale(0.1 -0.1)&quot;&gt;
     &lt;use xlink:href=&quot;#DejaVuSans-48&quot; /&gt;
     &lt;use x=&quot;63.623047&quot; xlink:href=&quot;#DejaVuSans-46&quot; /&gt;
     &lt;use x=&quot;95.410156&quot; xlink:href=&quot;#DejaVuSans-57&quot; /&gt;
     &lt;use x=&quot;159.033203&quot; xlink:href=&quot;#DejaVuSans-51&quot; /&gt;
    &lt;/g&gt;
   &lt;/g&gt;
   &lt;g id=&quot;text_17&quot;&gt;
    &lt;!-- 0.03 --&gt;
    &lt;g style=&quot;fill:#ffffff;&quot; transform=&quot;translate(305.423438 213.809375)scale(0.1 -0.1)&quot;&gt;
     &lt;use xlink:href=&quot;#DejaVuSans-48&quot; /&gt;
     &lt;use x=&quot;63.623047&quot; xlink:href=&quot;#DejaVuSans-46&quot; /&gt;
     &lt;use x=&quot;95.410156&quot; xlink:href=&quot;#DejaVuSans-48&quot; /&gt;
     &lt;use x=&quot;159.033203&quot; xlink:href=&quot;#DejaVuSans-51&quot; /&gt;
    &lt;/g&gt;
   &lt;/g&gt;
   &lt;g id=&quot;text_18&quot;&gt;
    &lt;!-- 0.03 --&gt;
    &lt;g style=&quot;fill:#ffffff;&quot; transform=&quot;translate(417.023438 213.809375)scale(0.1 -0.1)&quot;&gt;
     &lt;use xlink:href=&quot;#DejaVuSans-48&quot; /&gt;
     &lt;use x=&quot;63.623047&quot; xlink:href=&quot;#DejaVuSans-46&quot; /&gt;
     &lt;use x=&quot;95.410156&quot; xlink:href=&quot;#DejaVuSans-48&quot; /&gt;
     &lt;use x=&quot;159.033203&quot; xlink:href=&quot;#DejaVuSans-51&quot; /&gt;
    &lt;/g&gt;
   &lt;/g&gt;
   &lt;g id=&quot;text_19&quot;&gt;
    &lt;!-- 0.08 --&gt;
    &lt;g style=&quot;fill:#ffffff;&quot; transform=&quot;translate(82.223438 349.709375)scale(0.1 -0.1)&quot;&gt;
     &lt;use xlink:href=&quot;#DejaVuSans-48&quot; /&gt;
     &lt;use x=&quot;63.623047&quot; xlink:href=&quot;#DejaVuSans-46&quot; /&gt;
     &lt;use x=&quot;95.410156&quot; xlink:href=&quot;#DejaVuSans-48&quot; /&gt;
     &lt;use x=&quot;159.033203&quot; xlink:href=&quot;#DejaVuSans-56&quot; /&gt;
    &lt;/g&gt;
   &lt;/g&gt;
   &lt;g id=&quot;text_20&quot;&gt;
    &lt;!-- 0.02 --&gt;
    &lt;g style=&quot;fill:#ffffff;&quot; transform=&quot;translate(193.823438 349.709375)scale(0.1 -0.1)&quot;&gt;
     &lt;use xlink:href=&quot;#DejaVuSans-48&quot; /&gt;
     &lt;use x=&quot;63.623047&quot; xlink:href=&quot;#DejaVuSans-46&quot; /&gt;
     &lt;use x=&quot;95.410156&quot; xlink:href=&quot;#DejaVuSans-48&quot; /&gt;
     &lt;use x=&quot;159.033203&quot; xlink:href=&quot;#DejaVuSans-50&quot; /&gt;
    &lt;/g&gt;
   &lt;/g&gt;
   &lt;g id=&quot;text_21&quot;&gt;
    &lt;!-- 0.88 --&gt;
    &lt;g style=&quot;fill:#262626;&quot; transform=&quot;translate(305.423438 349.709375)scale(0.1 -0.1)&quot;&gt;
     &lt;use xlink:href=&quot;#DejaVuSans-48&quot; /&gt;
     &lt;use x=&quot;63.623047&quot; xlink:href=&quot;#DejaVuSans-46&quot; /&gt;
     &lt;use x=&quot;95.410156&quot; xlink:href=&quot;#DejaVuSans-56&quot; /&gt;
     &lt;use x=&quot;159.033203&quot; xlink:href=&quot;#DejaVuSans-56&quot; /&gt;
    &lt;/g&gt;
   &lt;/g&gt;
   &lt;g id=&quot;text_22&quot;&gt;
    &lt;!-- 0.02 --&gt;
    &lt;g style=&quot;fill:#ffffff;&quot; transform=&quot;translate(417.023438 349.709375)scale(0.1 -0.1)&quot;&gt;
     &lt;use xlink:href=&quot;#DejaVuSans-48&quot; /&gt;
     &lt;use x=&quot;63.623047&quot; xlink:href=&quot;#DejaVuSans-46&quot; /&gt;
     &lt;use x=&quot;95.410156&quot; xlink:href=&quot;#DejaVuSans-48&quot; /&gt;
     &lt;use x=&quot;159.033203&quot; xlink:href=&quot;#DejaVuSans-50&quot; /&gt;
    &lt;/g&gt;
   &lt;/g&gt;
   &lt;g id=&quot;text_23&quot;&gt;
    &lt;!-- 0.03 --&gt;
    &lt;g style=&quot;fill:#ffffff;&quot; transform=&quot;translate(82.223438 485.609375)scale(0.1 -0.1)&quot;&gt;
     &lt;use xlink:href=&quot;#DejaVuSans-48&quot; /&gt;
     &lt;use x=&quot;63.623047&quot; xlink:href=&quot;#DejaVuSans-46&quot; /&gt;
     &lt;use x=&quot;95.410156&quot; xlink:href=&quot;#DejaVuSans-48&quot; /&gt;
     &lt;use x=&quot;159.033203&quot; xlink:href=&quot;#DejaVuSans-51&quot; /&gt;
    &lt;/g&gt;
   &lt;/g&gt;
   &lt;g id=&quot;text_24&quot;&gt;
    &lt;!-- 0.02 --&gt;
    &lt;g style=&quot;fill:#ffffff;&quot; transform=&quot;translate(193.823438 485.609375)scale(0.1 -0.1)&quot;&gt;
     &lt;use xlink:href=&quot;#DejaVuSans-48&quot; /&gt;
     &lt;use x=&quot;63.623047&quot; xlink:href=&quot;#DejaVuSans-46&quot; /&gt;
     &lt;use x=&quot;95.410156&quot; xlink:href=&quot;#DejaVuSans-48&quot; /&gt;
     &lt;use x=&quot;159.033203&quot; xlink:href=&quot;#DejaVuSans-50&quot; /&gt;
    &lt;/g&gt;
   &lt;/g&gt;
   &lt;g id=&quot;text_25&quot;&gt;
    &lt;!-- 0.02 --&gt;
    &lt;g style=&quot;fill:#ffffff;&quot; transform=&quot;translate(305.423438 485.609375)scale(0.1 -0.1)&quot;&gt;
     &lt;use xlink:href=&quot;#DejaVuSans-48&quot; /&gt;
     &lt;use x=&quot;63.623047&quot; xlink:href=&quot;#DejaVuSans-46&quot; /&gt;
     &lt;use x=&quot;95.410156&quot; xlink:href=&quot;#DejaVuSans-48&quot; /&gt;
     &lt;use x=&quot;159.033203&quot; xlink:href=&quot;#DejaVuSans-50&quot; /&gt;
    &lt;/g&gt;
   &lt;/g&gt;
   &lt;g id=&quot;text_26&quot;&gt;
    &lt;!-- 0.93 --&gt;
    &lt;g style=&quot;fill:#262626;&quot; transform=&quot;translate(417.023438 485.609375)scale(0.1 -0.1)&quot;&gt;
     &lt;use xlink:href=&quot;#DejaVuSans-48&quot; /&gt;
     &lt;use x=&quot;63.623047&quot; xlink:href=&quot;#DejaVuSans-46&quot; /&gt;
     &lt;use x=&quot;95.410156&quot; xlink:href=&quot;#DejaVuSans-57&quot; /&gt;
     &lt;use x=&quot;159.033203&quot; xlink:href=&quot;#DejaVuSans-51&quot; /&gt;
    &lt;/g&gt;
   &lt;/g&gt;
  &lt;/g&gt;
  &lt;g id=&quot;axes_2&quot;&gt;
   &lt;g id=&quot;patch_3&quot;&gt;
    &lt;path clip-path=&quot;url(#p6798124fec)&quot; d=&quot;M 511.85625 550.8 
L 511.85625 548.676562 
L 511.85625 9.323438 
L 511.85625 7.2 
L 539.03625 7.2 
L 539.03625 9.323438 
L 539.03625 548.676562 
L 539.03625 550.8 
z
&quot; style=&quot;fill:#ffffff;stroke:#ffffff;stroke-linejoin:miter;stroke-width:0.01;&quot; /&gt;
   &lt;/g&gt;
   &lt;image height=&quot;543&quot; id=&quot;imageed79128e4c&quot; transform=&quot;scale(1 -1)translate(0 -543)&quot; width=&quot;27&quot; x=&quot;512&quot; xlink:href=&quot;data:image/png;base64,
iVBORw0KGgoAAAANSUhEUgAAABsAAAIfCAYAAACB2qdqAAAABHNCSVQICAgIfAhkiAAAAoVJREFUeJztnIFtA0EMw+7S6xLdf892iBIGTJALGIok+/sJer++f37PEO9OTTrnfAZnnXfvnLaU7Rv27pF+jN6AvI9WmTeNYs+0yj7aNGo9q9QI3oBUaoQeCxDaIAhtkH3DCgjCtGdz8zoxCOYTk2cAebZvWAFByDMEs2daZT1+E+TZvmGtK4SijyD2zKvM+4OhHlIJ6tm+YZ0YhEqN8Can1TOEeoZQz/YNM0dfvK7maF0hiHtWGglK475hvU5CaF0hqNfVHHmGIPas40lgPp7WgIhL3SImaIMgtEEQOp4IRR/BG/3SiDCsbOzfNNUzCG/PCgiCeF1po29Oo/bElEaClO0bVqkRij6CWNnV9szrmViZNY2dGISij1AaEd7nzJlWGhHEG0Tbs+noa0s9OKzoI3RiEKbTqPVscFjK9g0r+gh5hmA+noNPPKURwbxBBr9FmO6ZVFl/nyF4A1KpEaY9mxtWGhFKI4L5eGoDIo7+4NvNSo2g9syqzLxB5oZ1PBFaVwidGISUIZRGhI7nvmHq4zk3rFIjiD079QwgZQheZcOltn6M3oDkGUKeIbw7+CuvPEPwelZAEN6xBsQb/dKIUBoRxJ5plU2/tpV+jN6AqJXNzcszhI4nwvSXCNKeFRAEsbLbiQFoXSGYPatnAObjWakBOp4IYs/qGUHHE+Ed8ftGqWd9jAjmdSU+MVZl4te2pREgZfuG9XSF0LpCMHvmVdYGAUjZvmEtYoQ8Q8gzhDxDMCuzprGAIHgDkmcIeYbw7v0aG5ZnCF5lrSsEb0DUnmkXsdgzrTKtZ9oHnqKPII5+nhH0WICg9syq7Fo9KyAI6lK3iP9PPUPwLmKxZ9qetYgR/gAIQC/9w/cTOwAAAABJRU5ErkJggg==&quot; y=&quot;-7&quot; /&gt;
   &lt;g id=&quot;matplotlib.axis_3&quot; /&gt;
   &lt;g id=&quot;matplotlib.axis_4&quot;&gt;
    &lt;g id=&quot;ytick_5&quot;&gt;
     &lt;g id=&quot;line2d_9&quot;&gt;
      &lt;defs&gt;
       &lt;path d=&quot;M 0 0 
L 3.5 0 
&quot; id=&quot;m73095c3bac&quot; style=&quot;stroke:#000000;stroke-width:0.8;&quot; /&gt;
      &lt;/defs&gt;
      &lt;g&gt;
       &lt;use style=&quot;stroke:#000000;stroke-width:0.8;&quot; x=&quot;539.03625&quot; xlink:href=&quot;#m73095c3bac&quot; y=&quot;440.885275&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
     &lt;g id=&quot;text_27&quot;&gt;
      &lt;!-- 0.2 --&gt;
      &lt;g transform=&quot;translate(546.03625 444.684493)scale(0.1 -0.1)&quot;&gt;
       &lt;use xlink:href=&quot;#DejaVuSans-48&quot; /&gt;
       &lt;use x=&quot;63.623047&quot; xlink:href=&quot;#DejaVuSans-46&quot; /&gt;
       &lt;use x=&quot;95.410156&quot; xlink:href=&quot;#DejaVuSans-50&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
    &lt;/g&gt;
    &lt;g id=&quot;ytick_6&quot;&gt;
     &lt;g id=&quot;line2d_10&quot;&gt;
      &lt;g&gt;
       &lt;use style=&quot;stroke:#000000;stroke-width:0.8;&quot; x=&quot;539.03625&quot; xlink:href=&quot;#m73095c3bac&quot; y=&quot;321.412747&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
     &lt;g id=&quot;text_28&quot;&gt;
      &lt;!-- 0.4 --&gt;
      &lt;defs&gt;
       &lt;path d=&quot;M 37.796875 64.3125 
L 12.890625 25.390625 
L 37.796875 25.390625 
z
M 35.203125 72.90625 
L 47.609375 72.90625 
L 47.609375 25.390625 
L 58.015625 25.390625 
L 58.015625 17.1875 
L 47.609375 17.1875 
L 47.609375 0 
L 37.796875 0 
L 37.796875 17.1875 
L 4.890625 17.1875 
L 4.890625 26.703125 
z
&quot; id=&quot;DejaVuSans-52&quot; /&gt;
      &lt;/defs&gt;
      &lt;g transform=&quot;translate(546.03625 325.211966)scale(0.1 -0.1)&quot;&gt;
       &lt;use xlink:href=&quot;#DejaVuSans-48&quot; /&gt;
       &lt;use x=&quot;63.623047&quot; xlink:href=&quot;#DejaVuSans-46&quot; /&gt;
       &lt;use x=&quot;95.410156&quot; xlink:href=&quot;#DejaVuSans-52&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
    &lt;/g&gt;
    &lt;g id=&quot;ytick_7&quot;&gt;
     &lt;g id=&quot;line2d_11&quot;&gt;
      &lt;g&gt;
       &lt;use style=&quot;stroke:#000000;stroke-width:0.8;&quot; x=&quot;539.03625&quot; xlink:href=&quot;#m73095c3bac&quot; y=&quot;201.94022&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
     &lt;g id=&quot;text_29&quot;&gt;
      &lt;!-- 0.6 --&gt;
      &lt;g transform=&quot;translate(546.03625 205.739439)scale(0.1 -0.1)&quot;&gt;
       &lt;use xlink:href=&quot;#DejaVuSans-48&quot; /&gt;
       &lt;use x=&quot;63.623047&quot; xlink:href=&quot;#DejaVuSans-46&quot; /&gt;
       &lt;use x=&quot;95.410156&quot; xlink:href=&quot;#DejaVuSans-54&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
    &lt;/g&gt;
    &lt;g id=&quot;ytick_8&quot;&gt;
     &lt;g id=&quot;line2d_12&quot;&gt;
      &lt;g&gt;
       &lt;use style=&quot;stroke:#000000;stroke-width:0.8;&quot; x=&quot;539.03625&quot; xlink:href=&quot;#m73095c3bac&quot; y=&quot;82.467692&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
     &lt;g id=&quot;text_30&quot;&gt;
      &lt;!-- 0.8 --&gt;
      &lt;g transform=&quot;translate(546.03625 86.266911)scale(0.1 -0.1)&quot;&gt;
       &lt;use xlink:href=&quot;#DejaVuSans-48&quot; /&gt;
       &lt;use x=&quot;63.623047&quot; xlink:href=&quot;#DejaVuSans-46&quot; /&gt;
       &lt;use x=&quot;95.410156&quot; xlink:href=&quot;#DejaVuSans-56&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
    &lt;/g&gt;
   &lt;/g&gt;
   &lt;g id=&quot;patch_4&quot;&gt;
    &lt;path d=&quot;M 511.85625 550.8 
L 511.85625 548.676562 
L 511.85625 9.323438 
L 511.85625 7.2 
L 539.03625 7.2 
L 539.03625 9.323438 
L 539.03625 548.676562 
L 539.03625 550.8 
z
&quot; style=&quot;fill:none;&quot; /&gt;
   &lt;/g&gt;
  &lt;/g&gt;
 &lt;/g&gt;
 &lt;defs&gt;
  &lt;clipPath id=&quot;p89171f4a4a&quot;&gt;
   &lt;rect height=&quot;543.6&quot; width=&quot;446.4&quot; x=&quot;37.55625&quot; y=&quot;7.2&quot; /&gt;
  &lt;/clipPath&gt;
  &lt;clipPath id=&quot;p6798124fec&quot;&gt;
   &lt;rect height=&quot;543.6&quot; width=&quot;27.18&quot; x=&quot;511.85625&quot; y=&quot;7.2&quot; /&gt;
  &lt;/clipPath&gt;
 &lt;/defs&gt;
&lt;/svg&gt;

&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;/div&gt;</content><author><name></name></author><summary type="html"></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://rafaelsf80.github.io/notebooks/images/automl.png" /><media:content medium="image" url="https://rafaelsf80.github.io/notebooks/images/automl.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry></feed>